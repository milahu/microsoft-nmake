void __convention("regparm") sub_402862(char* arg1, int32_t arg2, int32_t arg3, int32_t* arg4 @ ebp, uint8_t* arg5 @ esi, void* arg6 @ edi, long double arg7 @ st0)
{
    *arg1 = (*arg1 + arg1);
    int32_t*** edi = (arg6 + 1);
    void* const* var_4 = &__return_addr;
    *arg1 = (*arg1 + arg2);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t var_9 = arg2;
    int32_t* var_d = &var_9;
    arg1 = (arg1 & 0x58);
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    arg1 = (arg1 + 0x10);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t var_11 = arg2;
    int32_t* var_15 = &var_11;
    arg1 = (arg1 & 0x58);
    *arg1 = (*arg1 + arg1);
    char temp1 = *arg1;
    *arg1 = (*arg1 + (arg3 + 3));
    *arg1 = (*arg1 + arg1);
    *(arg1 * 2) = (*(arg1 * 2) + arg1);
    *arg1 = (*arg1 + arg1);
    int32_t var_19 = arg2;
    int32_t* var_1d = &var_19;
    arg1 = (arg1 & 0x58);
    int32_t* edx = var_1d;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    arg1 = (arg1 | 0x10);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    var_1d = edx;
    int32_t** var_21 = &var_1d;
    arg1 = (arg1 & 0x58);
    *arg1 = (*arg1 + arg1);
    char temp2 = *arg1;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + edx);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t* var_25 = edx;
    int32_t** var_29 = &var_25;
    arg1 = (arg1 & 0x58);
    *arg1 = (*arg1 + arg1);
    *(arg1 + edx) = (*(arg1 + edx) + edx);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t* var_2d = edx;
    int32_t** var_31 = &var_2d;
    arg1 = (arg1 & 0x58);
    *arg1 = (*arg1 + arg1);
    char temp3 = *arg1;
    *arg1 = (*arg1 + 0xb);
    *arg1 = (*arg1 + arg1);
    *(arg1 * 2) = (*(arg1 * 2) + arg1);
    *arg1 = (*arg1 + arg1);
    int32_t* var_35 = edx;
    int32_t** var_39 = &var_35;
    arg1 = (arg1 & 0x58);
    *arg1 = (*arg1 + arg1);
    char temp4 = *arg1;
    *arg1 = (*arg1 + arg1);
    arg1 = (arg1 - 0x10);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t* var_3d = edx;
    int32_t** var_41 = &var_3d;
    arg1 = (arg1 & 0x58);
    int32_t** edx_1 = var_41;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 & edx_1);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    var_41 = edx_1;
    int32_t*** var_45 = &var_41;
    arg1 = (arg1 & 0x58);
    char* var_49 = arg1;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    arg1 = (arg1 & 0x10);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t** var_4d = edx_1;
    int32_t*** var_51 = &var_4d;
    arg1 = (arg1 & 0x58);
    char* var_55 = arg1;
    char* edx_2 = var_55;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 - edx_2);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    var_55 = edx_2;
    char** var_59 = &var_55;
    arg1 = (arg1 & 0x58);
    char*** var_5d = &var_59;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    arg1 = (arg1 - 0x10);
    *arg1 = (*arg1 + arg1);
    arg1 = arg1;
    *arg1 = (*arg1 + arg1);
    int32_t* ebx = 0x12;
    char* var_61 = edx_2;
    char** var_65 = &var_61;
    arg1 = (arg1 & 0x58);
    int32_t** edx_3 = &var_65;
    int32_t** esp_1 = &var_65;
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 + arg1);
    *arg1 = (*arg1 ^ edx_3);
    char temp5 = *arg1;
    *arg1 = (*arg1 + arg1);
    int32_t* ecx_14 = (arg3 + 3);
    char temp6_1;
    bool z_1;
    if ((temp5 != (-arg1) && ecx_14 != 0))
    {
        edi = var_65;
        arg5 = var_61;
        arg4 = var_5d;
        ebx = var_55;
        edx_3 = var_51;
        ecx_14 = var_4d;
        arg1 = var_49;
        esp_1 = &var_45;
    }
    else
    {
        temp6_1 = *arg1;
        *arg1 = (*arg1 + arg1);
        z_1 = temp6_1 == (-arg1);
        if ((temp6_1 + arg1) >= temp6_1)
        {
            edi = var_65;
            arg5 = var_61;
            arg4 = var_5d;
            ebx = var_55;
            edx_3 = var_51;
            ecx_14 = var_4d;
            arg1 = var_49;
            esp_1 = &var_45;
            if ((!z_1))
            {
                char temp9_1 = *arg1;
                *arg1 = (*arg1 + arg1);
                *arg1 = (*arg1 + *ecx_14[1]);
                *arg1 = (*arg1 + arg1);
                arg1 = arg1;
                char temp10_1 = *arg1;
                *arg1 = (*arg1 + arg1);
                bool z_2 = temp10_1 == (-arg1);
                if ((temp10_1 + arg1) >= temp10_1)
                {
                    edi = var_45;
                    arg5 = var_41;
                    arg4 = var_3d;
                    ebx = var_35;
                    edx_3 = var_31;
                    ecx_14 = var_2d;
                    arg1 = var_29;
                    esp_1 = &var_25;
                }
                if (((temp10_1 + arg1) < temp10_1 || ((temp10_1 + arg1) >= temp10_1 && z_2)))
                {
                    *arg1 = (*arg1 + ecx_14);
                    *arg1 = (*arg1 + arg1);
                    uint8_t temp13_1 = *arg5;
                    *arg5 = (*arg5 + *ecx_14[1]);
                    if ((temp13_1 + *ecx_14[1]) < temp13_1)
                    {
                        goto label_402a53;
                    }
                    goto label_4029df;
                }
            }
        }
    }
    int32_t eflags;
    char* cs;
    bool c_11;
    if (((temp5 != (-arg1) && ecx_14 != 0) || (((!(temp5 != (-arg1) && ecx_14 != 0)) && (temp6_1 + arg1) >= temp6_1) && (!z_1))))
    {
        arg1 = (arg1 & 0x73);
        bool cond:1_1 = arg1 == 0;
        bool cond:2_1 = arg1 == 0;
        bool z_4;
        bool s_1;
        if (arg1 >= 0)
        {
            edi = *esp_1;
            arg5 = esp_1[1];
            arg4 = esp_1[2];
            ebx = esp_1[4];
            edx_3 = esp_1[5];
            ecx_14 = esp_1[6];
            arg1 = esp_1[7];
            esp_1 = &esp_1[8];
            if ((!cond:2_1))
            {
                *arg1 = (*arg1 + arg1);
                *(arg1 + arg4) = (*(arg1 + arg4) + edx_3);
                char temp11_1 = *arg1;
                *arg1 = (*arg1 + arg1);
                bool c_7 = (temp11_1 + arg1) < temp11_1;
                bool z_3 = temp11_1 == (-arg1);
                arg1 = 0x2e000002;
                if ((!c_7))
                {
                    edi = *esp_1;
                    arg5 = esp_1[1];
                    arg4 = esp_1[2];
                    ebx = esp_1[4];
                    edx_3 = esp_1[5];
                    ecx_14 = esp_1[6];
                    arg1 = esp_1[7];
                    esp_1 = &esp_1[8];
                    if ((!z_3))
                    {
                        arg1 = (arg1 & 0x7a);
                        bool p_1 = /* bool p_1 = unimplemented  {and al, 0x7a} */;
                        if ((!p_1))
                        {
                            int32_t* fsbase;
                            __bound_gprv_mema32(esp_1, *(fsbase + edi));
                            *arg1 = (*arg1 + arg1);
                            breakpoint();
                        }
                        goto label_402a0c;
                    }
                }
                uint8_t temp15_1 = *arg5;
                *arg5 = (*arg5 + *ecx_14[1]);
                c_11 = (temp15_1 + *ecx_14[1]) < temp15_1;
                z_4 = temp15_1 == (-*ecx_14[1]);
                s_1 = (temp15_1 + *ecx_14[1]) < 0;
            }
        }
        if ((arg1 < 0 || (arg1 >= 0 && cond:2_1)))
        {
            if (cond:1_1)
            {
                goto label_402a43;
            }
            arg1 = (arg1 & 0x54);
        label_4029e3:
            edx_3 = esp_1[1];
            esp_1 = &esp_1[2];
            *arg1 = (*arg1 + arg1);
            char temp14_1 = *arg1;
            *arg1 = (*arg1 + arg1);
            ecx_14 = (ecx_14 - 1);
            if ((temp14_1 != (-arg1) && ecx_14 != 0))
            {
                goto label_402a14;
            }
            char temp17_1 = *arg1;
            *arg1 = (*arg1 + arg1);
            c_11 = (temp17_1 + arg1) < temp17_1;
            z_4 = temp17_1 == (-arg1);
            s_1 = (temp17_1 + arg1) < 0;
            arg1 = *0x2e0000ea;
        }
        if (((arg1 >= 0 && (!cond:2_1)) || ((arg1 < 0 || (arg1 >= 0 && cond:2_1)) && (!cond:1_1))))
        {
            if (z_4)
            {
                goto label_402a58;
            }
            if (s_1)
            {
                goto label_402a69;
            }
            arg1 = (arg1 & 0x6d);
            arg5 = __outsb(edx_3, *arg5, arg5, eflags);
            *arg1 = (*arg1 + arg1);
            char temp21_1 = *arg1;
            *arg1 = (*arg1 + arg1);
            *0x5c0001 = (*0x5c0001 + 0);
            uint8_t temp22_1 = *arg5;
            *arg5 = (*arg5 + *ecx_14[1]);
            bool cond:6_1 = temp22_1 == (-*ecx_14[1]);
            if ((temp22_1 + *ecx_14[1]) < 0)
            {
            label_402a6b:
                *(arg1 * 2) = (*(arg1 * 2) + edx_3);
                goto label_402a6e;
            }
            edi = *esp_1;
            arg5 = esp_1[1];
            arg4 = esp_1[2];
            ebx = esp_1[4];
            edx_3 = esp_1[5];
            ecx_14 = esp_1[6];
            arg1 = esp_1[7];
            esp_1 = &esp_1[8];
            if (cond:6_1)
            {
                goto label_402a6b;
            }
            arg1 = (arg1 & 0x78);
        label_402a0c:
            *arg1 = (*arg1 + arg1);
            *arg1 = (*arg1 + arg1);
            *arg1 = (*arg1 + *arg1[1]);
            *arg1 = &arg1[*arg1];
        label_402a14:
            *ecx_14 = (*ecx_14 & arg1);
            char temp16_1 = *arg1;
            *arg1 = (*arg1 + arg1);
            bool cond:3_1 = temp16_1 == (-arg1);
            edi = *esp_1;
            arg5 = esp_1[1];
            arg4 = esp_1[2];
            ebx = esp_1[4];
            edx_3 = esp_1[5];
            ecx_14 = esp_1[6];
            arg1 = esp_1[7];
            if ((!cond:3_1))
            {
                *arg1 = (*arg1 + arg1);
                *arg1 = (*arg1 + *arg1[1]);
                *ecx_14 = (*ecx_14 & arg1);
                arg1 = (arg1 + ecx_14);
                esp_1[7] = ecx_14;
                arg1 = (arg1 + *arg1);
                __bound_gprv_mema32(arg5, *(cs + (ebx + 0x73)));
                *arg1 = (*arg1 + arg1);
                *arg1 = (*arg1 + arg1);
                arg1[0x2bc0003] = (arg1[0x2bc0003] + arg1);
                *arg1 = (*arg1 + arg1);
                esp_1 = (*(cs + &ecx_14[0x1d]) * 0x352461);
                *arg1 = (*arg1 + arg1);
            label_402a43:
                *(&edx_3[arg1] + 0x40003) = (*(&edx_3[arg1] + 0x40003) + *ebx[1]);
                *arg1 = (*arg1 + arg1);
                *(cs + arg1) = (*(cs + arg1) ^ *edx_3[1]);
                goto label_402a4f;
            }
            arg1 = &arg1[*arg1];
        }
    }
    if (((!(temp5 != (-arg1) && ecx_14 != 0)) && ((temp6_1 + arg1) < temp6_1 || ((temp6_1 + arg1) >= temp6_1 && z_1))))
    {
        uint8_t temp7_1 = *arg5;
        *arg5 = (*arg5 + *ecx_14[1]);
        if ((temp7_1 + *ecx_14[1]) >= temp7_1)
        {
            int32_t eflags_1;
            int16_t temp0_1;
            temp0_1 = __arpl_memw_gpr16(*(esp_1 + (edx_3 << 1)), esp_1);
            *(esp_1 + (edx_3 << 1)) = temp0_1;
            ecx_14 = (ecx_14 + 2);
            *arg1 = (*arg1 + arg1);
            *arg1 = (*arg1 + arg1);
            *edx_3;
            *arg1 = (*arg1 + arg1);
            *arg1 = (*arg1 | arg1);
            char temp8_1 = *arg1;
            *arg1 = (*arg1 + arg1);
            if ((temp8_1 + arg1) < temp8_1)
            {
            label_402a53:
                arg1 = (arg1 * 2);
                char temp12_1 = *ebx;
                *ebx = *ebx;
                c_11 = temp12_1 >= 0;
            label_402a58:
                *ecx_14 = (*ecx_14 - arg1);
                *arg1 = (*arg1 + arg1);
                *(cs + &ecx_14[0x1d]);
                goto label_402a65;
            }
        label_4029df:
            int16_t temp0_2;
            temp0_2 = __arpl_memw_gpr16(*(esp_1 + (edx_3 << 1)), esp_1);
            *(esp_1 + (edx_3 << 1)) = temp0_2;
            goto label_4029e3;
        }
        esp_1 = 0x4000382;
        *arg1 = (*arg1 + arg1);
        *arg5 = (*arg5 + *ecx_14[1]);
        *arg1 = (*arg1 ^ *edx_3[1]);
    label_402a4f:
        int32_t eflags_2;
        int16_t temp0_3;
        temp0_3 = __arpl_memw_gpr16(*(arg5 + 0x67), esp_1);
        *(arg5 + 0x67) = temp0_3;
        *arg1 = (*arg1 + arg1);
        *(edx_3 + 0x1180003) = (ROLB(*(edx_3 + 0x1180003), 0));
        *arg5 = (*arg5 + *ecx_14[1]);
        ecx_14[0x1d];
    label_402a65:
        *arg1 = (*arg1 + arg1);
        arg1 = (arg1 + ebx);
    label_402a69:
        int32_t temp19_1 = *ebx;
        *ebx = *ebx;
        arg1 = (arg1 + 0);
    label_402a6e:
        *arg1 = (*arg1 + arg1);
        *(cs + &ecx_14[0x1d]);
        *arg1 = (*arg1 + arg1);
        *arg1[1] = (*arg1[1] + *ecx_14[1]);
        *ebx = *ebx;
    }
    *arg1 = (*arg1 + arg1);
    arg1[0xb8000386] = (arg1[0xb8000386] + *ecx_14[1]);
    char* eax = (arg1 | *arg1);
    *arg5 = (*arg5 + *ecx_14[1]);
    void* esp_10 = (ecx_14[0x1d] * 0x362461);
    *eax = (*eax + eax);
    *eax = (*eax + eax);
    eax = *0x2e00003;
    char temp20 = *eax;
    *eax = (*eax + eax);
    bool c_14 = (temp20 + eax) < temp20;
    if (c_14)
    {
        *eax = (*eax + eax);
        data_4226b8 = edi;
    }
    if (((!c_14) && c_14))
    {
        *(((edx_3 + 1) * 2) - 0x80) = (*(((edx_3 + 1) * 2) - 0x80) + *(edx_3 + 1)[1]);
    }
    bool z_5;
    if ((c_14 || ((!c_14) && c_14)))
    {
        z_5 = (data_4226b4 & 0x20) == 0;
        ebx = &data_4226c0;
    }
    if (((!c_14) && (!c_14)))
    {
        eax = (eax & 0x30);
        *eax = (*eax ^ eax);
        *eax = (*eax + eax);
        eax = (eax + *eax[1]);
        *0x28b80003 = eax;
        char temp24_1 = *eax;
        *eax = (*eax + eax);
        bool c_15 = (temp24_1 + eax) < temp24_1;
        z_5 = temp24_1 == (-eax);
        if ((!c_15))
        {
            if ((!c_15))
            {
                eax = (eax & 0x30);
                eax = (eax ^ *eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                *eax = (*eax + eax);
                arg5[0x33] = (arg5[0x33] + edx_3);
                arg5[0x4226c0] = (arg5[0x4226c0] >> 0x50);
                *(esp_10 - 4) = eax;
                *(esp_10 - 8) = eax;
                *(esp_10 - 0xc) = eax;
                *(esp_10 - 0x10) = eax;
                sub_40ebf9(arg5, 0x4226bc);
                data_4226b8 = sub_40e917(arg5);
                *(esp_10 + 4);
                return;
            }
            int16_t edx_6;
            *edx_6[1] = (*(edx_3 + 1)[1] * 2);
            ebx[0x1089b0] = (ebx[0x1089b0] & *ebx[1]);
            z_5 = (ebx[0x1089b0] & *ebx[1]) == 0;
        }
    }
    if (((!z_5) && sub_40ffa5(ebx) != 0))
    {
        if ((data_4226b4 & 0x10) != 0)
        {
            *(esp_10 - 4) = 0x444;
            *(esp_10 - 8) = data_4226b0;
            sub_4053c9();
            *(esp_10 - 4);
        }
        *(esp_10 - 4) = 0x43d;
        *(esp_10 - 8) = data_4226b0;
        sub_4053c9();
        *(esp_10 - 4);
    }
    int32_t eax_4 = sub_40e8c5();
    char edx_7 = data_4226b4;
    int32_t esi_1 = eax_4;
    if ((edx_7 & 0x40) == 0)
    {
        eax_4 = sub_40e917(ebx);
        edx_7 = data_4226b4;
        *(esi_1 + 4) = eax_4;
    }
    else
    {
        *(esi_1 + 4) = data_4226ac;
        data_4226ac = edi;
    }
    eax_4 = edx_7;
    arg4[-1] = esi_1;
    eax_4 = (eax_4 & 0x30);
    if (eax_4 != 0x10)
    {
        int32_t ecx_23 = *(esi_1 + 4);
        *(esp_10 - 4) = edi;
        *(esp_10 - 8) = edi;
        *(esp_10 - 0xc) = edi;
        *(esp_10 - 0x10) = edi;
        *(esp_10 - 0x14) = edi;
        sub_40ebf9(ecx_23, 0x4226bc);
        edx_7 = data_4226b4;
    }
    if ((edx_7 & 0x20) != 0)
    {
        int32_t* i = data_4226bc;
        *(esp_10 - 4) = 0x4226bc;
        sub_402ea0(&data_401038, &arg4[-1]);
        *(esp_10 - 4) = edi;
        sub_402ea0(&data_40103c, &arg4[-1]);
        int32_t* i_1 = i;
        data_4226bc = i_1;
        if (i != 0)
        {
            int32_t* i_2 = data_433618;
            do
            {
                i = *i;
                *i_1 = i_2;
                i_2 = i_1;
                i_1 = i;
                data_4226bc = i_1;
            } while (i != 0);
            data_433618 = i_2;
        }
    }
    sub_40ea1c(&data_4226a8, arg4[-1]);
    *esp_10;
    *(esp_10 + 4);
    *(esp_10 + 8);
    *arg4;
}

int32_t __fastcall sub_402b07(int32_t* arg1)
{
    int32_t* var_8 = arg1;
    if (data_4226b8 != 0)
    {
        data_4226b4 = (data_4226b4 | 0x20);
        sub_402c29();
        data_4226b8 = 0;
    }
    if (((data_4226b4 & 0x20) != 0 && sub_40ffa5(&data_4226c0) != 0))
    {
        if ((data_4226b4 & 0x10) != 0)
        {
            sub_4053c9(data_4226b0, 0x444);
        }
        sub_4053c9(data_4226b0, 0x43d);
    }
    int32_t* eax_2 = sub_40e8c5();
    char edx = data_4226b4;
    int32_t* esi = eax_2;
    if ((edx & 0x40) == 0)
    {
        eax_2 = sub_40e917(&data_4226c0);
        edx = data_4226b4;
        esi[1] = eax_2;
    }
    else
    {
        esi[1] = data_4226ac;
        data_4226ac = 0;
    }
    eax_2 = edx;
    var_8 = esi;
    eax_2 = (eax_2 & 0x30);
    if (eax_2 != 0x10)
    {
        sub_40ebf9(esi[1], &data_4226bc, nullptr, nullptr, 0, 0, 0);
        edx = data_4226b4;
    }
    if ((edx & 0x20) != 0)
    {
        int32_t* i = data_4226bc;
        sub_402ea0(&data_401038, &var_8, &data_4226bc);
        sub_402ea0(&data_40103c, &var_8, nullptr);
        int32_t* i_1 = i;
        data_4226bc = i_1;
        if (i != 0)
        {
            int32_t* i_2 = data_433618;
            do
            {
                i = *i;
                *i_1 = i_2;
                i_2 = i_1;
                i_1 = i;
                data_4226bc = i_1;
            } while (i != 0);
            data_433618 = i_2;
        }
    }
    return sub_40ea1c(&data_4226a8, var_8);
}

int32_t* sub_402c29()
{
    data_41248f = data_41248e;
    int32_t* eax_1 = sub_40e8c5();
    eax_1[1] = data_4226b8;
    int32_t* i = data_4226bc;
    data_4226a8 = eax_1;
    sub_402ea0(&data_401038, &data_4226a8, &data_4226bc);
    sub_402ea0(&data_40103c, &data_4226a8, nullptr);
    int32_t* i_1 = i;
    data_4226bc = i_1;
    if (i != 0)
    {
        int32_t* i_2 = data_433618;
        do
        {
            i = *i;
            *i_1 = i_2;
            i_2 = i_1;
            i_1 = i;
            data_4226bc = i_1;
        } while (i != 0);
        data_433618 = i_2;
    }
    void* ecx_1 = data_4226a8;
    if ((ecx_1 == 0 && (data_4226b4 & 0x20) == 0))
    {
        int32_t __saved_esi_1 = data_4226b8;
        i_1 = sub_4053c9(data_4226a4, 0x43b);
        ecx_1 = data_4226a8;
    }
    if ((ecx_1 != 0 || (ecx_1 == 0 && (data_4226b4 & 0x20) == 0)))
    {
        i_1 = sub_40ffa5(*(ecx_1 + 4));
        if (i_1 != 0)
        {
            data_4226b4 = (data_4226b4 | 0x10);
        }
    }
    return i_1;
}

void sub_402ce6()
{
    if (data_4226b8 == 0)
    {
        data_4226b4 = (data_4226b4 & 0xdf);
    }
    else
    {
        sub_402c29();
        data_4226b8 = 0;
    }
    uint8_t ebx = data_41248f;
    if (data_4226c2 != 0)
    {
        ebx = (ebx | 0x20);
        data_41248f = ebx;
    }
    int32_t* esi = data_4226a8;
    if (esi == 0)
    {
        sub_4053c9(data_4226b0, 0x40d);
    }
    int32_t* eax;
    if ((data_4226b4 & 0x10) == 0)
    {
        if (*esi == 0)
        {
            eax = sub_402dc5(esi[1]);
            if (eax == 0)
            {
                esi = data_4226a8;
            }
            else
            {
                free(*(data_4226a8 + 4));
            }
        }
        if (((*esi == 0 && eax == 0) || *esi != 0))
        {
            data_412480 = esi;
        }
    }
    else
    {
        int32_t eax_1 = sub_40abc9(0x18);
        *(eax_1 + 8) = esi[1];
        *(eax_1 + 0x14) = ((ebx >> 5) & 1);
        *eax_1 = data_422694;
        data_422694 = eax_1;
        void* ecx_4 = *eax_1;
        if (ecx_4 != 0)
        {
            *(ecx_4 + 4) = eax_1;
        }
    }
    if (((((data_4226b4 & 0x10) == 0 && *esi == 0) && eax != 0) || (data_4226b4 & 0x10) != 0))
    {
        int32_t** ecx_7 = data_4226a8;
        eax = data_433618;
        data_433618 = ecx_7;
        *ecx_7 = eax;
    }
    data_4226a8 = 0;
    data_4226b4 = (data_4226b4 | 0x80);
}

uint32_t __fastcall sub_402dc5(void* arg1)
{
    void* var_8 = arg1;
    void* esi = arg1;
    int32_t ebx = 0;
    *var_8[3] = 0;
    if (_wcsicmp(esi, u".SILENT") == 0)
    {
        data_4226b4 = (data_4226b4 | 2);
        sub_40c807(0x73, 1);
        *var_8[3] = 1;
    }
    int32_t eax_1;
    int16_t edx_2;
    eax_1 = _wcsicmp(esi, u".IGNORE");
    uint32_t eax_2;
    if (eax_1 != 0)
    {
        void* const ecx_2 = u".SUFFIXES";
        int16_t* eax_3 = esi;
        while (true)
        {
            edx_2 = *eax_3;
            int16_t temp0_1 = *ecx_2;
            bool c_1 = edx_2 < temp0_1;
            if (edx_2 == temp0_1)
            {
                int16_t temp1_1;
                if (edx_2 != 0)
                {
                    edx_2 = eax_3[1];
                    temp1_1 = *(ecx_2 + 2);
                    c_1 = edx_2 < temp1_1;
                    if (edx_2 == temp1_1)
                    {
                        eax_3 = &eax_3[2];
                        ecx_2 = (ecx_2 + 4);
                        if (edx_2 != 0)
                        {
                            continue;
                        }
                    }
                }
                if ((edx_2 == 0 || (edx_2 != 0 && edx_2 == temp1_1)))
                {
                    eax_2 = 0;
                    break;
                }
            }
            eax_2 = ((eax_3 - eax_3) | 1);
            break;
        }
        if (eax_2 != 0)
        {
            eax_2 = u".PRECIOUS";
            while (true)
            {
                ecx_2 = *esi;
                int16_t temp2_1 = *eax_2;
                bool c_2 = ecx_2 < temp2_1;
                if (ecx_2 == temp2_1)
                {
                    if (ecx_2 == 0)
                    {
                        break;
                    }
                    ecx_2 = *(esi + 2);
                    int16_t temp3_1 = *(eax_2 + 2);
                    c_2 = ecx_2 < temp3_1;
                    if (ecx_2 == temp3_1)
                    {
                        esi = (esi + 4);
                        eax_2 = (eax_2 + 4);
                        if (ecx_2 == 0)
                        {
                            break;
                        }
                        continue;
                    }
                }
                ebx = ((0 - 0) | 1);
                break;
            }
            if (ebx != 0)
            {
                eax_2 = *var_8[3];
            }
            else
            {
                data_4226b4 = (data_4226b4 | 8);
            }
        }
        else
        {
            data_4226b4 = (data_4226b4 | 1);
        }
    }
    else
    {
        data_4226b4 = (data_4226b4 | 4);
        edx_2 = 1;
        sub_40c807(0x69, edx_2);
    }
    if (((eax_1 == 0 || (eax_1 != 0 && eax_2 == 0)) || ((eax_1 != 0 && eax_2 != 0) && ebx == 0)))
    {
        eax_2 = 1;
    }
    return eax_2;
}

void __fastcall sub_402ea0(int16_t* arg1, int32_t* arg2, int32_t** arg3)
{
    int32_t* i = *arg2;
    int32_t* i_2 = nullptr;
    int32_t i_4 = 0;
    int16_t* var_18 = arg1;
    int32_t var_1c = 0;
    int32_t i_5 = 0;
    int32_t var_10 = 0;
    while (i != 0)
    {
        if (wcspbrk(i[1], arg1) == 0)
        {
        label_402ff3:
            i_2 = i;
            i = *i;
        }
        else
        {
            int16_t* ecx_1 = i[1];
            if (*var_18 == 0x24)
            {
                var_1c = sub_40f30f(ecx_1, 0xff, arg3);
                free(i[1]);
            }
            else
            {
                if (sub_40ffa5(ecx_1) != 0)
                {
                    goto label_402ff3;
                }
                i_4 = sub_4106e7(i[1]);
                i_5 = i_4;
                if (i_4 == 0)
                {
                    goto label_402ff3;
                }
                var_10 = i[1];
            }
            int32_t eax_4 = *i;
            int32_t* i_3;
            if (i_2 == 0)
            {
                *arg2 = eax_4;
                *i = data_433618;
                i_3 = arg2;
            }
            else
            {
                *i_2 = eax_4;
                *i = data_433618;
                i_3 = i_2;
            }
            int32_t* i_1 = *i_3;
            data_433618 = i;
            int32_t var_34_4;
            if (*var_18 == 0x24)
            {
                int32_t var_14 = var_1c;
                while (true)
                {
                    int16_t* eax_12 = sub_40300c(&var_14);
                    if (eax_12 == 0)
                    {
                        break;
                    }
                    i_4 = sub_40e8c5();
                    i_5 = i_4;
                    *(i_4 + 4) = sub_40e917(eax_12);
                    *i_4 = *arg2;
                    *arg2 = i_4;
                    if (i_2 == 0)
                    {
                        i_2 = i_4;
                    }
                }
                var_34_4 = var_1c;
            }
            else
            {
                if (i_4 != 0)
                {
                    if (i_2 == 0)
                    {
                        int32_t* j_1 = *i_4;
                        i_2 = i_4;
                        if (j_1 != 0)
                        {
                            int32_t* j;
                            do
                            {
                                j = *j_1;
                                i_2 = j_1;
                                j_1 = j;
                            } while (j != 0);
                        }
                    }
                    sub_40ea1c(&i_5, *arg2);
                    i_4 = i_5;
                    *arg2 = i_4;
                }
                var_34_4 = var_10;
            }
            free(var_34_4);
            i = i_1;
        }
        arg1 = var_18;
    }
}

int16_t* __fastcall sub_40300c(int32_t* arg1)
{
    int32_t var_10 = 0x20;
    int16_t* ecx = *arg1;
    int32_t var_14 = 9;
    while (true)
    {
        int16_t i_3 = *ecx;
        if ((i_3 != 0x20 && i_3 != 9))
        {
            int16_t* ebx = ecx;
            int16_t* eax_1;
            if (i_3 == 0)
            {
                eax_1 = nullptr;
            }
            else
            {
                int16_t i_1;
                if (i_3 != 0x22)
                {
                    int16_t i_2 = i_3;
                    int16_t i;
                    do
                    {
                        i_1 = i_2;
                        if (i_2 == 0x20)
                        {
                            break;
                        }
                        i_1 = i_2;
                        if (i_2 == 9)
                        {
                            break;
                        }
                        ecx = &ecx[1];
                        i = *ecx;
                        i_2 = i;
                        i_1 = i;
                    } while (i != 0);
                }
                else
                {
                    int16_t i_4;
                    while (true)
                    {
                        ecx = &ecx[1];
                        i_4 = *ecx;
                        if (i_4 == 0)
                        {
                            break;
                        }
                        if (i_4 == 0x22)
                        {
                            break;
                        }
                        if ((!(i_4 != 0 && i_4 != 0x22)))
                        {
                            /* nop */
                        }
                    }
                    i_1 = i_4;
                }
                int16_t* eax_2 = ecx;
                if (i_1 == 0x22)
                {
                    ecx = &ecx[1];
                }
                if (((i_1 == 0x20 || i_1 == 9) || (i_1 == 0x22 && *ecx != 0)))
                {
                    *ecx = 0;
                }
                if ((i_1 == 0x22 && *ecx == 0))
                {
                    ecx = eax_2;
                }
                if ((((i_1 != 0x20 && i_1 != 9) && i_1 != 0x22) && i_1 == 0))
                {
                    ecx = (ecx - 2);
                }
                eax_1 = ebx;
                *arg1 = &ecx[1];
            }
            return eax_1;
        }
        ecx = &ecx[1];
    }
}

int32_t sub_4030d2()
{
    int32_t eax;
    eax = data_4226b4;
    void* const ecx = nullptr;
    if (eax < 0)
    {
        eax = (eax & 0x7f);
        data_4226b4 = eax;
    }
    if ((eax & 0x10) == 0)
    {
        if ((eax & 6) == 0)
        {
            int32_t* ecx_2;
            if ((eax & 1) == 0)
            {
                if (((eax & 8) != 0 && data_4226a8 != 0))
                {
                    ecx_2 = &data_42269c;
                }
                if ((eax & 8) == 0)
                {
                    int32_t eax_2 = sub_40abc9(0x20);
                    int32_t ecx_3 = data_4226a8;
                    data_422698 = eax_2;
                    *eax_2 = ecx_3;
                    *(data_422698 + 4) = data_4226bc;
                    goto label_4031d0;
                }
            }
            if (((eax & 1) != 0 && data_4226a8 != 0))
            {
                ecx_2 = &data_4226a0;
            }
            if ((((eax & 1) != 0 && data_4226a8 != 0) || (((eax & 1) == 0 && (eax & 8) != 0) && data_4226a8 != 0)))
            {
                sub_403766(ecx_2);
                goto label_4031d0;
            }
            if (((eax & 1) != 0 && data_4226a8 == 0))
            {
                int32_t* i_1 = data_4226a0;
                int32_t* i = i_1;
                if (i != 0)
                {
                    do
                    {
                        data_4226a0 = *i_1;
                        free(i[1]);
                        *i = data_433618;
                        i_1 = data_4226a0;
                        data_433618 = i;
                        i = i_1;
                    } while (i != 0);
                    goto label_4031d0;
                }
            }
        }
        else if (data_4226a8 != 0)
        {
            if ((eax & 2) != 0)
            {
                ecx = u".SILENT";
            }
            else if ((eax & 4) != 0)
            {
                ecx = u".IGNORE";
            }
            void* const var_8_2 = ecx;
            sub_4053c9(data_4226b0, 0x442);
            goto label_4031d0;
        }
    }
    else if (data_4226a8 != 0)
    {
        sub_4053c9(data_4226b0, 0x43e);
    label_4031d0:
        eax = data_4226b4;
    }
    data_4226a8 = 0;
    eax = (eax | 0x40);
    data_4226bc = 0;
    data_4226b4 = eax;
    return eax;
}

int32_t sub_4031ec()
{
    int32_t ecx;
    int32_t var_8 = ecx;
    int32_t eax;
    eax = data_4226b4;
    void* const ecx_1 = nullptr;
    char ebx = 1;
    *var_8[3] = 1;
    if ((eax & 0x10) != 0)
    {
        eax = data_4226a8;
        *(data_422694 + 0xc) = eax;
    }
    else if ((eax & 0xf) == 0)
    {
        int32_t* i_1 = data_412480;
        *(data_422698 + 8) = data_4226a8;
        *(data_422698 + 0xc) = data_4226bc;
        eax = data_41248f;
        *(data_422698 + 0x10) = eax;
        if (i_1 != 0)
        {
            int32_t* i;
            do
            {
                char eax_2;
                int32_t ecx_7;
                eax_2 = sub_402dc5(i_1[1]);
                if (eax_2 != 0)
                {
                    sub_4053c9(data_4226b0, 0x445);
                    ecx_7 = 0x445;
                }
                int32_t var_14_1 = ecx_7;
                eax = sub_4036a5(i_1[1], *var_8[3]);
                if (data_422690 == 0)
                {
                    data_422690 = i_1;
                    ebx = 0;
                }
                i = *i_1;
                data_412480 = i;
                if (ebx != 0)
                {
                    eax = data_433618;
                    *i_1 = eax;
                    data_433618 = i_1;
                }
                *var_8[3] = 0;
                i_1 = i;
            } while (i != 0);
        }
    }
    else if (data_4226a8 != 0)
    {
        if ((eax & 2) != 0)
        {
            ecx_1 = u".SILENT";
        }
        else if ((eax & 4) != 0)
        {
            ecx_1 = u".IGNORE";
        }
        else if ((eax & 8) != 0)
        {
            ecx_1 = u".PRECIOUS";
        }
        else if ((eax & 1) != 0)
        {
            ecx_1 = u".SUFFIXES";
        }
        void* const var_14_2 = ecx_1;
        eax = sub_4053c9(data_4226b0, 0x441);
    }
    data_412480 = 0;
    data_4226a8 = 0;
    data_4226bc = 0;
    data_422698 = 0;
    data_4226b4 = 0;
    return eax;
}

uint32_t sub_403323()
{
    wchar16* eax;
    int32_t* edx;
    eax = wcschr(data_4226b8, 0x24);
    if (eax != 0)
    {
        edx = 0xff;
        int32_t* i = data_4226bc;
        int32_t eax_1 = sub_40f30f(data_4226b8, edx, &data_4226bc);
        if (*eax_1 == 0)
        {
            sub_4053c9(data_4226b0, 0x3ec);
        }
        int32_t* i_1 = i;
        data_4226bc = i_1;
        if (i != 0)
        {
            int32_t* i_2 = data_433618;
            do
            {
                i = *i;
                *i_1 = i_2;
                i_2 = i_1;
                i_1 = i;
                data_4226bc = i_1;
            } while (i != 0);
            data_433618 = i_2;
        }
        free(data_4226b8);
        data_4226b8 = eax_1;
    }
    int16_t* esi_1 = data_4226b8;
    uint32_t eax_2 = *esi_1;
    if (eax_2 != 0)
    {
        uint32_t ecx_4 = eax_2;
        uint32_t eax_4;
        do
        {
            if (sub_4038ca(ecx_4) == 0)
            {
                break;
            }
            esi_1 = &esi_1[1];
            eax_4 = *esi_1;
            ecx_4 = eax_4;
        } while (eax_4 != 0);
        uint32_t eax_5 = *esi_1;
        if (eax_5 != 0)
        {
            uint32_t var_10_2 = eax_5;
            sub_4053c9(data_4226b0, 0x3e9);
        }
    }
    int16_t* edx_1 = data_4226ac;
    int16_t* ecx_5 = data_4226b8;
    data_41248d = 1;
    uint32_t eax_6 = sub_403552(ecx_5, edx_1, 0);
    if (eax_6 == 0)
    {
        free(data_4226b8);
        eax_6 = free(data_4226ac);
    }
    data_4226ac = 0;
    data_4226b8 = 0;
    return eax_6;
}

uint32_t __fastcall sub_403430(int16_t* arg1, int16_t* arg2, char arg3)
{
    int16_t* var_8 = arg1;
    int16_t* var_c = arg1;
    int16_t* str = arg2;
    int16_t* esi = arg1;
    uint32_t eax = *arg1;
    int16_t* str_1 = str;
    uint32_t ecx = eax;
    if (eax != 0)
    {
        uint32_t eax_2;
        do
        {
            if (sub_4038ca(ecx) == 0)
            {
                break;
            }
            esi = &esi[1];
            eax_2 = *esi;
            ecx = eax_2;
        } while (eax_2 != 0);
        str = str_1;
    }
    uint32_t eax_3 = *esi;
    if (eax_3 != 0)
    {
        if ((arg3 & 4) == 0)
        {
            uint32_t var_1c_1 = eax_3;
            sub_4053c9(data_4226b0, 0x3e9);
        }
        else
        {
            eax_3 = 0;
        }
    }
    if (((eax_3 != 0 && (arg3 & 4) == 0) || eax_3 == 0))
    {
        if ((arg3 & 0x40) != 0)
        {
            int32_t var_c_1 = 0;
            int32_t esi_1 = 0;
            wchar16* i = wcschr(str, 0x24);
            if (i != 0)
            {
                do
                {
                    esi_1 = (esi_1 + 1);
                    i = wcschr(&i[1], 0x24);
                } while (i != 0);
                str = str_1;
                if (esi_1 != 0)
                {
                    int16_t* str_3 = str;
                    do
                    {
                        i = *str_3;
                        str_3 = &str_3[1];
                    } while (i != 0);
                    int32_t eax_6 = ((esi_1 + 1) + ((str_3 - &str_3[1]) >> 1));
                    int32_t eax_7;
                    int32_t edx_1;
                    edx_1 = HIGHD((eax_6 * 2));
                    eax_7 = LOWD((eax_6 * 2));
                    int32_t ecx_5;
                    ecx_5 = ((eax_6 * 2) >> 0x20) != 0;
                    int32_t str_2 = sub_40aba4(((-ecx_5) | eax_7));
                    int16_t i_1 = *str;
                    int16_t* str_4 = str;
                    int32_t str_5 = str_2;
                    if (i_1 != 0)
                    {
                        do
                        {
                            *str_5 = i_1;
                            str_4 = &str_4[1];
                            str_5 = (str_5 + 2);
                            if (i_1 == 0x24)
                            {
                                *str_5 = 0x24;
                                str_5 = (str_5 + 2);
                            }
                            i_1 = *str_4;
                        } while (i_1 != 0);
                        str = str_1;
                    }
                    *str_5 = 0;
                    free(str);
                    str = str_2;
                }
            }
        }
        eax_3 = sub_403552(arg1, str, arg3);
    }
    return eax_3;
}

uint32_t __fastcall sub_403552(int16_t* arg1, int16_t* arg2, char arg3)
{
    char var_5 = 0;
    int32_t var_c = 0;
    if ((arg3 & 2) == 0)
    {
        uint32_t eax_2;
        if (data_41248d == 0)
        {
        label_4035e5:
            data_41248d = 0;
            uint32_t* esi_1 = sub_40ab10(arg1);
            if (esi_1 != 0)
            {
                eax_2 = esi_1[3];
                if ((eax_2 & 2) == 0)
                {
                    eax_2 = (eax_2 & data_41248c);
                    if ((eax_2 & 4) == 0)
                    {
                        goto label_403612;
                    }
                    goto label_403606;
                }
            label_403606:
                eax_2 = 0;
            }
            else
            {
            label_403612:
                int32_t* ecx_5 = sub_40e8c5();
                ecx_5[1] = arg2;
                if (esi_1 != 0)
                {
                    var_5 = 1;
                }
                else
                {
                    esi_1 = sub_40abc9(0x10);
                    esi_1[1] = arg1;
                }
                int32_t* eax_5;
                eax_5 = esi_1[3];
                eax_5 = (eax_5 & 0xef);
                eax_5 = (eax_5 | arg3);
                esi_1[3] = eax_5;
                *ecx_5 = esi_1[2];
                esi_1[2] = ecx_5;
                if (var_5 == 0)
                {
                    uint32_t** ecx_6 = data_436624;
                    data_436624 = 0;
                    *esi_1 = *ecx_6;
                    *ecx_6 = esi_1;
                }
                if (((arg3 & 0x40) == 0 && wcschr(arg2, 0x24) != 0))
                {
                    esi_1[3] = (esi_1[3] | 1);
                    eax_2 = sub_40ebf9(arg2, nullptr, nullptr, arg1, 1, 0, arg3);
                    esi_1[3] = (esi_1[3] & 0xfe);
                    if (eax_2 == 0)
                    {
                        esi_1[2] = 0;
                        esi_1[3] = (esi_1[3] | 0x10);
                    }
                }
                eax_2 = 1;
            }
            return eax_2;
        }
        if ((data_41248c & 4) != 0)
        {
            goto label_4035e5;
        }
        int32_t eax_1 = _wgetenv_s(&var_c, 0, 0, arg1);
        if (eax_1 != 0)
        {
            goto label_4035e5;
        }
        if (var_c <= eax_1)
        {
            goto label_4035e5;
        }
        eax_2 = sub_40ab10(arg1);
        if (eax_2 == 0)
        {
            goto label_4035c3;
        }
        eax_2 = *(eax_2 + 0xc);
        if ((eax_2 & 2) != 0)
        {
            goto label_403606;
        }
        eax_2 = (eax_2 & data_41248c);
        if ((eax_2 & 4) == 0)
        {
            goto label_4035c3;
        }
        goto label_403606;
    }
    if (*arg2 == 0)
    {
        goto label_4035e5;
    }
label_4035c3:
    if (_wputenv_s(arg1, sub_40f2a7(arg2)) != 0)
    {
        sub_4053c9(data_4226b0, 0x41f);
    }
    goto label_4035e5;
}

int32_t __fastcall sub_4036a5(int16_t* arg1, char arg2)
{
    int16_t* var_8 = arg1;
    int32_t eax = data_422698;
    *var_8[3] = arg2;
    if (eax == 0)
    {
        eax = sub_40abc9(0x20);
        data_422698 = eax;
    }
    int32_t ecx;
    int32_t edi;
    if (*var_8[3] == 0)
    {
        int32_t eax_2;
        eax_2 = sub_403880(eax);
        edi = eax_2;
    }
    else
    {
        int32_t eax_1 = sub_40abc9(8);
        ecx = data_422698;
        edi = eax_1;
        *(edi + 4) = ecx;
    }
    int32_t var_18 = ecx;
    int32_t var_1c = ecx;
    void** eax_3 = sub_40ea69(arg1);
    int32_t eax_4;
    if (eax_3 == 0)
    {
        *edi = 0;
        int32_t* eax_5 = sub_40abc9(0x20);
        int32_t ecx_7;
        ecx_7 = data_41248f;
        int32_t var_18_2 = ecx_7;
        eax_5[2] = ecx_7;
        eax_5[1] = arg1;
        eax_5[6] = edi;
        int32_t** ecx_9 = ((sub_40ea31(arg1) << 2) + &data_422490);
        eax_4 = *ecx_9;
        *eax_5 = eax_4;
        *ecx_9 = eax_5;
    }
    else
    {
        if (((eax_3[2] ^ data_41248f) & 0x20) != 0)
        {
            sub_4053c9(data_4226b0, 0x43f);
        }
        sub_40ea1c(&eax_3[6], edi);
        eax_4 = free(arg1);
    }
    return eax_4;
}

void __fastcall sub_403766(int32_t* arg1)
{
    void** i = data_4226a8;
    int32_t* esi = arg1;
    void** i_3 = i;
    int32_t* var_10 = esi;
    void** i_2 = i;
    void** i_1 = i_3;
    while (i != 0)
    {
        wchar16* eax_1;
        int32_t* edx_1;
        eax_1 = wcschr(i[1], 0x24);
        if (eax_1 == 0)
        {
            i = *i;
            *i_3 = (*i_3 & eax_1);
            i_2 = i;
            sub_40ea1c(esi, i_3);
        }
        else
        {
            edx_1 = 0xff;
            int32_t* j_3 = data_4226bc;
            int32_t eax_2 = sub_40f30f(i[1], edx_1, &data_4226bc);
            if (j_3 != data_4226bc)
            {
                int32_t* j_5 = data_433618;
                int32_t* j;
                do
                {
                    j = *j_3;
                    *j_3 = j_5;
                    j_5 = j_3;
                    j_3 = j;
                } while (j != data_4226bc);
                data_433618 = j_5;
            }
            int32_t var_c = 0;
            int32_t j_2 = wcstok_s(eax_2, &data_401044, &var_c);
            int32_t j_4 = j_2;
            if (j_2 != 0)
            {
                int32_t j_1 = j_2;
                do
                {
                    int32_t* eax_3 = sub_40e8c5();
                    eax_3[1] = sub_40e917(j_1);
                    sub_40ea1c(var_10, eax_3);
                    j_1 = wcstok_s(0, &data_401044, &var_c);
                } while (j_1 != 0);
                i = i_2;
                i_3 = i_1;
            }
            free(eax_2);
            free(i[1]);
            i = *i;
            esi = var_10;
            i_2 = i;
            *i_3 = data_433618;
            data_433618 = i_3;
        }
        i_3 = i;
        i_1 = i;
    }
}

int32_t __fastcall sub_403880(int32_t* arg1)
{
    int32_t eax = sub_40abc9(8);
    int32_t eax_1 = sub_40abc9(0x20);
    int32_t edx = *arg1;
    *(eax + 4) = eax_1;
    *eax_1 = edx;
    *(eax_1 + 4) = arg1[1];
    *(eax_1 + 8) = arg1[2];
    *(eax_1 + 0xc) = arg1[3];
    int32_t ecx_2;
    ecx_2 = arg1[4];
    *(eax_1 + 0x10) = ecx_2;
    *(eax_1 + 0x18) = arg1[6];
    *(eax_1 + 0x1c) = arg1[7];
    return eax;
}

int32_t __fastcall sub_4038ca(int32_t arg1)
{
    if (arg1 >= 0x80)
    {
        int32_t eax_1 = iswspace(arg1);
        int32_t eax_2 = (-eax_1);
        eax_2 = (eax_2 - eax_2);
        eax_2 = (eax_2 + 1);
        return eax_2;
    }
    uint32_t eax;
    eax = *(arg1 + 0x401060);
    eax = (eax & 1);
    return eax;
}

uint32_t sub_4038ef()
{
    __security_cookie;
    uint32_t eax_10;
    while (true)
    {
        eax_10 = data_422690;
        int32_t* ebx_1 = eax_10;
        if (ebx_1 == 0)
        {
            break;
        }
        int32_t eax_2;
        int32_t edx_1;
        eax_2 = wcspbrk(*(eax_10 + 4), &data_40103c);
        int32_t var_270;
        uint32_t esi_2;
        if (eax_2 == 0)
        {
            edx_1 = data_41248e;
            var_270 = 0;
            int32_t var_26c_2 = 0;
            void* const var_284_5 = &data_40103c;
            if (sub_403a3f(*(data_422690 + 4), &var_270) >= 0)
            {
                goto label_4039f4;
            }
            if ((data_41248c & 8) == 0)
            {
                goto label_4039f4;
            }
            esi_2 = 0xff;
        label_403a36:
            sub_404b9e(ebx_1);
            eax_10 = esi_2;
            break;
        }
        FindFileHandle var_264;
        void var_260;
        uint32_t i = sub_407a1b(*(data_422690 + 4), &var_260, &var_264);
        if (i != 0)
        {
            uint32_t eax_5;
            do
            {
                int32_t eax_3 = sub_40ff31(*(data_422690 + 4), i);
                int32_t eax_4;
                int32_t edx_4;
                eax_4 = sub_407a01(&var_260);
                var_270 = eax_4;
                void* var_284_2 = &var_260;
                int32_t var_26c_1 = edx_4;
                edx_4 = data_41248e;
                eax_5 = sub_403a3f(eax_3, &var_270);
                free(eax_3);
                if ((eax_5 < 0 && (data_41248c & 8) != 0))
                {
                    break;
                }
                i = sub_407ba7(&var_260, var_264);
            } while (i != 0);
            if ((!(eax_5 < 0 && (data_41248c & 8) != 0)))
            {
                goto label_4039f4;
            }
            esi_2 = 0xffffffff;
            goto label_403a36;
        }
        int32_t var_284_4 = *(data_422690 + 4);
        sub_4053c9(0, 0x42d);
    label_4039f4:
        data_422690 = *ebx_1;
        *ebx_1 = data_433618;
        data_433618 = ebx_1;
    }
    CookieCheckFunction(eax_10);
    return eax_10;
}

uint32_t __thiscall sub_403a3f(int16_t* arg1, int32_t* arg2)
{
    int32_t* var_c = arg1;
    var_c = nullptr;
    char edx;
    uint32_t eax = sub_403a7c(arg1, edx, arg2, 0, &var_c);
    int32_t* ecx = var_c;
    uint32_t esi = eax;
    if (ecx != 0)
    {
        esi = (esi + sub_404e10(ecx));
        sub_404e2e(&var_c);
    }
    return esi;
}

uint32_t __fastcall sub_403a7c(int16_t* arg1, char arg2, int32_t* arg3, int32_t arg4, int32_t* arg5)
{
    char var_c = arg1;
    int16_t* var_10 = arg1;
    data_412484 = (data_412484 + 1);
    int16_t* var_1c = arg1;
    int16_t* var_20 = arg1;
    var_c = 1;
    void** eax = sub_40ea69(arg1);
    if (eax == 0)
    {
        eax = sub_404bc8(arg1, arg2);
        var_c = 0;
    }
    uint32_t eax_1 = sub_403ad2(eax, arg2, arg3, var_c, arg4, arg5);
    data_412484 = (data_412484 - 1);
    return eax_1;
}

uint32_t __fastcall sub_403ad2(void* arg1, char arg2, int32_t* arg3, char arg4, int32_t arg5, int32_t* arg6)
{
    __security_cookie;
    int32_t var_4cc = arg5;
    int32_t var_4a8 = arg5;
    uint32_t eax_4 = 0;
    void* var_470 = nullptr;
    void* var_478 = nullptr;
    if (arg1 == 0)
    {
        *arg3 = 0;
        arg3[1] = 0;
    }
    else
    {
        if ((*(arg1 + 9) & 1) != 0)
        {
            int32_t var_4f8_1 = *(arg1 + 4);
            sub_4053c9(0, 0x42f);
        }
        int32_t* ebx_1 = *(arg1 + 0x1c);
        if (ebx_1 != 0)
        {
            uint32_t eax_5 = sub_404e10(*ebx_1);
            sub_404e2e(ebx_1);
            int32_t eax_6 = *(arg1 + 0x10);
            *(arg1 + 0x1c) = 0;
            *arg3 = eax_6;
            arg3[1] = *(arg1 + 0x14);
            eax_4 = eax_5;
        }
        else
        {
            eax_4 = *(arg1 + 9);
            void var_4b8;
            void var_464;
            if ((eax_4 & 2) == 0)
            {
                int32_t* ebx_2 = *(arg1 + 0x18);
                int32_t* lpSystemTimeAsFileTime_15 = nullptr;
                int32_t* edx_3 = nullptr;
                int32_t* var_488 = nullptr;
                eax_4 = (eax_4 | 1);
                int32_t* var_480 = nullptr;
                void** var_4d4_1 = nullptr;
                int32_t* var_49c_1 = nullptr;
                int32_t* var_484_1 = nullptr;
                int32_t* lpSystemTimeAsFileTime_3 = nullptr;
                int32_t* var_4a0_1 = nullptr;
                int32_t* lpSystemTimeAsFileTime_16 = nullptr;
                int32_t var_4b0_1 = 0;
                int32_t* lpSystemTimeAsFileTime_5 = nullptr;
                int32_t* var_490_1 = nullptr;
                int32_t* var_4bc_1 = nullptr;
                int32_t* var_4c8 = nullptr;
                int16_t* ecx_5 = *(arg1 + 4);
                int32_t* lpSystemTimeAsFileTime_11 = nullptr;
                int32_t* var_474_1 = nullptr;
                *(arg1 + 9) = eax_4;
                data_422ed4 = ecx_5;
                data_422ed8 = ecx_5;
                int32_t* var_4d0_1 = ebx_2;
                int32_t* lpSystemTimeAsFileTime;
                int32_t* var_4dc;
                if (ebx_2 != 0)
                {
                    if ((*(ebx_2[1] + 0x10) & 0x20) != 0)
                    {
                        if (sub_407a1b(ecx_5, &var_464, &var_4b8) == 0)
                        {
                            edx_3 = var_474_1;
                        }
                        else
                        {
                            int32_t* lpSystemTimeAsFileTime_17;
                            lpSystemTimeAsFileTime_17 = sub_407a01(&var_464);
                            lpSystemTimeAsFileTime_15 = lpSystemTimeAsFileTime_17;
                            var_474_1 = edx_3;
                            lpSystemTimeAsFileTime_11 = lpSystemTimeAsFileTime_15;
                        }
                    }
                    while (true)
                    {
                        int32_t* ecx_7 = ebx_2[1];
                        int32_t* lpSystemTimeAsFileTime_10 = nullptr;
                        int32_t* var_4a4_1 = nullptr;
                        var_484_1 = ecx_7;
                        if ((ecx_7[6] | ecx_7[7]) != 0)
                        {
                            int32_t temp1_1 = ecx_7[7];
                            if ((edx_3 <= temp1_1 && (edx_3 < temp1_1 || (edx_3 >= temp1_1 && lpSystemTimeAsFileTime_15 <= ecx_7[6]))))
                            {
                                lpSystemTimeAsFileTime_15 = ecx_7[6];
                                edx_3 = ecx_7[7];
                                lpSystemTimeAsFileTime_11 = lpSystemTimeAsFileTime_15;
                                var_474_1 = edx_3;
                            }
                        }
                        else
                        {
                            var_4bc_1 = &ecx_7[6];
                            int32_t i = sub_404687(ecx_7, *(arg1 + 4));
                            int32_t i_1 = i;
                            while (i != 0)
                            {
                                lpSystemTimeAsFileTime_16 = *(i + 8);
                                int32_t* eax_20 = *(i + 0xc);
                                int32_t* edx_5;
                                edx_5 = var_484_1[4];
                                uint32_t eax_22 = sub_403a7c(*(i + 4), edx_5, &lpSystemTimeAsFileTime_16, 0, &var_4c8);
                                void* ecx_10 = (var_470 + eax_22);
                                bool cond:3_1 = data_4226b7 == 0;
                                var_470 = ecx_10;
                                var_478 = ecx_10;
                                if (((!cond:3_1) && eax_22 != 0))
                                {
                                    void* var_4f8_7 = ecx_10;
                                    void* var_4fc_2 = ecx_10;
                                    if ((*(sub_40ea69(*(i + 4)) + 9) & 8) == 0)
                                    {
                                        int32_t var_4f8_8 = *(i + 4);
                                        data_412020 = 0;
                                        sub_4053c9(0, 0xfaa);
                                    }
                                    *(arg1 + 9) = (*(arg1 + 9) | 8);
                                }
                                int32_t* edx_8 = eax_20;
                                int32_t* lpSystemTimeAsFileTime_13 = lpSystemTimeAsFileTime_16;
                                if ((var_4a4_1 <= edx_8 && (var_4a4_1 < edx_8 || (var_4a4_1 >= edx_8 && lpSystemTimeAsFileTime_10 <= lpSystemTimeAsFileTime_13))))
                                {
                                    lpSystemTimeAsFileTime_10 = lpSystemTimeAsFileTime_13;
                                    var_4a4_1 = edx_8;
                                }
                                uint32_t eax_27;
                                if (((lpSystemTimeAsFileTime_15 | var_474_1) == 0 && (var_484_1[4] & 0x20) == 0))
                                {
                                    eax_27 = sub_407a1b(*(arg1 + 4), &var_464, &var_4b8);
                                    if (eax_27 == 0)
                                    {
                                        edx_8 = eax_20;
                                        lpSystemTimeAsFileTime_13 = lpSystemTimeAsFileTime_16;
                                    }
                                }
                                int32_t* eax_28;
                                if ((((((lpSystemTimeAsFileTime_15 | var_474_1) == 0 && (var_484_1[4] & 0x20) == 0) && eax_27 == 0) || (lpSystemTimeAsFileTime_15 | var_474_1) != 0) || ((lpSystemTimeAsFileTime_15 | var_474_1) == 0 && (var_484_1[4] & 0x20) != 0)))
                                {
                                    eax_28 = var_474_1;
                                }
                                if ((((lpSystemTimeAsFileTime_15 | var_474_1) == 0 && (var_484_1[4] & 0x20) == 0) && eax_27 != 0))
                                {
                                    int32_t* lpSystemTimeAsFileTime_18;
                                    int32_t* edx_7;
                                    lpSystemTimeAsFileTime_18 = sub_407a01(&var_464);
                                    lpSystemTimeAsFileTime_13 = lpSystemTimeAsFileTime_16;
                                    lpSystemTimeAsFileTime_15 = lpSystemTimeAsFileTime_18;
                                    eax_28 = edx_7;
                                    lpSystemTimeAsFileTime_11 = lpSystemTimeAsFileTime_15;
                                    edx_8 = eax_20;
                                    var_474_1 = eax_28;
                                    *(arg1 + 0x10) = lpSystemTimeAsFileTime_15;
                                    *(arg1 + 0x14) = eax_28;
                                }
                                if ((*(arg1 + 8) & 0x10) != 0)
                                {
                                label_403e64:
                                    int32_t* eax_29 = sub_40e8c5();
                                    eax_29[1] = sub_40e917(*(i + 4));
                                    sub_40ea1c(&var_488, eax_29);
                                }
                                else
                                {
                                    if (eax_28 < edx_8)
                                    {
                                        goto label_403e64;
                                    }
                                    if ((eax_28 <= edx_8 && lpSystemTimeAsFileTime_15 < lpSystemTimeAsFileTime_13))
                                    {
                                        goto label_403e64;
                                    }
                                    if ((data_4226b6 != 0 && (lpSystemTimeAsFileTime_15 == lpSystemTimeAsFileTime_13 && eax_28 == edx_8)))
                                    {
                                        goto label_403e64;
                                    }
                                }
                                int32_t* eax_31 = sub_40e8c5();
                                eax_31[1] = sub_40e917(*(i + 4));
                                sub_40ea1c(&var_480, eax_31);
                                i = *i;
                                lpSystemTimeAsFileTime_15 = lpSystemTimeAsFileTime_11;
                            }
                            int32_t* ecx_18 = var_4c8;
                            if (ecx_18 != 0)
                            {
                                void* ecx_20 = (var_470 + sub_404e10(ecx_18));
                                var_470 = ecx_20;
                                var_478 = ecx_20;
                                sub_404e2e(&var_4c8);
                            }
                            int32_t i_2 = i_1;
                            while (true)
                            {
                                int32_t i_3 = i_2;
                                if (i_2 == 0)
                                {
                                    break;
                                }
                                free(*(i_2 + 4));
                                i_2 = *i_2;
                                free(i_3);
                            }
                            int32_t eax_18;
                            eax_18 = var_484_1[4];
                            void** edx_10 = var_484_1[2];
                            if ((eax_18 & 0x20) == 0)
                            {
                                if (edx_10 != 0)
                                {
                                    if (var_49c_1 == 0)
                                    {
                                        var_49c_1 = var_484_1;
                                    }
                                    else
                                    {
                                        int32_t var_4f8_17 = *(arg1 + 4);
                                        sub_4053c9(0, 0xfa4);
                                    }
                                }
                                if ((var_490_1 <= var_4a4_1 && (var_490_1 < var_4a4_1 || (var_490_1 >= var_4a4_1 && lpSystemTimeAsFileTime_5 <= lpSystemTimeAsFileTime_10))))
                                {
                                    lpSystemTimeAsFileTime_5 = lpSystemTimeAsFileTime_10;
                                    var_490_1 = var_4a4_1;
                                }
                                goto label_4041a2;
                            }
                            void* ebx_5;
                            if (edx_10 == 0)
                            {
                            label_4041a2:
                                ebx_5 = var_470;
                            }
                            else
                            {
                                int32_t* ecx_24 = var_488;
                                uint8_t* esi_4 = *(arg1 + 4);
                                data_422ec8 = 0;
                                data_422ecc = 0;
                                data_422ed0 = ecx_24;
                                data_422ec4 = var_480;
                                int32_t* ecx_25;
                                ecx_25 = data_4226b7;
                                data_422ed4 = esi_4;
                                data_422ed8 = esi_4;
                                int32_t* lpSystemTimeAsFileTime_14;
                                if (((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 != 0))
                                {
                                    lpSystemTimeAsFileTime_14 = lpSystemTimeAsFileTime_11;
                                }
                                if ((((ecx_25 != 0 && (*(arg1 + 9) & 8) == 0) || ((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 == 0)) && var_474_1 >= var_4a4_1))
                                {
                                    lpSystemTimeAsFileTime_14 = lpSystemTimeAsFileTime_11;
                                    if ((var_474_1 <= var_4a4_1 && lpSystemTimeAsFileTime_14 < lpSystemTimeAsFileTime_10))
                                    {
                                        goto label_403fe7;
                                    }
                                }
                                if ((((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 != 0) || (((ecx_25 != 0 && (*(arg1 + 9) & 8) == 0) || ((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 == 0)) && var_474_1 >= var_4a4_1)))
                                {
                                    if ((data_4226b6 != 0 && lpSystemTimeAsFileTime_14 == lpSystemTimeAsFileTime_10))
                                    {
                                        esi_4 = *(arg1 + 4);
                                        if (var_474_1 == var_4a4_1)
                                        {
                                            goto label_403fe7;
                                        }
                                    }
                                    if (((lpSystemTimeAsFileTime_14 | var_474_1) == 0 && (lpSystemTimeAsFileTime_10 | var_4a4_1) == 0))
                                    {
                                        goto label_403fe7;
                                    }
                                    if (*var_484_1 == 0)
                                    {
                                        goto label_403fe7;
                                    }
                                }
                                if ((((ecx_25 != 0 && (*(arg1 + 9) & 8) == 0) || ((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 == 0)) && var_474_1 < var_4a4_1))
                                {
                                label_403fe7:
                                    int32_t ecx_26 = var_4cc;
                                    lpSystemTimeAsFileTime_14 = data_4333f8;
                                    data_4333f8 = 1;
                                    if (ecx_26 == 0)
                                    {
                                        int32_t* ecx_27 = var_480;
                                        if (ecx_27 == 0)
                                        {
                                            ecx_26 = 0;
                                        }
                                        else
                                        {
                                            ecx_26 = ecx_27[1];
                                        }
                                        var_4a8 = ecx_26;
                                        var_4cc = ecx_26;
                                    }
                                    void* ecx_30 = (var_470 + sub_40570a(esi_4, edx_10, var_484_1[3], eax_18, ecx_26));
                                    bool cond:17_1 = (*(arg1 + 8) & 4) != 0;
                                    var_470 = ecx_30;
                                    var_478 = ecx_30;
                                    uint32_t eax_41;
                                    int32_t* lpSystemTimeAsFileTime_1;
                                    int32_t* ecx_33;
                                    if ((!cond:17_1))
                                    {
                                        eax_41 = sub_407a1b(*(arg1 + 4), &var_464, &var_4b8);
                                        if (eax_41 != 0)
                                        {
                                            int32_t* edx_12;
                                            lpSystemTimeAsFileTime_1 = sub_407a01(&var_464);
                                            ecx_33 = edx_12;
                                        }
                                    }
                                    int32_t* lpSystemTimeAsFileTime_4;
                                    if ((cond:17_1 || ((!cond:17_1) && eax_41 == 0)))
                                    {
                                        lpSystemTimeAsFileTime_4 = lpSystemTimeAsFileTime_5;
                                        if ((lpSystemTimeAsFileTime_4 | var_490_1) == 0)
                                        {
                                            GetSystemTimeAsFileTime(&lpSystemTimeAsFileTime);
                                            lpSystemTimeAsFileTime_1 = lpSystemTimeAsFileTime;
                                            ecx_33 = var_4dc;
                                        }
                                    }
                                    if ((((!cond:17_1) && eax_41 != 0) || ((cond:17_1 || ((!cond:17_1) && eax_41 == 0)) && (lpSystemTimeAsFileTime_4 | var_490_1) == 0)))
                                    {
                                        var_4a0_1 = ecx_33;
                                        lpSystemTimeAsFileTime_3 = lpSystemTimeAsFileTime_1;
                                    }
                                    if (((cond:17_1 || ((!cond:17_1) && eax_41 == 0)) && (lpSystemTimeAsFileTime_4 | var_490_1) != 0))
                                    {
                                        lpSystemTimeAsFileTime_1 = lpSystemTimeAsFileTime_4;
                                        lpSystemTimeAsFileTime_3 = lpSystemTimeAsFileTime_4;
                                        ecx_33 = var_490_1;
                                        var_4a0_1 = var_490_1;
                                    }
                                    int32_t* esi_6 = var_488;
                                    ecx_7[6] = lpSystemTimeAsFileTime_1;
                                    int32_t* eax_44 = var_480;
                                    ecx_7[7] = ecx_33;
                                    int32_t* ecx_34 = eax_44;
                                    if (eax_44 != esi_6)
                                    {
                                        sub_404b9e(ecx_34);
                                        ecx_34 = esi_6;
                                    }
                                    sub_404b9e(ecx_34);
                                    var_488 = nullptr;
                                    var_480 = nullptr;
                                    ecx_25 = data_4226b7;
                                    data_4333f8 = lpSystemTimeAsFileTime_14;
                                }
                                if ((((((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 != 0) || (((ecx_25 != 0 && (*(arg1 + 9) & 8) == 0) || ((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 == 0)) && var_474_1 >= var_4a4_1)) && *var_484_1 != 0) || (((ecx_25 != 0 && (*(arg1 + 9) & 8) == 0) || ((ecx_25 == 0 || (ecx_25 != 0 && (*(arg1 + 9) & 8) != 0)) && var_470 == 0)) && var_474_1 < var_4a4_1)))
                                {
                                    if (ecx_25 == 0)
                                    {
                                        goto label_4041a2;
                                    }
                                    if ((*(arg1 + 9) & 8) != 0)
                                    {
                                        int32_t var_4f8_15 = *(arg1 + 4);
                                        sub_4053c9(0, 0xfab);
                                        *(arg1 + 9) = (*(arg1 + 9) & 0xf7);
                                    }
                                    ebx_5 = var_470;
                                    if (ebx_5 != 0)
                                    {
                                        int32_t var_4f8_16 = *(arg1 + 4);
                                        ebx_5 = nullptr;
                                        data_412020 = 0;
                                        var_470 = nullptr;
                                        var_478 = nullptr;
                                        sub_4053c9(0, 0xfaa);
                                    }
                                }
                            }
                            if ((var_484_1[4] & 0x20) != 0)
                            {
                                if (*var_4d0_1 == 0)
                                {
                                    int32_t* eax_47;
                                    eax_47 = *(arg1 + 9);
                                    eax_47 = (eax_47 & 0xfe);
                                    eax_47 = (eax_47 | 2);
                                    *(arg1 + 9) = eax_47;
                                    if (ebx_5 <= 0)
                                    {
                                        eax_47 = (eax_47 & 0xfb);
                                    }
                                    else
                                    {
                                        eax_47 = (eax_47 | 4);
                                    }
                                    int32_t* ecx_36 = var_474_1;
                                    *(arg1 + 9) = eax_47;
                                    int32_t* lpSystemTimeAsFileTime_6;
                                    if (var_4a0_1 < ecx_36)
                                    {
                                        lpSystemTimeAsFileTime_6 = lpSystemTimeAsFileTime_11;
                                    }
                                    else
                                    {
                                        if (var_4a0_1 <= ecx_36)
                                        {
                                            lpSystemTimeAsFileTime_6 = lpSystemTimeAsFileTime_11;
                                        }
                                        if ((var_4a0_1 > ecx_36 || (var_4a0_1 <= ecx_36 && lpSystemTimeAsFileTime_3 > lpSystemTimeAsFileTime_6)))
                                        {
                                            lpSystemTimeAsFileTime_6 = lpSystemTimeAsFileTime_3;
                                            ecx_36 = var_4a0_1;
                                        }
                                    }
                                    *(arg1 + 0x10) = lpSystemTimeAsFileTime_6;
                                    *(arg1 + 0x14) = ecx_36;
                                    *arg3 = lpSystemTimeAsFileTime_6;
                                    eax_4 = ebx_5;
                                    arg3[1] = ecx_36;
                                    goto label_40467e;
                                }
                                goto label_4041bf;
                            }
                        label_4041bf:
                            edx_3 = var_474_1;
                            lpSystemTimeAsFileTime_15 = lpSystemTimeAsFileTime_11;
                        }
                        ebx_2 = *var_4d0_1;
                        var_4d0_1 = ebx_2;
                        if (ebx_2 == 0)
                        {
                            ecx_5 = *(arg1 + 4);
                            break;
                        }
                    }
                }
                data_422ec8 = 0;
                data_422ecc = 0;
                int32_t* lpSystemTimeAsFileTime_8 = *arg3;
                int32_t* ebx_7 = arg3[1];
                if ((lpSystemTimeAsFileTime_8 | ebx_7) == 0)
                {
                    if ((*(arg1 + 0x10) | *(arg1 + 0x14)) != 0)
                    {
                        lpSystemTimeAsFileTime_8 = *(arg1 + 0x10);
                        ebx_7 = *(arg1 + 0x14);
                    }
                    else
                    {
                        uint32_t eax_52;
                        eax_52 = sub_407a1b(ecx_5, &var_464, &var_4b8);
                        if (eax_52 != 0)
                        {
                            ecx_5 = &var_464;
                            int32_t* lpSystemTimeAsFileTime_12;
                            int32_t* edx_19;
                            lpSystemTimeAsFileTime_12 = sub_407a01(ecx_5);
                            lpSystemTimeAsFileTime_8 = lpSystemTimeAsFileTime_12;
                            ebx_7 = edx_19;
                        }
                    }
                }
                if ((*(arg1 + 8) & 1) != 0)
                {
                    *(arg1 + 4);
                    ecx_5 = sub_40d121((data_412484 * 2), lpSystemTimeAsFileTime_8, ebx_7);
                }
                int32_t* var_4f8_20 = &var_4a8;
                void var_214;
                void** eax_54 = sub_40e713(arg1, &var_214, ecx_5, lpSystemTimeAsFileTime_8, ebx_7, &var_488, &var_480, &var_478, &lpSystemTimeAsFileTime_5);
                if ((eax_54 != 0 && var_49c_1 == 0))
                {
                    void** eax_55 = eax_54[3];
                    data_422ecc = &var_214;
                    var_4d4_1 = eax_55;
                }
                bool cond:1_1 = data_4226b7 == 0;
                int32_t* lpSystemTimeAsFileTime_7 = *(arg1 + 4);
                void* edx_22 = var_478;
                data_422ed0 = var_488;
                int32_t* ecx_40 = var_480;
                data_422ed4 = lpSystemTimeAsFileTime_7;
                data_422ed8 = lpSystemTimeAsFileTime_7;
                data_422ec4 = ecx_40;
                void* var_46c_1 = edx_22;
                if ((((!cond:1_1) && (*(arg1 + 9) & 8) == 0) || ((cond:1_1 || ((!cond:1_1) && (*(arg1 + 9) & 8) != 0)) && edx_22 == 0)))
                {
                    if (ebx_7 < var_490_1)
                    {
                    label_4043a7:
                        lpSystemTimeAsFileTime_7 = data_4333f8;
                        char var_465_1 = lpSystemTimeAsFileTime_7;
                        data_4333f8 = 1;
                        void** ecx_43;
                        if (var_49c_1 != 0)
                        {
                            int32_t eax_58 = var_4a8;
                            if (eax_58 == 0)
                            {
                                if (ecx_40 == 0)
                                {
                                    eax_58 = 0;
                                }
                                else
                                {
                                    eax_58 = ecx_40[1];
                                }
                            }
                            int32_t eax_60;
                            eax_60 = sub_40570a(*(arg1 + 4), var_49c_1[2], var_49c_1[3], var_49c_1[4], eax_58);
                            var_46c_1 = (var_478 + eax_60);
                            goto label_4044da;
                        }
                        int32_t* ecx_48;
                        if (var_4d4_1 == 0)
                        {
                            void* edx_32;
                            if ((data_41248c & 0x10) == 0)
                            {
                                if (arg4 != 0)
                                {
                                    goto label_4044da;
                                }
                                lpSystemTimeAsFileTime_7 = (lpSystemTimeAsFileTime_8 | ebx_7);
                                if (lpSystemTimeAsFileTime_7 != 0)
                                {
                                    goto label_4044da;
                                }
                                if (data_4226b7 == lpSystemTimeAsFileTime_7)
                                {
                                    int32_t var_4f8_25 = *(arg1 + 4);
                                    sub_4053c9(0, 0x431);
                                label_4044da:
                                    ecx_43 = var_465_1;
                                    data_4333f8 = ecx_43;
                                    if (var_49c_1 != 0)
                                    {
                                    label_40450f:
                                        GetSystemTimeAsFileTime(&lpSystemTimeAsFileTime);
                                        int32_t* lpSystemTimeAsFileTime_2 = lpSystemTimeAsFileTime;
                                        lpSystemTimeAsFileTime_7 = (lpSystemTimeAsFileTime_2 + 2);
                                        ecx_48 = (var_4dc + 0);
                                    label_40452e:
                                        edx_22 = var_46c_1;
                                        var_4a0_1 = ecx_48;
                                        lpSystemTimeAsFileTime_3 = lpSystemTimeAsFileTime_7;
                                        if ((var_4bc_1 != 0 && var_49c_1 != 0))
                                        {
                                            *var_4bc_1 = lpSystemTimeAsFileTime_7;
                                            edx_22 = var_46c_1;
                                            var_4bc_1[1] = ecx_48;
                                        }
                                    }
                                }
                                else
                                {
                                    edx_32 = 1;
                                }
                            }
                            else
                            {
                                if (var_484_1 == 0)
                                {
                                    goto label_4044a1;
                                }
                                lpSystemTimeAsFileTime_7 = sub_40570a(*(arg1 + 4), var_484_1[2], var_484_1[3], var_484_1[4], var_4a8);
                                edx_32 = (var_478 + lpSystemTimeAsFileTime_7);
                            }
                            if ((((((data_41248c & 0x10) == 0 && arg4 == 0) && lpSystemTimeAsFileTime_7 == 0) && data_4226b7 != lpSystemTimeAsFileTime_7) || (data_41248c & 0x10) != 0))
                            {
                                lpSystemTimeAsFileTime_7 = var_465_1;
                                var_46c_1 = edx_32;
                            label_4044a1:
                                data_4333f8 = lpSystemTimeAsFileTime_7;
                            }
                        }
                        else
                        {
                            int32_t eax_61;
                            if ((eax_54[5] == 0 || (eax_54[5] != 0 && (data_41248c & 0x40) != 0)))
                            {
                                eax_61 = sub_40570a(*(arg1 + 4), var_4d4_1, eax_54[4], *(arg1 + 8), var_4a8);
                                var_46c_1 = (var_478 + eax_61);
                            }
                            if ((eax_54[5] != 0 && (data_41248c & 0x40) == 0))
                            {
                                void** var_4f8_22 = var_4d4_1;
                                sub_404c0f(arg6, eax_54, arg1);
                            }
                            eax_61 = var_465_1;
                            data_4333f8 = eax_61;
                        }
                        if (((var_4d4_1 == 0 && (((((data_41248c & 0x10) == 0 && arg4 == 0) && lpSystemTimeAsFileTime_7 == 0) && data_4226b7 != lpSystemTimeAsFileTime_7) || (data_41248c & 0x10) != 0)) || (((((((var_4d4_1 == 0 && (data_41248c & 0x10) == 0) && arg4 == 0) && lpSystemTimeAsFileTime_7 == 0) && data_4226b7 == lpSystemTimeAsFileTime_7) && var_49c_1 == 0) || var_4d4_1 != 0) && var_4d4_1 == 0)))
                        {
                            if (data_422ec4 == 0)
                            {
                                goto label_40450f;
                            }
                            lpSystemTimeAsFileTime_7 = lpSystemTimeAsFileTime_5;
                            ecx_48 = var_490_1;
                            goto label_40452e;
                        }
                        if ((((((((var_4d4_1 == 0 && (data_41248c & 0x10) == 0) && arg4 == 0) && lpSystemTimeAsFileTime_7 == 0) && data_4226b7 == lpSystemTimeAsFileTime_7) && var_49c_1 == 0) || var_4d4_1 != 0) && var_4d4_1 != 0))
                        {
                            goto label_40450f;
                        }
                    }
                    else
                    {
                        if ((ebx_7 <= var_490_1 && lpSystemTimeAsFileTime_8 < lpSystemTimeAsFileTime_5))
                        {
                            goto label_4043a7;
                        }
                        if ((data_4226b6 != 0 && (lpSystemTimeAsFileTime_8 == lpSystemTimeAsFileTime_5 && ebx_7 == var_490_1)))
                        {
                            goto label_4043a7;
                        }
                        if (((lpSystemTimeAsFileTime_8 | ebx_7) == 0 && (lpSystemTimeAsFileTime_5 | var_490_1) == 0))
                        {
                            goto label_4043a7;
                        }
                        if ((*(arg1 + 8) & 0x10) != 0)
                        {
                            goto label_4043a7;
                        }
                        lpSystemTimeAsFileTime_7 = *(arg1 + 4);
                    }
                }
                if ((((((cond:1_1 || ((!cond:1_1) && (*(arg1 + 9) & 8) != 0)) && edx_22 != 0) || ((((!cond:1_1) && (*(arg1 + 9) & 8) == 0) || ((cond:1_1 || ((!cond:1_1) && (*(arg1 + 9) & 8) != 0)) && edx_22 == 0)) && ebx_7 >= var_490_1)) && (data_41248c & 8) == 0) && (data_412484 == 1 && (*(arg1 + 9) & 8) == 0)))
                {
                    int32_t* lpSystemTimeAsFileTime_9 = lpSystemTimeAsFileTime_7;
                    sub_4054a3(2);
                    edx_22 = var_478;
                }
                if ((data_4226b7 != 0 && edx_22 != 0))
                {
                    bool cond:8_1 = (*(arg1 + 9) & 8) == 0;
                    data_412020 = 0;
                    int32_t var_4fc_10;
                    if ((!cond:8_1))
                    {
                        int32_t var_4f8_27 = *(arg1 + 4);
                        var_4fc_10 = 0xfab;
                    }
                    if ((cond:8_1 && data_412484 == 1))
                    {
                        int32_t var_4f8_28 = *(arg1 + 4);
                        var_4fc_10 = 0xfaa;
                    }
                    if (((!cond:8_1) || (cond:8_1 && data_412484 == 1)))
                    {
                        sub_4053c9(0, var_4fc_10);
                    }
                }
                if (((data_41248c & 8) == 0 || ((data_41248c & 8) != 0 && data_412484 != 1)))
                {
                    lpSystemTimeAsFileTime_7 = *(arg1 + 9);
                    lpSystemTimeAsFileTime_7 = (lpSystemTimeAsFileTime_7 & 0xfe);
                    bool cond:7_1 = *(arg1 + 0x1c) != 0;
                    *(arg1 + 9) = lpSystemTimeAsFileTime_7;
                    if ((!cond:7_1))
                    {
                        lpSystemTimeAsFileTime_7 = (lpSystemTimeAsFileTime_7 | 2);
                        if (var_46c_1 <= 0)
                        {
                            lpSystemTimeAsFileTime_7 = (lpSystemTimeAsFileTime_7 & 0xfb);
                        }
                        else
                        {
                            lpSystemTimeAsFileTime_7 = (lpSystemTimeAsFileTime_7 | 4);
                        }
                        *(arg1 + 9) = lpSystemTimeAsFileTime_7;
                    }
                    if ((var_4a0_1 >= ebx_7 && (var_4a0_1 > ebx_7 || (var_4a0_1 <= ebx_7 && lpSystemTimeAsFileTime_3 > lpSystemTimeAsFileTime_8))))
                    {
                        lpSystemTimeAsFileTime_8 = lpSystemTimeAsFileTime_3;
                        ebx_7 = var_4a0_1;
                    }
                    *(arg1 + 0x14) = ebx_7;
                    *(arg1 + 0x10) = lpSystemTimeAsFileTime_8;
                    arg3[1] = ebx_7;
                    int32_t* ebx_9 = var_488;
                    *arg3 = lpSystemTimeAsFileTime_8;
                    int32_t* eax_70 = var_480;
                    int32_t* ecx_52 = eax_70;
                    if (eax_70 != ebx_9)
                    {
                        sub_404b9e(ecx_52);
                        ecx_52 = ebx_9;
                    }
                    sub_404b9e(ecx_52);
                    eax_4 = var_46c_1;
                }
                if (((data_41248c & 8) != 0 && data_412484 == 1))
                {
                    int32_t* eax_65 = var_480;
                    int32_t* ecx_51 = eax_65;
                    int32_t* ebx_8 = var_488;
                    if (eax_65 != ebx_8)
                    {
                        sub_404b9e(ecx_51);
                        ecx_51 = ebx_8;
                    }
                    sub_404b9e(ecx_51);
                    int32_t eax_66 = data_422ec0;
                    int32_t eax_67 = (-eax_66);
                    eax_4 = (eax_67 - eax_67);
                }
            }
            else
            {
                if ((arg2 & 1) != 0)
                {
                    *(arg1 + 4);
                    sub_40d121((data_412484 * 2), *(arg1 + 0x10), *(arg1 + 0x14));
                }
                *arg3 = *(arg1 + 0x10);
                arg3[1] = *(arg1 + 0x14);
                if ((((data_41248c & 8) == 0 && (data_412484 == 1 && (*(arg1 + 9) & 4) == 0)) && sub_407a1b(*(arg1 + 4), &var_464, &var_4b8) != 0))
                {
                    int32_t var_4f8_4 = *(arg1 + 4);
                    sub_4054a3(2);
                }
                eax_4 = ((*(arg1 + 9) >> 2) & 1);
            }
        }
    }
label_40467e:
    CookieCheckFunction(eax_4);
    return eax_4;
}

int32_t** __fastcall sub_404687(int32_t* arg1, int32_t* arg2)
{
    __security_cookie;
    void** i = *arg1;
    int32_t* var_270 = nullptr;
    int32_t* var_284 = arg2;
    void** i_1 = i;
    int32_t** edi = nullptr;
    int32_t** var_26c = nullptr;
    int32_t* var_288 = arg1[1];
    if (i != 0)
    {
        do
        {
            int16_t* edi_1 = i[1];
            int16_t* ecx = edi_1;
            int16_t* var_274_1 = edi_1;
            int16_t j_4 = *ecx;
            int16_t j_3 = j_4;
            if (j_4 != 0)
            {
                int16_t j_2 = j_4;
                int16_t j;
                do
                {
                    j_3 = j_2;
                    if (j_2 == 0x24)
                    {
                        break;
                    }
                    if (j_2 == 0x5e)
                    {
                        ecx = &ecx[1];
                    }
                    ecx = &ecx[1];
                    j = *ecx;
                    j_2 = j;
                    j_3 = j;
                } while (j != 0);
                i = i_1;
                edi_1 = var_274_1;
                arg2 = var_284;
            }
            if (j_3 != 0)
            {
                data_422ec8 = arg2;
                arg2 = 1;
                int16_t* eax_3 = sub_40f30f(edi_1, arg2, &var_288);
                edi_1 = eax_3;
                var_274_1 = eax_3;
            }
            int32_t esi_1 = sub_40e917(edi_1);
            int32_t var_280 = esi_1;
            int16_t* var_268;
            if (sub_404a60(&var_280, &var_268) != 0)
            {
                char j_1;
                do
                {
                    int16_t* esi_2 = var_268;
                    int32_t edi_2 = esi_2;
                    int16_t* esi_3;
                    if (*esi_2 != 0x7b)
                    {
                        esi_3 = nullptr;
                        var_268 = nullptr;
                    }
                    else
                    {
                        int16_t k_1 = 0x7b;
                        int16_t k_2;
                        int16_t k;
                        do
                        {
                            k_2 = k_1;
                            if (k_1 == 0x7d)
                            {
                                break;
                            }
                            if (k_1 == 0x5e)
                            {
                                edi_2 = (edi_2 + 2);
                            }
                            edi_2 = (edi_2 + 2);
                            k = *edi_2;
                            k_1 = k;
                            k_2 = k;
                        } while (k != 0);
                        esi_3 = var_268;
                        if (k_2 != 0)
                        {
                            *edi_2 = 0;
                            edi_2 = (edi_2 + 2);
                            esi_3 = &esi_3[1];
                            var_268 = esi_3;
                        }
                    }
                    char var_25d_1 = 0;
                    int32_t var_258_1 = 0;
                    int32_t var_254_1 = 0;
                    int32_t var_248_1 = 0;
                    int32_t var_244_1 = 0;
                    int32_t str_2 = sub_40e917(edi_2);
                    int32_t str_1 = str_2;
                    int32_t eax_6 = wcspbrk(edi_2, &data_40103c);
                    void var_25c;
                    void var_230;
                    int32_t eax_7;
                    int32_t str;
                    if ((eax_6 != 0 || (eax_6 == 0 && esi_3 != 0)))
                    {
                        eax_7 = sub_407bca(esi_3, edi_2, &var_25c, &var_270);
                        if (eax_7 != 0)
                        {
                            var_25d_1 = 1;
                            free(str_2);
                            edi_2 = eax_7;
                            str = sub_40ff31(eax_7, &var_230);
                            str_1 = str;
                        }
                    }
                    if (((eax_6 == 0 && esi_3 == 0) || ((eax_6 != 0 || (eax_6 == 0 && esi_3 != 0)) && eax_7 == 0)))
                    {
                        str = str_1;
                    }
                    do
                    {
                        int32_t* ebx_1 = sub_40abc9(0x10);
                        wchar16* eax_10 = wcschr(str, 0x20);
                        wchar16* eax_11;
                        if (eax_10 != 0)
                        {
                            eax_11 = wcschr(str, 0x22);
                            if (eax_11 == 0)
                            {
                                int32_t ecx_10 = (str + 2);
                                do
                                {
                                    eax_11 = *str;
                                    str = (str + 2);
                                } while (eax_11 != 0);
                                int32_t eax_13;
                                int32_t edx_3;
                                edx_3 = HIGHD(((((str - ecx_10) >> 1) + 3) * 2));
                                eax_13 = LOWD(((((str - ecx_10) >> 1) + 3) * 2));
                                int32_t ecx_11;
                                ecx_11 = (((((str - ecx_10) >> 1) + 3) * 2) >> 0x20) != 0;
                                int32_t eax_14 = sub_40aba4(((-ecx_11) | eax_13));
                                ebx_1[1] = eax_14;
                                wcscpy_s(eax_14, (((str - ecx_10) >> 1) + 3), &data_40104c);
                                wcscat_s(ebx_1[1], (((str - ecx_10) >> 1) + 3), str_1);
                                wcscat_s(ebx_1[1], (((str - ecx_10) >> 1) + 3), &data_40104c);
                                str = str_1;
                            }
                        }
                        if ((eax_10 == 0 || (eax_10 != 0 && eax_11 != 0)))
                        {
                            ebx_1[1] = sub_40e917(str);
                        }
                        uint32_t var_27c_1;
                        uint32_t eax_16;
                        uint32_t edx_5;
                        if (data_4226b5 != 0)
                        {
                            eax_16 = sub_407a1b(str, &var_25c, &var_270);
                            if (eax_16 == 0)
                            {
                                ebx_1[3] = eax_16;
                                edx_5 = eax_16;
                                var_27c_1 = eax_16;
                            }
                        }
                        if ((data_4226b5 == 0 || (data_4226b5 != 0 && eax_16 != 0)))
                        {
                            uint32_t edx_6;
                            eax_16 = sub_407a01(&var_25c);
                            uint32_t var_28c_1 = eax_16;
                            var_27c_1 = edx_6;
                            edx_5 = eax_16;
                            ebx_1[3] = edx_6;
                        }
                        bool cond:0_1 = data_4226b5 == 0;
                        ebx_1[2] = eax_16;
                        if (cond:0_1)
                        {
                            sub_40ea1c(&var_26c, ebx_1);
                        }
                        else
                        {
                            int32_t** ecx_18 = var_26c;
                            int32_t** eax_17;
                            if (ecx_18 != 0)
                            {
                                eax_17 = ecx_18;
                                do
                                {
                                    int32_t temp2_1 = eax_17[3];
                                    if (var_27c_1 > temp2_1)
                                    {
                                        break;
                                    }
                                    if ((var_27c_1 >= temp2_1 && edx_5 > eax_17[2]))
                                    {
                                        break;
                                    }
                                    ecx_18 = eax_17;
                                    eax_17 = *eax_17;
                                } while (eax_17 != 0);
                                str = str_1;
                                if (ecx_18 != eax_17)
                                {
                                    *ecx_18 = ebx_1;
                                    *ebx_1 = eax_17;
                                }
                            }
                            if ((ecx_18 == 0 || (ecx_18 != 0 && ecx_18 == eax_17)))
                            {
                                var_26c = ebx_1;
                            }
                        }
                        free(str);
                        if (var_25d_1 == 0)
                        {
                            break;
                        }
                        if (wcspbrk(edi_2, &data_40103c) == 0)
                        {
                            break;
                        }
                        if (sub_407ba7(&var_25c, var_270) == 0)
                        {
                            break;
                        }
                        str = sub_40ff31(edi_2, &var_230);
                        str_1 = str;
                    } while (str != 0);
                    j_1 = sub_404a60(&var_280, &var_268);
                } while (j_1 != 0);
                i = i_1;
                edi_1 = var_274_1;
            }
            if (edi_1 != i[1])
            {
                free(edi_1);
            }
            free(esi_1);
            i = *i;
            arg2 = var_284;
            i_1 = i;
        } while (i != 0);
        edi = var_26c;
    }
    CookieCheckFunction(edi);
    return edi;
}

uint32_t __fastcall sub_404a60(int32_t* arg1, int16_t** arg2)
{
    int32_t* ebx = arg1;
    int32_t* var_8 = ebx;
    int16_t* esi = *ebx;
    uint32_t eax = *esi;
    int16_t edi = eax;
    if (eax != 0)
    {
        int16_t ecx = eax;
        do
        {
            if (ecx != 0x20)
            {
                edi = ecx;
                if (ecx != 9)
                {
                    break;
                }
            }
            esi = &esi[1];
            eax = *esi;
            ecx = eax;
            edi = eax;
        } while (eax != 0);
        ebx = var_8;
    }
    *arg2 = esi;
    if (edi == 0)
    {
        eax = 0;
    }
    else
    {
        int16_t ecx_2;
        if (edi != 0x22)
        {
            ecx_2 = edi;
        }
        if (edi == 0x7b)
        {
            uint32_t eax_1;
            do
            {
                esi = &esi[1];
                if (*esi == 0x22)
                {
                    esi = &esi[1];
                    int16_t i;
                    do
                    {
                        i = *esi;
                        if (i == 0)
                        {
                            break;
                        }
                        esi = &esi[1];
                    } while (i != 0x22);
                }
                eax_1 = *esi;
                if (eax_1 == 0x7d)
                {
                    break;
                }
            } while (eax_1 != 0);
            if (eax_1 == 0)
            {
                sub_4053c9(0, 0x423);
            }
            esi = &esi[1];
            eax = *esi;
            ecx_2 = eax;
        }
        bool cond:0_1;
        if ((((edi != 0x22 && edi != 0x7b) || (edi == 0x7b && eax != 0x22)) && ecx_2 != 0))
        {
            int16_t ecx_4 = ecx_2;
            int16_t edx;
            do
            {
                edx = ecx_4;
                if (ecx_4 == 0x20)
                {
                    break;
                }
                edx = ecx_4;
                if (ecx_4 == 9)
                {
                    break;
                }
                esi = &esi[1];
                eax = *esi;
                ecx_4 = eax;
                edx = eax;
            } while (eax != 0);
            ebx = var_8;
            cond:0_1 = edx == 0;
        }
        if ((edi == 0x7b && eax == 0x22))
        {
            int16_t i_1 = 0x22;
            while (i_1 != 0)
            {
                esi = &esi[1];
                eax = *esi;
                i_1 = eax;
                if (eax == 0x22)
                {
                    break;
                }
            }
            if (i_1 != 0)
            {
                goto label_404ae2;
            }
        }
        if (edi == 0x22)
        {
            int16_t i_2 = 0x22;
            while (i_2 != 0)
            {
                esi = &esi[1];
                eax = *esi;
                i_2 = eax;
                if (eax == 0x22)
                {
                    break;
                }
            }
            if (i_2 != 0)
            {
                goto label_404ae2;
            }
        }
        if (((edi == 0x7b && eax == 0x22) || edi == 0x22))
        {
            sub_4053c9(0, 0x40e);
        label_404ae2:
            esi = &esi[1];
            cond:0_1 = *esi == 0;
        }
        if (((((edi == 0x7b && eax == 0x22) || edi == 0x22) || (((edi != 0x22 && edi != 0x7b) || (edi == 0x7b && eax != 0x22)) && ecx_2 != 0)) && (!cond:0_1)))
        {
            *esi = 0;
            esi = &esi[1];
        }
        *ebx = esi;
        eax = 1;
    }
    return eax;
}

void __fastcall sub_404b9e(int32_t* arg1)
{
    int32_t* i = arg1;
    int32_t* i_1 = arg1;
    while (i != 0)
    {
        i = *i;
        free(i_1[1]);
        *i_1 = data_433618;
        data_433618 = i_1;
        i_1 = i;
    }
}

int32_t __fastcall sub_404bc8(uint8_t* arg1, char arg2)
{
    int32_t eax = sub_40abc9(0x20);
    int32_t eax_1;
    int32_t ecx_1;
    eax_1 = sub_40e917(arg1);
    *(eax + 4) = eax_1;
    int32_t var_10 = ecx_1;
    *(eax + 8) = arg2;
    *(eax + 9) = 0;
    *(eax + 0x10) = 0;
    *(eax + 0x14) = 0;
    *(eax + 0x18) = 0;
    int32_t* ecx_3 = ((sub_40ea31(arg1) << 2) + &data_422490);
    *eax = *ecx_3;
    *ecx_3 = eax;
    return eax;
}

void* __fastcall sub_404c0f(int32_t* arg1, int32_t arg2, void* arg3)
{
    int32_t* var_8 = arg1;
    int32_t eax = arg2;
    void** i_1 = nullptr;
    int32_t var_8_1 = eax;
    void** i = *arg1;
    if (i != 0)
    {
        do
        {
            if (i[1] == eax)
            {
                eax = i[2];
                if (eax == *(arg3 + 8))
                {
                    break;
                }
                eax = arg2;
            }
            i_1 = i;
            i = *i;
        } while (i != 0);
    }
    if ((i == 0 || i == 0))
    {
        i = sub_40abc9(0x14);
        i[1] = var_8_1;
        i[2] = *(arg3 + 8);
        if (i_1 != 0)
        {
            *i_1 = i;
        }
        else
        {
            void*** eax_4 = *arg1;
            if (eax_4 == 0)
            {
                *arg1 = i;
            }
            else
            {
                *eax_4 = i;
            }
        }
    }
    int32_t* eax_5 = sub_40e8c5();
    eax_5[1] = sub_40e917(*(arg3 + 4));
    sub_40ea1c(&i[3], eax_5);
    int32_t* eax_8 = sub_40e8c5();
    eax_8[1] = sub_40e917(data_422ecc);
    sub_40ea1c(&i[4], eax_8);
    *(arg3 + 0x1c) = arg1;
    return arg3;
}

int32_t __fastcall sub_404cbb(void* arg1)
{
    void* ebx = arg1;
    void* var_c = ebx;
    int32_t edi = 0;
    void** i = *(ebx + 0x10);
    int32_t var_10 = 0;
    if (i != 0)
    {
        do
        {
            int16_t* str_1 = i[1];
            int16_t* str_2 = str_1;
            void* eax_1;
            do
            {
                eax_1 = *str_2;
                str_2 = &str_2[1];
            } while (eax_1 != 0);
            edi = ((edi + 1) + ((str_2 - &str_2[1]) >> 1));
            if ((*str_1 != 0x22 && wcschr(str_1, 0x20) != 0))
            {
                edi = (edi + 2);
            }
            i = *i;
        } while (i != 0);
        ebx = var_c;
    }
    int32_t eax_4;
    int32_t edx_1;
    edx_1 = HIGHD(((edi + 1) * 2));
    eax_4 = LOWD(((edi + 1) * 2));
    int32_t ecx_3;
    ecx_3 = (((edi + 1) * 2) >> 0x20) != 0;
    int32_t edi_2 = sub_40aba4(((-ecx_3) | eax_4));
    *edi_2 = 0;
    void** i_1 = *(ebx + 0x10);
    if (i_1 != 0)
    {
        do
        {
            int16_t* str = i_1[1];
            char var_5_1;
            wchar16* eax_6;
            if (*str != 0x22)
            {
                eax_6 = wcschr(str, 0x20);
                if (eax_6 != 0)
                {
                    var_5_1 = 1;
                    wcscat_s(edi_2, (edi + 1), &data_40104c);
                }
            }
            if ((*str == 0x22 || (*str != 0x22 && eax_6 == 0)))
            {
                var_5_1 = 0;
            }
            wcscat_s(edi_2, (edi + 1), i_1[1]);
            void* const eax_7 = &data_401050;
            if (var_5_1 == 0)
            {
                eax_7 = &data_401058;
            }
            wcscat_s(edi_2, (edi + 1), eax_7);
            i_1 = *i_1;
        } while (i_1 != 0);
        ebx = var_c;
    }
    void* edx_2 = *(ebx + 4);
    void** ecx_7 = *(ebx + 0xc);
    int32_t var_28_3 = 0;
    uint32_t eax_8 = *(ebx + 8);
    char var_30_4 = *(edx_2 + 0x10);
    void** edx_3 = *(edx_2 + 0xc);
    data_422ecc = edi_2;
    int32_t eax_9;
    int32_t ecx_8;
    eax_9 = sub_40574c(ecx_7, edx_3, var_30_4, eax_8);
    if (eax_9 == 0)
    {
        void** i_2 = *(ebx + 0xc);
        if (i_2 != 0)
        {
            do
            {
                int32_t var_28_4 = ecx_8;
                int32_t var_2c_7 = ecx_8;
                void** eax_10;
                eax_10 = sub_40ea69(i_2[1]);
                ecx_8 = *(eax_10 + 9);
                ecx_8 = (ecx_8 & 0xfb);
                eax_10[7] = 0;
                ecx_8 = (ecx_8 | 2);
                *(eax_10 + 9) = ecx_8;
                i_2 = *i_2;
            } while (i_2 != 0);
        }
    }
    free(edi_2);
    return eax_9;
}

int32_t __fastcall sub_404e10(int32_t* arg1)
{
    int32_t* var_4 = arg1;
    int32_t* i = arg1;
    int32_t edi = 0;
    while (i != 0)
    {
        int32_t eax_1 = sub_404cbb(i);
        i = *i;
        edi = (edi + eax_1);
    }
    return edi;
}

void __fastcall sub_404e2e(int32_t* arg1)
{
    void** i = *arg1;
    while (i != 0)
    {
        int32_t* ecx = i[3];
        void** i_1 = i;
        *ecx = data_433618;
        int32_t** eax_2 = i[4];
        data_433618 = eax_2;
        *eax_2 = ecx;
        i = *i;
        free(i_1);
    }
    *arg1 = (*arg1 & i);
}

int32_t __fastcall sub_404e5d(int32_t* arg1, int32_t* arg2)
{
    int32_t eax = *arg1;
    if (*((eax + (*arg2 << 1)) - 2) != 0xa)
    {
        int32_t var_8_1 = 0;
        do
        {
            eax = fgetws(0x4226c0, 0x400, data_422edc);
            if (eax == 0)
            {
                break;
            }
            int16_t* ecx = &data_4226c0;
            do
            {
                eax = *ecx;
                ecx = &ecx[1];
            } while (eax != 0);
            int32_t ecx_2 = ((ecx - 0x4226c2) >> 1);
            if ((*((ecx_2 << 1) + &data_4226bc) == 0x5c && *((ecx_2 << 1) + &*(data_4226bc + 2)) == 0xa))
            {
                *((ecx_2 << 1) + &*(data_4226bc + 2)) = 0;
                *((ecx_2 << 1) + &data_4226bc) = 0x20;
            }
            int32_t esi_1 = *arg2;
            int16_t* ecx_3 = &data_4226c0;
            do
            {
                eax = *ecx_3;
                ecx_3 = &ecx_3[1];
            } while (eax != 0);
            int32_t edx = (((ecx_3 - 0x4226c2) >> 1) + esi_1);
            int32_t ecx_6 = *arg1;
            *arg2 = edx;
            int32_t ecx_7 = sub_40abe7(ecx_6, ((edx << 1) + 2));
            if (ecx_7 == 0)
            {
                sub_4053c9(data_4226a4, 0x419);
            }
            int32_t eax_3 = (*arg2 - esi_1);
            *arg1 = ecx_7;
            wcscpy_s((ecx_7 + (esi_1 << 1)), (eax_3 + 1), 0x4226c0);
            eax = *arg1;
        } while (*((eax + (*arg2 << 1)) - 2) != 0xa);
    }
    return eax;
}

int32_t __fastcall sub_404f65(uint8_t* arg1, int32_t arg2, int32_t* arg3)
{
    int32_t ecx = *arg3;
    int32_t eax_1;
    if (ecx == 0)
    {
        eax_1 = sub_40aba4(0x20);
    }
    if ((ecx != 0 && (arg2 & 7) == 0))
    {
        eax_1 = sub_405379(ecx, (arg2 + 8));
    }
    if ((ecx == 0 || (ecx != 0 && (arg2 & 7) == 0)))
    {
        *arg3 = eax_1;
    }
    int32_t eax_2 = sub_40e917(arg1);
    *(*arg3 + (arg2 << 2)) = eax_2;
    return eax_2;
}

int32_t __fastcall sub_404fa4(wchar16* arg1, int32_t* arg2, int32_t* arg3)
{
    wchar16* var_8 = arg1;
    wchar16* eax = wcschr(arg1, 0x5c);
    if (eax != 0)
    {
        uint32_t ecx_1 = eax[-1];
        if (((ecx_1 == 0x20 || ecx_1 == 9) && eax[1] == 0xa))
        {
            *eax = 0;
        }
    }
    var_8 = nullptr;
    int32_t* var_14 = &var_8;
    void* const var_18_1 = &data_4015c4;
    wchar16* var_1c = arg1;
    int32_t eax_2;
    while (true)
    {
        eax_2 = wcstok_s(var_1c, &data_4015c4, var_14);
        if (eax_2 == 0)
        {
            break;
        }
        if (*eax_2 == 0x40)
        {
            int32_t var_14_2 = (eax_2 + 2);
            eax_2 = sub_4053c9(0, 0xfa1);
            break;
        }
        sub_404f65(eax_2, *arg2, arg3);
        *arg2 = (*arg2 + 1);
        var_14 = &var_8;
        void* const var_18_2 = &data_4015c4;
        var_1c = nullptr;
    }
    return eax_2;
}

int32_t __fastcall sub_405030(wchar16* arg1, int32_t* arg2, int32_t* arg3)
{
    char var_5 = 0;
    int32_t* esi = arg2;
    int32_t* var_c = esi;
    wchar16* eax = wcschr(arg1, 0x22);
    int32_t eax_1;
    if (eax == 0)
    {
        eax_1 = sub_404fa4(arg1, esi, arg3);
    }
    else
    {
        void* esi_1;
        if (eax != arg1)
        {
            esi_1 = &eax[-1];
            if (*esi_1 != 0x3d)
            {
                esi = var_c;
            }
            else
            {
                *eax = 0x20;
                bool cond:0_1 = esi_1 == arg1;
                if (esi_1 > arg1)
                {
                    do
                    {
                        eax = *esi_1;
                        if (eax == 0x20)
                        {
                            break;
                        }
                        if (eax == 9)
                        {
                            break;
                        }
                        if (eax == 0xa)
                        {
                            break;
                        }
                        esi_1 = (esi_1 - 2);
                    } while (esi_1 > arg1);
                    cond:0_1 = esi_1 == arg1;
                }
                if ((!cond:0_1))
                {
                    *esi_1 = 0;
                    esi_1 = (esi_1 + 2);
                    sub_404fa4(arg1, var_c, arg3);
                }
            }
        }
        if (((eax != arg1 && *esi_1 != 0x3d) || eax == arg1))
        {
            *eax = 0;
            sub_404fa4(arg1, esi, arg3);
            esi_1 = &eax[1];
        }
        void* ebx_1 = esi_1;
        void* var_10 = esi_1;
        void* ecx_4 = (ebx_1 + 2);
        do
        {
            eax = *ebx_1;
            ebx_1 = (ebx_1 + 2);
        } while (eax != 0);
        int16_t i_2 = *esi_1;
        int32_t ebx_3 = ((ebx_1 - ecx_4) >> 1);
        void* edi_1 = esi_1;
        if (i_2 != 0)
        {
            int16_t i_1 = i_2;
            int16_t i;
            do
            {
                if (i_1 == 0x22)
                {
                    if (*(edi_1 + 2) != 0x22)
                    {
                        *edi_1 = 0;
                        edi_1 = (edi_1 + 2);
                        sub_404f65(esi_1, *var_c, arg3);
                        *var_c = (*var_c + 1);
                        sub_405030(arg3);
                        break;
                    }
                    void* ecx_5 = edi_1;
                    *edi_1 = 0x22;
                    int16_t j;
                    do
                    {
                        ecx_5 = (ecx_5 + 2);
                        j = *(ecx_5 + 2);
                        *ecx_5 = j;
                    } while (j != 0);
                }
                else if (i_1 == 0x5c)
                {
                    int16_t eax_2 = *(edi_1 - 2);
                    if (((eax_2 == 0x20 || eax_2 == 9) && *(edi_1 + 2) == 0xa))
                    {
                        *edi_1 = 0;
                        int32_t var_14 = (ebx_3 - 2);
                        if (var_5 == 0)
                        {
                            var_5 = 1;
                            var_10 = sub_40e917(esi_1);
                        }
                        sub_404e5d(&var_10, &var_14);
                        esi_1 = var_10;
                        edi_1 = (esi_1 + ((ebx_3 - 2) << 1));
                        ebx_3 = var_14;
                    }
                }
                edi_1 = (edi_1 + 2);
                i = *edi_1;
                i_1 = i;
            } while (i != 0);
        }
        eax_1 = (esi_1 + (ebx_3 << 1));
        if (edi_1 == eax_1)
        {
            eax_1 = sub_4053c9(0, 0x3ee);
        }
        if (var_5 != 0)
        {
            eax_1 = free(esi_1);
        }
    }
    return eax_1;
}

int32_t __fastcall sub_4051e1(int32_t arg1)
{
    int32_t edi = 0;
    int32_t i = 0;
    int32_t i_1 = 0;
    int32_t eax = _wfsopen(arg1, u"rt,ccs=unicode", 0x20);
    data_422edc = eax;
    if (eax == 0)
    {
        int32_t var_28_1 = arg1;
        eax = sub_4053c9(0, 0x41c);
    }
    int32_t var_14 = 0;
    if (fgetws(0x4226c0, 0x400, eax) != 0)
    {
        int32_t esi = 0x4226c0;
        while (true)
        {
            int16_t* ecx = &data_4226c0;
            int32_t eax_1;
            do
            {
                eax_1 = *ecx;
                ecx = &ecx[1];
            } while (eax_1 != 0);
            int32_t ecx_2 = ((ecx - 0x4226c2) >> 1);
            int32_t var_8 = ecx_2;
            if ((ecx_2 != 0x3ff || (ecx_2 == 0x3ff && data_422ebc == 0xa)))
            {
                if (*((ecx_2 << 1) + &*(data_4226bc + 2)) != 0xa)
                {
                    goto label_4052ee;
                }
                if (*((ecx_2 << 1) + &data_4226bc) != 0x5c)
                {
                    goto label_4052ee;
                }
            }
            if (((ecx_2 == 0x3ff && data_422ebc != 0xa) || ((ecx_2 != 0x3ff || (ecx_2 == 0x3ff && data_422ebc == 0xa)) && *((ecx_2 << 1) + &*(data_4226bc + 2)) == 0xa)))
            {
                if (*((ecx_2 << 1) + &*(data_4226bc + 2)) == 0xa)
                {
                    if (*((ecx_2 << 1) + &data_4226bc) == 0x5c)
                    {
                        int32_t edx_1 = ((ecx_2 - 1) * 2);
                        if (edx_1 >= 0x800)
                        {
                            ___report_rangecheckfailure();
                            breakpoint();
                        }
                        var_8 = (ecx_2 - 1);
                        *(edx_1 + 0x4226c0) = 0;
                        *((ecx_2 << 1) + &data_4226bc) = 0x20;
                    }
                    goto label_4052d7;
                }
            label_4052d7:
                int32_t var_c = sub_40e917(&data_4226c0);
                sub_404e5d(&var_c, &var_8);
                esi = var_c;
            label_4052ee:
                sub_405030(esi, &i_1, &var_14);
                if (esi != 0x4226c0)
                {
                    free(esi);
                }
                esi = 0x4226c0;
                if (fgetws(0x4226c0, 0x400, data_422edc) == 0)
                {
                    i = i_1;
                    edi = var_14;
                    break;
                }
            }
        }
    }
    if (fclose(data_422edc) == 0xffffffff)
    {
        int32_t var_28_7 = arg1;
        sub_4053c9(0, 0x424);
    }
    int32_t eax_5 = sub_40c429(i, edi);
    while (i != 0)
    {
        i = (i - 1);
        if (*(edi + (i << 2)) != 0)
        {
            eax_5 = free(*(edi + (i << 2)));
        }
    }
    return eax_5;
}

int32_t __fastcall sub_405379(int32_t arg1, int32_t arg2)
{
    int32_t esi = 0;
    int32_t eax_3;
    if (arg1 == 0)
    {
        if (arg2 <= 0x3ffffffe)
        {
            eax_3 = malloc((arg2 << 2));
        }
        else
        {
        label_4053be:
            sub_4053c9(data_4226b0, 0x41b);
        }
    }
    else
    {
        if (arg2 > 0x3ffffffe)
        {
            goto label_4053be;
        }
        eax_3 = realloc(arg1, (arg2 << 2));
    }
    if (((arg1 == 0 && arg2 <= 0x3ffffffe) || arg1 != 0))
    {
        esi = eax_3;
        if (esi == 0)
        {
            goto label_4053be;
        }
    }
    return esi;
}

int32_t sub_4053c9(int32_t arg1, int32_t arg2)
{
    int32_t status = 2;
    int32_t eax_2;
    if ((data_41248c & 0x20) != 0)
    {
        eax_2 = (arg2 - 0xfa0);
    }
    if (((data_41248c & 0x20) == 0 || ((data_41248c & 0x20) != 0 && eax_2 >= 0x3e8)))
    {
        sub_405532();
        if (arg1 == 0)
        {
            sub_40cda4(u"NMAKE : ");
        }
        else
        {
            int32_t var_10_1 = arg1;
            int32_t var_14_1 = data_422ee4;
            sub_40cda4(u"%s(%u) : ");
        }
        uint32_t temp0_1 = (COMBINE(0, arg2) / 0x3e8);
        if (temp0_1 == 1)
        {
            sub_4054a3(0x14);
            if (arg2 == 0x41b)
            {
                status = 4;
            }
        }
        else
        {
            int32_t var_10_2;
            if (temp0_1 == 2)
            {
                var_10_2 = 0x15;
            }
            if (temp0_1 == 4)
            {
                var_10_2 = 0x16;
            }
            if ((temp0_1 == 2 || temp0_1 == 4))
            {
                sub_4054a3(var_10_2);
            }
        }
        int32_t var_10_3 = arg2;
        sub_40cda4(u" U%04d: ");
        sub_40ce1c(sub_40cb47(arg2), &arg_c);
        sub_40cdb3();
        eax_2 = sub_40cd86();
        if (temp0_1 == 1)
        {
            sub_40cda4(u"Stop.\n");
            sub_40cab3();
            exit(status);
            /* no return */
        }
    }
    return eax_2;
}

void sub_4054a3(int32_t arg1)
{
    int32_t ecx;
    int32_t var_c = ecx;
    if ((arg1 == 0xd || (arg1 != 0xd && (data_41248c & 0x20) == 0)))
    {
        sub_405532();
        int32_t ecx_1 = arg1;
        int32_t esi_1 = (ecx_1 - 0x14);
        if (ecx_1 == 0x18)
        {
            if (esi_1 <= 5)
            {
                sub_40cdb3();
            }
            else
            {
                sub_40ce93();
            }
            ecx_1 = arg1;
        }
        void* eax_1 = sub_40cb47(ecx_1);
        void* edx_1 = &arg_8;
        if (esi_1 <= 5)
        {
            sub_40ce1c(eax_1, edx_1);
        }
        else
        {
            sub_40cebf(eax_1, edx_1);
        }
        if (((arg1 < 0xa || (arg1 >= 0xa && arg1 > 0x17)) && arg1 != 0x7c))
        {
            if (esi_1 <= 5)
            {
                sub_40cdb3();
            }
            else
            {
                sub_40ce93();
            }
        }
        if (esi_1 <= 5)
        {
            sub_40cd86();
        }
        else
        {
            sub_40ce66();
        }
    }
}

void sub_405532()
{
    if (data_422ee0 != 0)
    {
        return;
    }
    void* const var_4 = u"14.21.27702.2";
    data_422ee0 = 1;
    sub_4054a3(0x18);
    sub_4054a3(0x19);
    /* tailcall */
    return sub_40cd86();
}

int32_t sub_40555e()
{
    int32_t i = 0x64;
    int32_t i_1 = 0x67;
    do
    {
        sub_4054a3(i);
        i = (i + 1);
    } while (i < 0x67);
    int32_t eax_1;
    do
    {
        if (i_1 == 0x71)
        {
            i_1 = 0x72;
        }
        if (i_1 == 0x79)
        {
            i_1 = 0x7a;
        }
        eax_1 = sub_4054a3(i_1);
        i_1 = (i_1 + 1);
    } while (i_1 <= 0x7c);
    return eax_1;
}

int32_t* __fastcall sub_405598(int32_t* arg1, void** arg2, int16_t* arg3)
{
    int16_t* esi = arg3;
    int32_t* eax = arg1;
    int32_t* var_10 = eax;
    void** ebx = arg2;
    char var_5 = 1;
    int16_t* edi = esi;
    void** var_c = ebx;
    if (*esi != 0)
    {
        do
        {
            edi = &edi[1];
        } while (*edi != 0);
    }
    *eax = 0;
    if (esi < edi)
    {
        while (true)
        {
            eax = wcsspn(esi, &data_401044);
            void* esi_1 = &esi[eax];
            if (esi_1 >= edi)
            {
                break;
            }
            if (ebx != 0)
            {
                *ebx = esi_1;
                ebx = &ebx[1];
                var_c = ebx;
            }
            if (*esi_1 != 0x22)
            {
                esi = wcspbrk(esi_1, u" \t"/");
                if (esi != 0)
                {
                    ebx = var_5;
                    while (esi < edi)
                    {
                        if (*esi != 0x2f)
                        {
                            break;
                        }
                        if (ebx != 0)
                        {
                            break;
                        }
                        esi = wcspbrk(&esi[1], u" \t"/");
                        if (esi == 0)
                        {
                            break;
                        }
                    }
                    ebx = var_c;
                    if ((esi != 0 && *esi == 0x22))
                    {
                        do
                        {
                            esi = &esi[1];
                            if (esi >= edi)
                            {
                                break;
                            }
                        } while (*esi != 0x22);
                        esi = wcspbrk(esi, &data_401044);
                    }
                }
                if (var_5 != 0)
                {
                    var_5 = 0;
                    if (esi == 0)
                    {
                    label_4056e0:
                        esi = edi;
                    }
                    else if ((*esi == 0x2f && ebx != 0))
                    {
                        *esi = 0;
                        ebx[-1] = sub_40e917(ebx[-1]);
                        *esi = 0x2f;
                        esi = (esi - 2);
                    }
                }
            }
            else
            {
                esi = (esi_1 + 2);
                if (esi >= edi)
                {
                    goto label_4056ee;
                }
                do
                {
                    uint32_t eax_1 = *esi;
                    if (eax_1 == 0x5c)
                    {
                        esi = &esi[1];
                    }
                    if ((eax_1 != 0x5c && eax_1 == 0x22))
                    {
                        break;
                    }
                    esi = &esi[1];
                } while (esi < edi);
                if (esi >= edi)
                {
                    goto label_4056ee;
                }
                esi = wcspbrk(&esi[1], &data_401044);
            }
            if ((((*esi_1 != 0x22 && var_5 != 0) && esi == 0) || ((((*esi_1 != 0x22 && var_5 == 0) || ((*esi_1 != 0x22 && var_5 != 0) && esi != 0)) || *esi_1 == 0x22) && esi != 0)))
            {
                if (ebx == 0)
                {
                    goto label_4056ee;
                }
                *esi = 0;
                esi = &esi[1];
            label_4056ee:
                eax = var_10;
                *eax = (*eax + 1);
                if (esi >= edi)
                {
                    break;
                }
                continue;
            }
            if (((((*esi_1 != 0x22 && var_5 == 0) || ((*esi_1 != 0x22 && var_5 != 0) && esi != 0)) || *esi_1 == 0x22) && esi == 0))
            {
                goto label_4056e0;
            }
        }
    }
    if (ebx != 0)
    {
        *ebx = nullptr;
    }
    return eax;
}

int32_t __fastcall sub_40570a(uint8_t* arg1, void** arg2, char arg3, int32_t arg4, int32_t arg5)
{
    int32_t* eax = sub_40e8c5();
    int32_t var_14 = arg5;
    eax[1] = sub_40e917(arg1);
    int32_t eax_2 = sub_40574c(eax, arg2, arg3, arg4);
    *eax = data_433618;
    data_433618 = eax;
    return eax_2;
}

int32_t __fastcall sub_40574c(void** arg1, void** arg2, char arg3, int32_t arg4)
{
    data_422ec0 = (data_422ec0 + 1);
    int32_t esi = 0;
    int32_t var_14 = 0;
    int32_t eax;
    eax = data_41248c;
    void** i_1 = arg2;
    void** i_2 = i_1;
    int32_t var_10 = 0;
    void** i = arg1;
    int32_t eax_1;
    if ((eax & 8) != 0)
    {
    label_405796:
        eax_1 = 0;
    }
    else
    {
        if ((eax & 0x10) != 0)
        {
            if (i != 0)
            {
                i_1 = arg3;
                i_1 = (i_1 >> 2);
                i_1 = (i_1 & 1);
                do
                {
                    arg2 = i_1;
                    sub_407972(i[1], arg2);
                    i = *i;
                } while (i != 0);
            }
            goto label_405796;
        }
        if (i_1 != 0)
        {
            eax = arg3;
            eax = (eax >> 6);
            int32_t eax_2 = (eax & 0xffffff01);
            int32_t var_40_1 = eax_2;
            var_3c_119;
            __builtin_memcpy(&var_3c_119, "@-!\t ", 0x14);
            do
            {
                int16_t* str_6;
                i_1 = sub_409379(i_1[1], &str_6, &arg_4, eax_2);
                *i_1[1] = 0;
                data_432ef0 = 0;
                int16_t* str_4 = str_6;
                int16_t* str = str_4;
                int16_t* str_3 = str;
                int16_t* str_9 = str_4;
                char var_c_1 = 0;
                uint32_t edi = *str_4;
                if (edi != 0)
                {
                    int16_t j_1 = edi;
                    int16_t j;
                    do
                    {
                        if ((j_1 == 0x5e || j_1 == 0x24))
                        {
                            str_9 = &str_9[1];
                        }
                        str_9 = &str_9[1];
                        j = *str_9;
                        j_1 = j;
                    } while (j != 0);
                }
                int16_t esi_1 = edi;
                uint32_t eax_4;
                while (true)
                {
                    eax_4 = esi_1;
                    if ((esi_1 != 0x21 && (esi_1 != 0x2d && (esi_1 != 0x40 && (esi_1 != 0x5e && (esi_1 != 0x20 && esi_1 != 9))))))
                    {
                        break;
                    }
                    if (eax_4 == 0x21)
                    {
                        *i_1[1] = (*i_1[1] | 4);
                    }
                    if ((eax_4 == 0x40 && (data_41248e & 4) == 0))
                    {
                        *i_1[1] = (*i_1[1] | 1);
                    }
                    if ((eax_4 == 0x21 || (eax_4 == 0x40 && (data_41248e & 4) == 0)))
                    {
                        var_c_1 = *i_1[1];
                    }
                    if ((((eax_4 != 0x21 && eax_4 != 0x2d) && eax_4 != 0x40) && esi_1 == 0x5e))
                    {
                        str = &str[1];
                        str_3 = str;
                        int16_t eax_6 = *str;
                        int32_t eax_7;
                        if ((eax_6 == 0x20 || eax_6 == 9))
                        {
                            eax_7 = 1;
                        }
                        if ((eax_6 != 0x20 && eax_6 != 9))
                        {
                            eax_7 = 0;
                        }
                        int32_t eax_8 = (-eax_7);
                        esi_1 = (((eax_8 - eax_8) & 0xffffffc2) + 0x5e);
                    }
                    if (eax_4 == 0x2d)
                    {
                        *i_1[1] = (*i_1[1] | 2);
                        str_3 = &str[1];
                        var_c_1 = *i_1[1];
                        eax_4 = iswdigit(str[1]);
                        if (eax_4 == 0)
                        {
                            data_432ef0 = 0xffffffff;
                        }
                        else
                        {
                            int16_t* str_10 = str_3;
                            data_432ef0 = wcstoul(str_10, &str_3, 0xa);
                            if (*_errno() == 0x22)
                            {
                                int16_t* str_11 = str_10;
                                int32_t var_5c_3 = data_4226a4;
                                *str_3 = 0;
                                sub_4053c9(var_5c_3, 0x436);
                            }
                            void* str_8 = str_3;
                            while (true)
                            {
                                eax_4 = iswspace(*str_8);
                                if (eax_4 == 0)
                                {
                                    break;
                                }
                                str_8 = &str_3[1];
                                str_3 = str_8;
                            }
                        }
                        str = (str_3 - 2);
                        str_3 = str;
                    }
                    if ((((((eax_4 == 0x21 || (eax_4 == 0x40 && (data_41248e & 4) == 0)) || (eax_4 == 0x40 && (data_41248e & 4) != 0)) || eax_4 == 0x2d) || (((eax_4 != 0x21 && eax_4 != 0x2d) && eax_4 != 0x40) && esi_1 == 0x5e)) && esi_1 == 0x5e))
                    {
                        break;
                    }
                    str = &str[1];
                    str_3 = str;
                    esi_1 = *str;
                }
                bool cond:1_1;
                if ((*i_1[1] & 4) != 0)
                {
                    eax_4 = sub_407683(str, arg_4, arg3, var_c_1, arg4, &var_10);
                    if (eax_4 == 0)
                    {
                        str = str_3;
                    }
                    else
                    {
                        int16_t* str_1 = str_3;
                        wchar16* eax_5;
                        int32_t* edx_2;
                        eax_5 = wcschr(str_1, 0x24);
                        int32_t str_7;
                        if (eax_5 == 0)
                        {
                            str_7 = str_3;
                        }
                        else
                        {
                            edx_2 = 0xff;
                            str_7 = sub_40f30f(str_3, edx_2, &arg_4);
                            str_3 = str_7;
                        }
                        if (str_1 != str_7)
                        {
                            free(str_7);
                        }
                        esi = var_10;
                        cond:1_1 = (arg3 & 2) != 0;
                    }
                }
                if ((((*i_1[1] & 4) != 0 && eax_4 == 0) || (*i_1[1] & 4) == 0))
                {
                    int16_t* str_2 = str;
                    if (i_1 == 0)
                    {
                        int32_t* edx_3;
                        eax_4 = wcschr(str, 0x24);
                        str = str_3;
                        if (eax_4 != 0)
                        {
                            edx_3 = 0xff;
                            str = sub_40f30f(str, edx_3, &arg_4);
                            str_3 = str;
                        }
                    }
                    do
                    {
                        eax_4 = *str;
                        str = &str[1];
                    } while (eax_4 != 0);
                    int32_t esi_2 = (((str - &str[1]) >> 1) + 1);
                    if (esi_2 <= 0x8000)
                    {
                        esi_2 = 0x8000;
                    }
                    int32_t eax_18;
                    int32_t edx_5;
                    edx_5 = HIGHD((esi_2 * 2));
                    eax_18 = LOWD((esi_2 * 2));
                    int32_t ecx_11;
                    ecx_11 = ((esi_2 * 2) >> 0x20) != 0;
                    int32_t eax_19 = sub_40aba4(((-ecx_11) | eax_18));
                    wcscpy_s(eax_19, esi_2, str_3);
                    uint8_t eax_20;
                    int32_t ecx_15;
                    eax_20 = sub_410124(eax_19, esi_2, str_3, arg4);
                    if (eax_20 != 0)
                    {
                        int16_t* str_5 = str_3;
                        sub_4053c9(0, 0x447);
                    }
                    i_1 = arg3;
                    eax_20 = *i_1[1];
                    *i_1[1] = arg3;
                    i_1 = (i_1 & 4);
                    ecx_15 = (eax_20 >> 1);
                    int32_t ecx_16 = (ecx_15 & 0xffffff01);
                    *i_1[1] = (*i_1[1] & 2);
                    int32_t var_28_2 = ecx_16;
                    while (true)
                    {
                        if ((i_1 == 0 || (i_1 != 0 && (var_c_1 & 8) != 0)))
                        {
                            eax_20 = 1;
                        }
                        if ((i_1 != 0 && (var_c_1 & 8) == 0))
                        {
                            eax_20 = 0;
                        }
                        char edx_7;
                        if ((i_1 != 0 || ((i_1 == 0 && (arg3 & 8) == 0) && (var_c_1 & 1) == 0)))
                        {
                            edx_7 = 1;
                        }
                        if ((i_1 == 0 && ((arg3 & 8) != 0 || ((arg3 & 8) == 0 && (var_c_1 & 1) != 0))))
                        {
                            edx_7 = 0;
                        }
                        int32_t var_18;
                        esi = sub_406e64(eax_19, edx_7, eax_20, ecx_16, &var_18);
                        var_10 = esi;
                        if (*i_1[1] != 0)
                        {
                            break;
                        }
                        if (esi == 0x103)
                        {
                            if (data_4333f9 == *i_1[1])
                            {
                                int32_t var_54_12 = var_18;
                                sub_4053c9(0, 0xfac);
                                esi = 0;
                                var_10 = 0;
                            }
                            else if (var_14 < 0xa)
                            {
                                int32_t var_54_11 = var_18;
                                sub_4053c9(0, 0xfad);
                                ecx_16 = var_28_2;
                                var_14 = (var_14 + 1);
                                continue;
                            }
                        }
                        if ((((esi == 0x103 && data_4333f9 == *i_1[1]) || esi != 0x103) && esi == 0))
                        {
                            break;
                        }
                        if (esi <= data_432ef0)
                        {
                            break;
                        }
                        if (data_4226b7 == 0)
                        {
                            int32_t var_54_13 = esi;
                            int32_t var_58_9 = var_18;
                            sub_4053c9(0, 0x435);
                        }
                        break;
                    }
                    if (str_2 != str_3)
                    {
                        free(str_3);
                    }
                    free(str_6);
                    free(eax_19);
                    cond:1_1 = *i_1[1] != 0;
                }
                if (((!cond:1_1) && (data_4226b7 != 0 && (esi != 0 && esi > data_432ef0))))
                {
                    break;
                }
                eax_2 = var_40_1;
                i_1 = *i_2;
                i_2 = i_1;
            } while (i_1 != 0);
        }
        if ((arg3 & 2) != 0)
        {
            goto label_405796;
        }
        if (data_4226b7 == 0)
        {
            goto label_405796;
        }
        if (esi <= data_432ef0)
        {
            goto label_405796;
        }
        eax_1 = esi;
    }
    return eax_1;
}

int32_t __fastcall sub_405bce(int32_t arg1, int32_t arg2, int32_t arg3)
{
    int32_t var_8 = arg1;
    int32_t var_c = arg1;
    int32_t i_1 = 0;
    int32_t esi = arg2;
    int32_t* edi = arg3;
    int32_t i;
    int16_t* ecx;
    int16_t* edx;
    if (arg1 == 0)
    {
        edx = *edi;
        if (*edx == 0x22)
        {
            ecx = edx;
            arg3 = &ecx[1];
            int32_t eax_1;
            do
            {
                eax_1 = *ecx;
                ecx = &ecx[1];
            } while (eax_1 != 0);
            if (edx[(((ecx - arg3) >> 1) - 1)] == 0x22)
            {
                for (i = (esi - 1); i >= 1; i = (i - 1))
                {
                    if (wcspbrk(edi[i], &data_40104c) != 0)
                    {
                        break;
                    }
                }
            }
        }
        if (((*edx != 0x22 || (*edx == 0x22 && *((edx + (((ecx - arg3) >> 1) << 1)) - 2) != 0x22)) || ((*edx == 0x22 && *((edx + (((ecx - arg3) >> 1) << 1)) - 2) == 0x22) && i < 1)))
        {
            arg1 = 0;
        }
    }
    else
    {
        edi[esi] = &data_40166c;
        edi[(esi + 1)] = arg1;
        esi = (esi + 2);
        edi[esi] = 0;
    }
    if ((arg1 != 0 || (((arg1 == 0 && *edx == 0x22) && *((edx + (((ecx - arg3) >> 1) << 1)) - 2) == 0x22) && i >= 1)))
    {
        edi[esi] = &data_40104c;
        arg1 = 1;
        esi = (esi + 1);
        edi[esi] = 0;
    }
    if (esi >= 0)
    {
        int32_t temp1_1;
        do
        {
            edi[(esi + 2)] = edi[esi];
            temp1_1 = esi;
            esi = (esi - 1);
        } while ((temp1_1 - 1) >= 0);
    }
    *edi = data_422eec;
    void* const eax_6 = u"/c "";
    if (arg1 == 0)
    {
        eax_6 = &data_40167c;
    }
    edi[1] = eax_6;
    *_errno() = 0;
    int32_t eax_8 = _wspawnvp(1, *edi, edi);
    int32_t eax_9;
    if (eax_8 == 0xffffffff)
    {
        eax_9 = eax_8;
    }
    else
    {
        WaitForSingleObject(eax_8, 0xffffffff);
        arg3 = 0;
        do
        {
            GetExitCodeProcess(eax_8, &arg3);
            if (arg3 != 0x103)
            {
                break;
            }
            Sleep(0x3e8);
            i_1 = (i_1 + 1);
        } while (i_1 < 0xa);
        CloseHandle(eax_8);
        eax_9 = arg3;
    }
    return eax_9;
}

uint32_t sub_405cdf()
{
    int32_t ecx;
    int32_t edx;
    ecx = __chkstk(0x106bc);
    int32_t __saved_ebp;
    int32_t var_8 = (__security_cookie ^ &__saved_ebp);
    void* const var_8_1 = nullptr;
    void* const var_14 = u"set ";
    char ebx = 0;
    int32_t var_18 = 0x8000;
    void var_106ac;
    void* var_1c = &var_106ac;
    int32_t var_106b4 = 0;
    int16_t* var_106b0 = nullptr;
    wcscpy_s(var_1c, var_18, var_14);
    int16_t var_106a4;
    int16_t* edi = &var_106a4;
    int16_t* str = &data_412498;
    while (true)
    {
        int16_t eax_2 = *str;
        if ((eax_2 != 0x20 && eax_2 != 9))
        {
            if ((eax_2 == 0x2f && str[1] == 0x41))
            {
                int16_t eax_3 = str[2];
                if ((eax_3 == 0x20 || eax_3 == 9))
                {
                    ebx = 1;
                    str = &str[3];
                }
            }
            uint32_t eax_5;
            if (wcschr(str, 0x3d) == 0)
            {
                eax_5 = 0x401690;
            }
            else
            {
                int16_t* var_106bc_1 = &var_106a4;
                int16_t i_4 = *str;
                void lpTempFileName;
                if (i_4 != 0x3d)
                {
                    int16_t i_2 = i_4;
                    int16_t i;
                    do
                    {
                        *edi = i_2;
                        edi = &edi[1];
                        if (edi >= &lpTempFileName)
                        {
                            break;
                        }
                        str = &str[1];
                        i = *str;
                        i_2 = i;
                    } while (i != 0x3d);
                    if (edi >= &lpTempFileName)
                    {
                        goto label_4062ef;
                    }
                }
                if (ebx != 0)
                {
                    uint32_t eax_6 = edi[-1];
                    if (eax_6 == 0x2a)
                    {
                    label_4060ac:
                        edi = &edi[-1];
                    }
                    else
                    {
                        if (eax_6 == 0x2f)
                        {
                            goto label_4060ac;
                        }
                        if (eax_6 == 0x25)
                        {
                            goto label_4060ac;
                        }
                        if (eax_6 == 0x2b)
                        {
                            goto label_4060ac;
                        }
                        if (eax_6 == 0x2d)
                        {
                            goto label_4060ac;
                        }
                        if (eax_6 == 0x26)
                        {
                            goto label_4060ac;
                        }
                        if (eax_6 == 0x5e)
                        {
                            goto label_4060ac;
                        }
                        if (eax_6 == 0x7c)
                        {
                            goto label_4060ac;
                        }
                        if ((eax_6 == 0x3e && edi[-2] == 0x3e))
                        {
                        label_405e40:
                            edi = &edi[-2];
                        }
                        if ((((eax_6 != 0x3e || (eax_6 == 0x3e && edi[-2] != 0x3e)) && eax_6 == 0x3c) && edi[-2] == 0x3c))
                        {
                            goto label_405e40;
                        }
                    }
                    void var_106a2;
                    if (var_106a4 == 0x22)
                    {
                        var_106bc_1 = &var_106a2;
                    }
                    *edi = 0x3d;
                    if (&edi[1] >= &lpTempFileName)
                    {
                    label_4062ef:
                        eax_5 = 0;
                    }
                    else
                    {
                        void* const var_14_2 = &data_401694;
                        int32_t var_18_2 = 0x106;
                        int16_t var_21c;
                        int16_t* var_1c_1 = &var_21c;
                        int32_t* var_20_1 = &var_106b4;
                        var_106b4 = 0;
                        int32_t eax_7 = _wgetenv_s(var_20_1, var_1c_1, var_18_2, var_14_2);
                        if ((eax_7 != 0 || (eax_7 == 0 && var_106b4 == 0)))
                        {
                            wcscpy_s(&var_21c, 0x106, &data_40169c);
                        }
                        if (GetTempFileNameW(&var_21c, &data_4016a0, 0, &lpTempFileName) == 0)
                        {
                            int16_t* var_14_5 = &var_21c;
                            sub_4053c9(data_4226a4, 0x43c);
                        }
                        wcscpy_s(&var_21c, 0x106, &lpTempFileName);
                        if ((wcschr(&var_21c, 0x20) != 0 && wcschr(&var_21c, 0x22) == 0))
                        {
                            int16_t* ebx_1 = &var_21c;
                            wchar16* eax_10;
                            do
                            {
                                eax_10 = *ebx_1;
                                ebx_1 = &ebx_1[1];
                            } while (eax_10 != 0);
                            void var_21a;
                            int32_t ebx_3 = ((ebx_1 - &var_21a) >> 1);
                            int32_t esi = (ebx_3 * 2);
                            memmove(&var_21a, &var_21c, esi);
                            var_21c = 0x22;
                            *(&var_21a + esi) = 0x22;
                            if (((ebx_3 << 1) + 4) >= 0x20c)
                            {
                                ___report_rangecheckfailure();
                                breakpoint();
                            }
                            *(&var_21c + ((ebx_3 << 1) + 4)) = 0;
                        }
                        if (sub_405bce(&var_21c, ecx, edx) != 0)
                        {
                            goto label_4062ef;
                        }
                        int32_t _Stream = _wfsopen(&var_21c, &data_4016a8, 0x20);
                        if (_Stream == 0)
                        {
                            int16_t* var_14_12 = &var_21c;
                            sub_4053c9(0, 0x41c);
                        }
                        void var_29c;
                        if (fgetws(&var_29c, 0x40, _Stream) == 0)
                        {
                            int16_t* var_14_14 = &var_21c;
                            sub_4053c9(0, 0x41d);
                        }
                        if (fclose(_Stream) == 0xffffffff)
                        {
                            int16_t* var_14_16 = &var_21c;
                            sub_4053c9(0, 0x424);
                        }
                        if (_wremove(&var_21c) == 0xffffffff)
                        {
                            int16_t* var_14_18 = &var_21c;
                            sub_4053c9(0, 0x421);
                        }
                        int16_t* ecx_8 = &var_29c;
                        int32_t eax_14;
                        do
                        {
                            eax_14 = *ecx_8;
                            ecx_8 = &ecx_8[1];
                        } while (eax_14 != 0);
                        void var_29a;
                        if (&edi[(((ecx_8 - &var_29a) >> 1) + 2)] > &lpTempFileName)
                        {
                            goto label_4062ef;
                        }
                        wcscpy_s(&edi[1], ((&lpTempFileName - &edi[1]) >> 1), &var_29c);
                    }
                }
                else
                {
                    int16_t i_5 = *str;
                    if (i_5 != 0)
                    {
                        int16_t edx_3 = 0x25;
                        int16_t i_3 = i_5;
                        int32_t var_106b8_1 = 0x25;
                        int16_t i_1;
                        do
                        {
                            str = &str[1];
                            int16_t eax_18;
                            if (i_3 == 0x5e)
                            {
                                eax_18 = *str;
                                if (eax_18 != 0)
                                {
                                    *edi = eax_18;
                                    str = &str[1];
                                }
                            }
                            if ((i_3 != 0x5e && i_3 != edx_3))
                            {
                                *edi = i_3;
                            }
                            if (((i_3 != 0x5e && i_3 != edx_3) || (i_3 == 0x5e && eax_18 != 0)))
                            {
                                edi = &edi[1];
                                if (edi >= &lpTempFileName)
                                {
                                    goto label_4062ef;
                                }
                            }
                            if ((i_3 != 0x5e && i_3 == edx_3))
                            {
                                int16_t j_5 = *str;
                                void var_4a4;
                                void* ecx_12 = &var_4a4;
                                int16_t j_4 = j_5;
                                if (j_5 != edx_3)
                                {
                                    int16_t j_3 = j_5;
                                    int16_t j;
                                    do
                                    {
                                        j_4 = j_3;
                                        if (j_3 == 0)
                                        {
                                            break;
                                        }
                                        *ecx_12 = j_3;
                                        ecx_12 = (ecx_12 + 2);
                                        void var_2a2;
                                        if (ecx_12 == &var_2a2)
                                        {
                                            break;
                                        }
                                        str = &str[1];
                                        j = *str;
                                        j_3 = j;
                                        j_4 = j;
                                    } while (j != 0x25);
                                    if (j_3 != 0)
                                    {
                                        goto label_4062ef;
                                    }
                                }
                                str = &str[1];
                                *ecx_12 = 0;
                                void var_4a2;
                                if (j_4 == 0)
                                {
                                    void* ecx_25 = &var_4a4;
                                    int16_t j_1;
                                    do
                                    {
                                        j_1 = *ecx_25;
                                        ecx_25 = (ecx_25 + 2);
                                    } while (j_1 != 0);
                                    void* esi_3 = &edi[(((ecx_25 - &var_4a2) >> 1) + 1)];
                                    if (esi_3 < &lpTempFileName)
                                    {
                                        *edi = 0x25;
                                        wcscpy_s(&edi[1], ((&lpTempFileName - &edi[1]) >> 1), &var_4a4);
                                        edi = esi_3;
                                        break;
                                    }
                                    goto label_4062ef;
                                }
                                _wdupenv_s(&var_106b0, 0, &var_4a4);
                                int16_t* edx_4 = var_106b0;
                                int16_t j_2;
                                if (edx_4 == 0)
                                {
                                    void* ecx_17 = &var_4a4;
                                    do
                                    {
                                        j_2 = *ecx_17;
                                        ecx_17 = (ecx_17 + 2);
                                    } while (j_2 != 0);
                                    void* ebx_8 = &edi[(((ecx_17 - &var_4a2) >> 1) + 2)];
                                    if (ebx_8 >= &lpTempFileName)
                                    {
                                        goto label_4062ef;
                                    }
                                    *edi = 0x25;
                                    wcscpy_s(&edi[1], ((&lpTempFileName - &edi[1]) >> 1), &var_4a4);
                                    edi = ebx_8;
                                    edx_3 = 0x25;
                                    *(ebx_8 - 2) = 0x25;
                                }
                                else
                                {
                                    int16_t* ecx_13 = edx_4;
                                    do
                                    {
                                        j_2 = *ecx_13;
                                        ecx_13 = &ecx_13[1];
                                    } while (j_2 != var_106b4);
                                    void* ebx_6 = &edi[((ecx_13 - &ecx_13[1]) >> 1)];
                                    if (ebx_6 >= &lpTempFileName)
                                    {
                                        goto label_4062ef;
                                    }
                                    wcscpy_s(edi, ((&lpTempFileName - edi) >> 1), edx_4);
                                    edi = ebx_6;
                                    free(var_106b0);
                                    int16_t var_14_23 = 0x25;
                                    var_106b0 = nullptr;
                                    edx_3 = var_14_23;
                                }
                            }
                            i_1 = *str;
                            i_3 = i_1;
                        } while (i_1 != 0);
                    }
                    *edi = 0;
                }
                if ((ebx == 0 || (ebx != 0 && &edi[1] < &lpTempFileName)))
                {
                    wcscpy_s(0x412490, 0x8000, &var_106ac);
                    *var_106bc_1 = 0;
                    int16_t* ecx_20 = &var_106ac;
                    int16_t* eax_23;
                    do
                    {
                        eax_23 = *ecx_20;
                        ecx_20 = &ecx_20[1];
                    } while (eax_23 != 0);
                    void var_106aa;
                    eax_5 = &&data_412490[((ecx_20 - &var_106aa) >> 1)];
                }
            }
            CookieCheckFunction(eax_5);
            return eax_5;
        }
        str = &str[1];
    }
}

int32_t __fastcall sub_4062f9(int16_t* arg1)
{
    int16_t* str = arg1;
    int32_t var_14 = 0;
    wchar16* ebx = nullptr;
    int32_t edx = sub_40e917(&data_401690);
    int32_t var_8 = edx;
    if (*str != 0)
    {
        do
        {
            wchar16* eax_1 = wcschr(str, 0x25);
            void* var_10_1;
            if (eax_1 == 0)
            {
                var_10_1 = 2;
            }
            else
            {
                var_10_1 = &eax_1[1];
                ebx = wcschr(&eax_1[1], 0x25);
            }
            if ((eax_1 == 0 || (eax_1 != 0 && ebx == 0)))
            {
                int16_t* str_1 = str;
                edx = sub_40e9c1(var_8, str);
                var_8 = edx;
                int32_t eax_8;
                do
                {
                    eax_8 = *str_1;
                    str_1 = &str_1[1];
                } while (eax_8 != 0);
                str = &str[((str_1 - &str_1[1]) >> 1)];
            }
            if ((eax_1 != 0 && ebx != 0))
            {
                *eax_1 = 0;
                int16_t* var_c = nullptr;
                *ebx = 0;
                int32_t eax_4 = sub_40e9c1(var_8, str);
                _wdupenv_s(&var_c, 0, var_10_1);
                int16_t* edx_2 = var_c;
                if (edx_2 == 0)
                {
                    *eax_1 = 0x25;
                    edx = sub_40e9c1(sub_40e9c1(eax_4, eax_1), &data_4016b0);
                    var_8 = edx;
                }
                else
                {
                    var_8 = sub_40e9c1(eax_4, edx_2);
                    free(var_c);
                    edx = var_8;
                    var_c = nullptr;
                }
                *eax_1 = 0x25;
                str = &ebx[1];
                *ebx = 0x25;
                ebx = nullptr;
            }
        } while (*str != 0);
    }
    return edx;
}

uint32_t __fastcall sub_406419(int32_t arg1, int32_t* arg2, uint32_t arg3)
{
    int32_t var_8 = arg1;
    int32_t var_c = arg1;
    void* const var_10 = nullptr;
    int32_t esi;
    int32_t var_14 = esi;
    int32_t edi;
    int32_t var_18 = edi;
    int16_t* esi_1 = *arg2;
    int16_t* edi_1 = arg2[1];
    uint32_t var_1c = *esi_1;
    int32_t eax_2 = iswalpha(var_1c);
    var_1c = 0x3a;
    uint16_t edx = var_1c;
    uint32_t eax_7;
    int32_t* esp;
    if (((eax_2 == 0 || (eax_2 != 0 && esi_1[1] != edx)) || ((eax_2 != 0 && esi_1[1] == edx) && esi_1[2] != 0)))
    {
        var_1c = &data_4016b4;
        eax_7 = _wcsicmp(esi_1, var_1c);
        esp = &var_18;
        int32_t* esp_1;
        uint32_t edi_2;
        if (eax_7 != 0)
        {
            var_1c = 2;
            if (_wcsnicmp(esi_1, &data_4016bc, var_1c) == 0)
            {
                var_1c = 4;
            }
            else
            {
                var_1c = 5;
                esp = &var_18;
                if (_wcsnicmp(esi_1, u"chdir", var_1c) != 0)
                {
                    goto label_4065c7;
                }
                var_1c = 0xa;
            }
            esp = &var_18;
            void* esi_2 = (esi_1 + var_1c);
            if (arg1 > 2)
            {
                goto label_4065c7;
            }
            sub_4078e8(arg1, arg2);
            eax_7 = *esi_2;
            if (eax_7 != 0)
            {
                if ((eax_7 != 0x2e && (eax_7 != 0x5c && eax_7 != 0x2f)))
                {
                    goto label_4065c7;
                }
                int32_t eax_14 = sub_4062f9(esi_2);
                var_1c = eax_14;
                int32_t eax_15 = _wchdir(var_1c);
                edi_2 = arg3;
                var_1c = eax_14;
                *edi_2 = eax_15;
                free(var_1c);
                esp_1 = &var_18;
                goto label_4065b3;
            }
            if (edi_1 == 0)
            {
                goto label_4065c7;
            }
            var_1c = *edi_1;
            if (iswalpha(var_1c) != 0)
            {
                var_1c = 0x3a;
                esp = &var_18;
                if ((edi_1[1] == var_1c && edi_1[2] == 0))
                {
                    goto label_4065c7;
                }
            }
            int32_t eax_12 = sub_4062f9(edi_1);
            var_1c = eax_12;
            int32_t eax_13 = _wchdir(var_1c);
            edi_2 = arg3;
            var_1c = eax_12;
            *edi_2 = eax_13;
            free(var_1c);
            esp_1 = &var_18;
            goto label_4065b3;
        }
        if (arg1 != 1)
        {
            if (data_412490 == eax_7)
            {
                goto label_4065c7;
            }
            eax_7 = sub_405cdf();
            if (eax_7 == 0)
            {
                goto label_4065c7;
            }
            if (*eax_7 == 0)
            {
                goto label_4065c7;
            }
            var_1c = sub_40e917(eax_7);
            eax_7 = _wputenv(var_1c);
            edi_2 = arg3;
            esp = &var_18;
            *edi_2 = eax_7;
            if (eax_7 == 0xffffffff)
            {
                var_1c = 0x41f;
                sub_4053c9(data_4226b0, var_1c);
                esp_1 = &var_1c;
            label_4065b3:
                *esp_1;
                esp = &esp_1[1];
            }
            if (*edi_2 == 0)
            {
                goto label_40646d;
            }
            *edi_2 = 1;
            goto label_40646d;
        }
    label_4065c7:
        eax_7 = 0;
    }
    if (((eax_2 != 0 && esi_1[1] == edx) && esi_1[2] == 0))
    {
        var_1c = *esi_1;
        var_1c = (towupper(var_1c) - 0x40);
        _chdrive(var_1c);
        esp = &var_18;
        *arg3 = 0;
    label_40646d:
        eax_7 = 1;
    }
    *esp;
    esp[1];
    esp[2];
    return eax_7;
}

int32_t __fastcall sub_4065d0(int16_t* arg1, int32_t arg2)
{
    int16_t* esi = arg1;
    while (true)
    {
        uint32_t eax_1 = *esi;
        if ((eax_1 != 0x20 && eax_1 != 9))
        {
            int16_t var_14 = 0;
            int32_t eax_2 = wcspbrk(esi, u" \t<>\r");
            if (eax_2 != 0)
            {
                var_14 = *eax_2;
                *eax_2 = 0;
            }
            int32_t _Stream;
            int32_t ecx_1;
            if (arg2 != 4)
            {
                _Stream = __acrt_iob_func(1);
                int32_t ecx_2;
                ecx_2 = arg2 != 2;
                ecx_1 = (((ecx_2 - 1) & 0x1f8) + 0x109);
            }
            else
            {
                _Stream = __acrt_iob_func(0);
                ecx_1 = 0;
            }
            int32_t _FileHandle = 0;
            int32_t eax_4 = _wsopen_s(&_FileHandle, esi, ecx_1, 0x40, 0x180);
            bool edx = eax_4 == 0;
            bool var_5 = edx;
            if (eax_4 == 0)
            {
                int32_t eax_5 = _fileno(_Stream);
                if (_dup2(_FileHandle, eax_5) == 0xffffffff)
                {
                    sub_4053c9(0, 0x411);
                }
                _close(_FileHandle);
                edx = var_5;
            }
            if ((edx != 0 && arg2 == 3))
            {
                _lseek(_fileno(_Stream), 0, 2);
                edx = var_5;
            }
            if (*esi != 0)
            {
                do
                {
                    *esi = 0x20;
                    esi = &esi[1];
                } while (*esi != 0);
            }
            if (eax_2 != 0)
            {
                *eax_2 = var_14;
            }
            int32_t eax_8;
            eax_8 = edx;
            return eax_8;
        }
        esi = &esi[1];
    }
}

int32_t __fastcall sub_4066ef(int16_t* arg1, int32_t arg2, int32_t* arg3, int32_t* arg4)
{
    int32_t* ebx;
    *ebx[1] = 0;
    char var_5 = nullptr;
    ebx = 0;
    int16_t* var_c = arg1;
    int32_t edi = 0;
    int32_t esi = wcspbrk(arg1, &data_4016dc);
    int32_t eax_1;
    if (esi != 0)
    {
        while (true)
        {
            uint32_t eax_2 = *esi;
            int32_t edx;
            int16_t* esi_1;
            if ((eax_2 == 0x3c && *ebx[1] == 0))
            {
                if (edi == 0)
                {
                    edi = sub_40e917(var_c);
                }
                *esi = 0x20;
                *ebx[1] = 1;
                esi_1 = (esi + 2);
                var_c = esi_1;
                eax_1 = _dup(_fileno(__acrt_iob_func(0)));
                *arg3 = eax_1;
                if (eax_1 != 0xffffffff)
                {
                    edx = 4;
                }
            }
            if ((eax_2 == 0x3e && var_5 == 0))
            {
                if (edi == 0)
                {
                    edi = sub_40e917(var_c);
                }
                *esi = 0x20;
                esi_1 = (esi + 2);
                var_c = esi_1;
                var_5 = 1;
                int32_t var_10_1;
                if (*esi_1 != 0x3e)
                {
                    var_10_1 = 2;
                }
                else
                {
                    *esi_1 = 0x20;
                    esi_1 = &esi_1[1];
                    var_10_1 = 3;
                }
                eax_1 = _dup(_fileno(__acrt_iob_func(1)));
                *arg4 = eax_1;
                if (eax_1 != 0xffffffff)
                {
                    edx = var_10_1;
                }
            }
            if ((((eax_2 == 0x3c && *ebx[1] == 0) && eax_1 != 0xffffffff) || ((eax_2 == 0x3e && var_5 == 0) && eax_1 != 0xffffffff)))
            {
                eax_1 = sub_4065d0(esi_1, edx);
                if (eax_1 != 0)
                {
                    goto label_406824;
                }
            }
            if (((eax_2 != 0x3c && eax_2 != 0x3e) && eax_2 != 0x7c))
            {
                sub_4053c9(0, 0x411);
            label_406824:
                esi = wcspbrk(var_c, &data_4016dc);
                if (esi == 0)
                {
                    break;
                }
                continue;
            }
            if (edi != 0)
            {
                wcscpy_s(arg1, arg2, edi);
                free(edi);
            }
            if (*ebx[1] == 0)
            {
            label_4068a6:
                ebx = 1;
                if ((var_5 != 0 && *arg4 != 0xffffffff))
                {
                    int32_t eax_14 = _fileno(__acrt_iob_func(1));
                    if (_dup2(*arg4, eax_14) == 0xffffffff)
                    {
                        sub_4053c9(0, 0x411);
                    }
                    _close(*arg4);
                    *arg4 = 0xffffffff;
                    ebx = 1;
                }
                break;
            }
            if (*arg3 != 0xffffffff)
            {
                int32_t eax_11 = _fileno(__acrt_iob_func(0));
                if (_dup2(*arg3, eax_11) == 0xffffffff)
                {
                    sub_4053c9(0, 0x411);
                }
                _close(*arg3);
                *arg3 = 0xffffffff;
            }
            goto label_4068a6;
        }
    }
    eax_1 = ebx;
    return eax_1;
}

int32_t sub_4068f3() __pure
{
    return 1;
}

int32_t __fastcall sub_4068f9(int16_t* arg1, void** arg2)
{
    int16_t* var_8 = arg1;
    int16_t* var_c = arg1;
    int16_t* edi = arg1;
    int32_t eax;
    if (edi == 0)
    {
        eax = 0;
    }
    else
    {
        int16_t i_5 = *edi;
        int16_t* esi_1 = edi;
        int16_t i_2 = i_5;
        if (i_5 == 0x3b)
        {
            int16_t i;
            do
            {
                arg1 = &arg1[1];
                i = *arg1;
            } while (i == 0x3b);
            i_2 = i;
        }
        int16_t i_4 = i_2;
        if (i_2 != 0)
        {
            int16_t i_3 = i_2;
            int16_t i_1;
            do
            {
                i_4 = i_3;
                if (i_3 == 0x3b)
                {
                    break;
                }
                arg1 = &arg1[1];
                if (i_3 != 0x22)
                {
                    *esi_1 = i_3;
                    esi_1 = &esi_1[1];
                }
                else
                {
                    int16_t j_3 = *arg1;
                    int16_t j_2 = j_3;
                    if (j_3 != 0)
                    {
                        int16_t j_1 = j_3;
                        int16_t j;
                        do
                        {
                            j_2 = j_1;
                            if (j_1 == 0x22)
                            {
                                break;
                            }
                            arg1 = &arg1[1];
                            *esi_1 = j_1;
                            esi_1 = &esi_1[1];
                            j = *arg1;
                            j_1 = j;
                            j_2 = j;
                        } while (j != 0);
                    }
                    if (j_2 != 0)
                    {
                        arg1 = &arg1[1];
                    }
                }
                i_1 = *arg1;
                i_3 = i_1;
                i_4 = i_1;
            } while (i_1 != 0);
        }
        uint32_t i_6 = i_4;
        int32_t ecx = (-i_6);
        *arg2 = ((ecx - ecx) & &arg1[1]);
        *esi_1 = 0;
        eax = esi_1 != edi;
    }
    return eax;
}

int32_t __fastcall sub_4069c2(int16_t* arg1, uint8_t* arg2)
{
    int32_t __saved_ebp;
    int32_t var_c = (__security_cookie ^ &__saved_ebp);
    void* var_630 = nullptr;
    char var_619 = 0;
    if (*arg1 == 0x22)
    {
        int16_t* edx = arg1;
        int32_t eax_1;
        do
        {
            eax_1 = *edx;
            edx = &edx[1];
        } while (eax_1 != 0);
        void* ebx_2 = &arg1[(-1 + ((edx - &edx[1]) >> 1))];
        var_630 = ebx_2;
        if (0x22 == *ebx_2)
        {
            var_619 = 1;
            do
            {
                arg1 = &arg1[1];
            } while (0x22 == *arg1);
            if (ebx_2 > arg1)
            {
                void* eax_2;
                do
                {
                    eax_2 = (ebx_2 - 2);
                    if (0x22 != *eax_2)
                    {
                        break;
                    }
                    ebx_2 = eax_2;
                } while (eax_2 > arg1);
                var_630 = ebx_2;
            }
            *ebx_2 = 0;
        }
    }
    void var_618;
    int16_t var_418;
    int16_t var_218;
    int16_t var_14;
    _wsplitpath_s(arg1, &var_14, 3, &var_418, 0x100, &var_618, 0x100, &var_218, 0x100);
    int32_t var_624;
    int16_t* edi_1;
    if (var_218 == 0)
    {
        int32_t eax_4 = _wgetenv_s(&var_624, 0, 0, u"PATHEXT");
        int32_t eax_5;
        if (eax_4 == 0)
        {
            eax_5 = var_624;
            if (eax_5 != 0)
            {
                int32_t eax_6;
                int32_t edx_3;
                edx_3 = HIGHD((eax_5 * 2));
                eax_6 = LOWD((eax_5 * 2));
                int32_t ecx_3;
                ecx_3 = ((eax_5 * 2) >> 0x20) != 0;
                edi_1 = sub_40aba4(((-ecx_3) | eax_6));
                if (_wgetenv_s(&var_624, edi_1, var_624, u"PATHEXT") != 0)
                {
                    free(edi_1);
                    edi_1 = nullptr;
                }
            }
        }
        if (((eax_4 != 0 || (eax_4 == 0 && eax_5 == 0)) || ((eax_4 == 0 && eax_5 != 0) && edi_1 == 0)))
        {
            var_624 = 0x21;
            edi_1 = sub_40aba4(0x42);
            wcscpy_s(edi_1, var_624, u".COM;.EXE;.BAT;.CMD;.VBS;.JS;.WS");
        }
    }
    else
    {
        int16_t* ecx = &var_218;
        int16_t i;
        do
        {
            i = *ecx;
            ecx = &ecx[1];
        } while (i != 0);
        edi_1 = &var_218;
        void var_216;
        var_624 = (((ecx - &var_216) >> 1) + 1);
    }
    int32_t var_634;
    int32_t ebx_3;
    if ((var_14 != 0 || (var_14 == 0 && var_418 != 0)))
    {
        int16_t* ecx_10 = &var_14;
        int32_t eax_3;
        do
        {
            eax_3 = *ecx_10;
            ecx_10 = &ecx_10[1];
        } while (eax_3 != 0);
        int16_t* edx_5 = &var_418;
        do
        {
            eax_3 = *edx_5;
            edx_5 = &edx_5[1];
        } while (eax_3 != 0);
        void var_416;
        void var_12;
        int32_t esi_4 = ((((ecx_10 - &var_12) >> 1) + 1) + ((edx_5 - &var_416) >> 1));
        int32_t eax_20;
        int32_t edx_8;
        edx_8 = HIGHD((esi_4 * 2));
        eax_20 = LOWD((esi_4 * 2));
        int32_t ecx_13;
        ecx_13 = ((esi_4 * 2) >> 0x20) != 0;
        ebx_3 = sub_40aba4(((-ecx_13) | eax_20));
        var_634 = ebx_3;
        if (_wmakepath_s(ebx_3, esi_4, &var_14, &var_418, 0, 0) != 0)
        {
            free(ebx_3);
            ebx_3 = 0;
            var_634 = 0;
        }
    }
    void* var_62c;
    if ((var_14 == 0 && var_418 == 0))
    {
        int32_t var_620;
        int32_t eax_9 = _wgetenv_s(&var_620, 0, 0, u"PATH");
        if ((eax_9 != 0 || (eax_9 == 0 && var_620 == eax_9)))
        {
            var_620 = 1;
        }
        FARPROC eax_10 = data_43666c;
        if (eax_10 == 0)
        {
            eax_10 = GetProcAddress(GetModuleHandleW(u"KERNEL32.DLL"), "NeedCurrentDirectoryForExePathW");
            data_43666c = eax_10;
            if (eax_10 == 0)
            {
                eax_10 = sub_4068f3;
                data_43666c = sub_4068f3;
            }
        }
        void* eax_12 = eax_10(&var_618);
        var_62c = eax_12;
        int32_t eax_13 = var_620;
        if (eax_12 != 0)
        {
            eax_13 = (eax_13 + 2);
            var_620 = eax_13;
        }
        int32_t eax_14;
        int32_t edx_4;
        edx_4 = HIGHD((eax_13 * 2));
        eax_14 = LOWD((eax_13 * 2));
        int32_t ecx_7;
        ecx_7 = ((eax_13 * 2) >> 0x20) != 0;
        ebx_3 = sub_40aba4(((-ecx_7) | eax_14));
        var_634 = ebx_3;
        int32_t esi_2 = ebx_3;
        int32_t eax_17;
        if (var_62c == 0)
        {
            eax_17 = var_620;
        }
        else
        {
            wcscpy_s(ebx_3, var_620, &data_40173c);
            esi_2 = (ebx_3 + 4);
            eax_17 = (var_620 - 2);
            var_620 = eax_17;
        }
        int32_t eax_18 = _wgetenv_s(&var_620, esi_2, eax_17, u"PATH");
        if ((eax_18 != 0 || (eax_18 == 0 && var_620 == eax_18)))
        {
            *esi_2 = 0;
        }
    }
    int32_t var_640 = ebx_3;
    int32_t esi_5 = 0;
    int32_t ecx_17 = ebx_3;
    int32_t eax_32;
    while (true)
    {
        if (sub_4068f9(ecx_17, &var_62c) == 0)
        {
            free(esi_5);
            free(ebx_3);
            if (edi_1 != &var_218)
            {
                free(edi_1);
            }
            eax_32 = 0;
            break;
        }
        int32_t eax_23 = var_624;
        int32_t eax_24;
        int32_t edx_9;
        edx_9 = HIGHD((eax_23 * 2));
        eax_24 = LOWD((eax_23 * 2));
        int32_t ecx_18;
        ecx_18 = ((eax_23 * 2) >> 0x20) != 0;
        esi_5 = sub_40aba4(((-ecx_18) | eax_24));
        wcscpy_s(esi_5, var_624, edi_1);
        int32_t var_638_1 = esi_5;
        int32_t ecx_21 = esi_5;
        char eax_29;
        while (true)
        {
            void* var_63c;
            eax_29 = sub_4068f9(ecx_21, &var_63c);
            if (eax_29 == 0)
            {
                break;
            }
            int32_t eax_26 = _wmakepath_s(arg2, 0x104, 0, var_640, &var_618, var_638_1);
            if ((eax_26 == 0 && _waccess_s(arg2, eax_26) == 0))
            {
                break;
            }
            void* eax_28 = var_63c;
            ecx_21 = eax_28;
            var_638_1 = eax_28;
        }
        if (eax_29 != 0)
        {
            if (var_619 != 0)
            {
                int16_t* ebx_4 = arg2;
                int32_t eax_27;
                do
                {
                    eax_27 = *ebx_4;
                    ebx_4 = &ebx_4[1];
                } while (eax_27 != 0);
                int32_t ebx_6 = ((ebx_4 - &ebx_4[1]) >> 1);
                int32_t esi_6 = (ebx_6 * 2);
                memmove(&arg2[2], arg2, esi_6);
                *arg2 = 0x22;
                *((esi_6 + arg2) + 2) = 0x22;
                *((arg2 + (ebx_6 << 1)) + 4) = 0;
                ebx_3 = var_634;
                *var_630 = 0x22;
            }
            free(esi_5);
            free(ebx_3);
            if (edi_1 != &var_218)
            {
                free(edi_1);
            }
            eax_32 = 1;
            break;
        }
        void* eax_30 = var_62c;
        ecx_17 = eax_30;
        var_640 = eax_30;
    }
    CookieCheckFunction(eax_32);
    return eax_32;
}

int32_t __fastcall sub_406e64(int16_t* arg1, char arg2, char arg3, char arg4, int32_t* arg5)
{
    __security_cookie;
    bool cond:0 = data_422eec != 0;
    int16_t ebx;
    ebx = arg2;
    int16_t* var_424 = arg1;
    *ebx[1] = ebx;
    if ((!cond:0))
    {
        int32_t eax_3 = sub_4075e7();
        arg1 = var_424;
        data_422eec = eax_3;
    }
    uint32_t eax_4 = *arg1;
    int32_t var_444 = 0;
    char var_448 = 1;
    char var_426;
    if (eax_4 == 0x2d)
    {
        var_426 = 1;
        var_424 = &arg1[1];
        if (iswdigit(arg1[1]) == 0)
        {
            data_432ef0 = 0xffffffff;
        }
        else
        {
            int16_t* esi_1 = var_424;
            data_432ef0 = wcstoul(esi_1, &var_424, 0xa);
            if (*_errno() == 0x22)
            {
                int16_t* var_45c_2 = esi_1;
                *var_424 = 0;
                sub_4053c9(0, 0x436);
            }
            void* eax_11 = var_424;
            while (true)
            {
                if (iswspace(*eax_11) == 0)
                {
                    break;
                }
                eax_11 = &var_424[1];
                var_424 = eax_11;
            }
        }
        arg1 = var_424;
    }
    else
    {
        if (eax_4 == 0x40)
        {
            arg1 = &arg1[1];
            var_424 = arg1;
            ebx = arg3 != 0;
            ebx = (ebx - 1);
            ebx = (ebx & *ebx[1]);
        }
        *ebx[1] = arg4;
        var_426 = *ebx[1];
    }
    int32_t eax_14 = 0;
    if (*arg1 != 0)
    {
        int16_t* edx_1 = arg1;
        void** i_1 = nullptr;
        do
        {
            eax_14 = *edx_1;
            edx_1 = &edx_1[1];
        } while (eax_14 != 0);
        if (((edx_1 - &edx_1[1]) >> 1) >= 0x8000)
        {
            data_412490 = 0;
        }
        else
        {
            wcscpy_s(0x412490, 0x8000, arg1);
            arg1 = var_424;
        }
        int32_t eax_15 = sub_40e917(arg1);
        int32_t var_43c_1 = eax_15;
        if (ebx != 0)
        {
            int32_t var_45c_5 = eax_15;
            sub_40ce84(u"\t%s\n");
            sub_40ce66();
        }
        int32_t _FileHandle_3;
        sub_405598(&_FileHandle_3, nullptr, eax_15);
        int32_t esi_8;
        if (_FileHandle_3 == 0)
        {
        label_407008:
            esi_8 = 0;
        }
        else
        {
            int32_t _FileHandle_2 = _FileHandle_3;
            int32_t _FileHandle_1 = _FileHandle_2;
            int32_t eax_18;
            int32_t edx_4;
            edx_4 = HIGHD(((_FileHandle_2 + 8) * 4));
            eax_18 = LOWD(((_FileHandle_2 + 8) * 4));
            int32_t ecx_5;
            ecx_5 = (((_FileHandle_2 + 8) * 4) >> 0x20) != 0;
            i_1 = sub_40aba4(((-ecx_5) | eax_18));
            sub_405598(&_FileHandle_3, i_1, var_43c_1);
            if (*i_1 != 0)
            {
                int32_t eax_20 = data_422ee8;
                if (eax_20 != 0)
                {
                    int32_t eax_21 = _wcsicmp(*i_1, eax_20);
                    if (eax_21 == 0)
                    {
                        if (data_412488 == eax_21)
                        {
                            int32_t ebx_1 = *__p__wpgmptr();
                            data_412488 = ebx_1;
                            if (wcspbrk(ebx_1, &data_401058) != 0)
                            {
                                int16_t* esi_4 = data_412488;
                                void* ecx_11 = &esi_4[1];
                                int32_t eax_23;
                                do
                                {
                                    eax_23 = *esi_4;
                                    esi_4 = &esi_4[1];
                                } while (eax_23 != 0);
                                int32_t eax_25;
                                int32_t edx_6;
                                edx_6 = HIGHD(((((esi_4 - ecx_11) >> 1) + 3) * 2));
                                eax_25 = LOWD(((((esi_4 - ecx_11) >> 1) + 3) * 2));
                                int32_t ecx_12;
                                ecx_12 = (((((esi_4 - ecx_11) >> 1) + 3) * 2) >> 0x20) != 0;
                                int32_t eax_26 = sub_40aba4(((-ecx_12) | eax_25));
                                data_412488 = eax_26;
                                wcscpy_s(eax_26, (((esi_4 - ecx_11) >> 1) + 3), &data_40104c);
                                wcscat_s(data_412488, (((esi_4 - ecx_11) >> 1) + 3), ebx_1);
                                wcscat_s(data_412488, (((esi_4 - ecx_11) >> 1) + 3), &data_40104c);
                                _FileHandle_2 = _FileHandle_1;
                            }
                        }
                        *i_1 = data_412488;
                    }
                }
            }
            int32_t var_434;
            if (arg3 != 0)
            {
                int32_t eax_30 = wcspbrk(var_424, u"<>|&%");
                char ebx_4 = (-eax_30);
                if (sub_406419(_FileHandle_2, i_1, &var_434) != 0)
                {
                    esi_8 = var_434;
                    ebx_4 = 0;
                }
                else
                {
                    int16_t* esi_9 = var_424;
                    int16_t* ecx_18 = esi_9;
                    void* edx_9 = &ecx_18[1];
                    int32_t eax_31;
                    do
                    {
                        eax_31 = *ecx_18;
                        ecx_18 = &ecx_18[1];
                    } while (eax_31 != 0);
                    if ((((ecx_18 - edx_9) >> 1) >= 0x1000 || (((ecx_18 - edx_9) >> 1) < 0x1000 && (ebx_4 - ebx_4) != 0xff)))
                    {
                        int32_t _FileHandle = 0xffffffff;
                        int16_t* edx_10 = esi_9;
                        _FileHandle_1 = 0xffffffff;
                        do
                        {
                            eax_31 = *edx_10;
                            edx_10 = &edx_10[1];
                        } while (eax_31 != 0);
                        eax_31 = sub_4066ef(esi_9, (((edx_10 - &edx_10[1]) >> 1) + 1), &_FileHandle, &_FileHandle_1);
                        char var_425_1 = eax_31;
                        if (eax_31 == 0)
                        {
                            int16_t* ecx_23 = var_424;
                            do
                            {
                                eax_31 = *ecx_23;
                                ecx_23 = &ecx_23[1];
                            } while (eax_31 != 0);
                            int32_t ecx_25 = ((ecx_23 - &ecx_23[1]) >> 1);
                            if (ecx_25 >= 0x8000)
                            {
                                int16_t* var_45c_13 = var_424;
                                ecx_25 = sub_4053c9(0, 0x447);
                            }
                            if ((_FileHandle != 0xffffffff || (_FileHandle == 0xffffffff && _FileHandle_1 != 0xffffffff)))
                            {
                                free(var_43c_1);
                                int32_t eax_32 = sub_40e917(var_424);
                                var_43c_1 = eax_32;
                                ecx_25 = sub_405598(&_FileHandle_3, i_1, eax_32);
                            }
                            int32_t var_45c_16 = ecx_25;
                            int16_t str;
                            sub_4069c2(*i_1, &str);
                            var_425_1 = 1;
                            if (str == 0x22)
                            {
                                int16_t* esi_10 = &str;
                                int16_t i;
                                do
                                {
                                    i = *esi_10;
                                    esi_10 = &esi_10[1];
                                } while (i != 0);
                                void var_216;
                                int32_t esi_12 = ((esi_10 - &var_216) >> 1);
                                void var_21a;
                                if (*(&var_21a + (esi_12 << 1)) == 0x22)
                                {
                                    memmove(&str, &var_216, (esi_12 * 2));
                                    if (((esi_12 << 1) + 0xfffffffc) >= 0x208)
                                    {
                                        ___report_rangecheckfailure();
                                        breakpoint();
                                    }
                                    *(&str + ((esi_12 << 1) + 0xfffffffc)) = 0;
                                }
                            }
                            *i_1 = &str;
                            if (wcschr(&str, 0x20) != 0)
                            {
                                int16_t var_420 = 0x22;
                                void var_41e;
                                wcscpy_s(&var_41e, 0x103, &str);
                                wcscat_s(&var_420, 0x104, &data_40104c);
                                *i_1 = &var_420;
                            }
                            *_errno() = 0;
                            if (((_wspawnvp(0, &str, i_1) == 0xffffffff && *_errno() != 0xc) && *__doserrno() == 0xc1))
                            {
                                var_425_1 = 1;
                            }
                        }
                        esi_8 = var_434;
                        if (_FileHandle != 0xffffffff)
                        {
                            int32_t eax_34 = _fileno(__acrt_iob_func(0));
                            if (_dup2(_FileHandle, eax_34) == 0xffffffff)
                            {
                                sub_4053c9(0, 0x411);
                            }
                            _close(_FileHandle);
                        }
                        if (_FileHandle_1 != 0xffffffff)
                        {
                            int32_t eax_37 = _fileno(__acrt_iob_func(1));
                            if (_dup2(_FileHandle_1, eax_37) == 0xffffffff)
                            {
                                sub_4053c9(0, 0x411);
                            }
                            _close(_FileHandle_1);
                        }
                        ebx_4 = var_425_1;
                        if (ebx_4 != 0)
                        {
                            esi_9 = var_424;
                        }
                    }
                    if ((((ecx_18 - edx_9) >> 1) < 0x1000 && (ebx_4 - ebx_4) == 0xff))
                    {
                        ebx_4 = ((ebx_4 - ebx_4) + 2);
                    }
                    if (((((ecx_18 - edx_9) >> 1) < 0x1000 && (ebx_4 - ebx_4) == 0xff) || ((((ecx_18 - edx_9) >> 1) >= 0x1000 || (((ecx_18 - edx_9) >> 1) < 0x1000 && (ebx_4 - ebx_4) != 0xff)) && ebx_4 != 0)))
                    {
                        int16_t* ecx_39 = esi_9;
                        do
                        {
                            eax_31 = *ecx_39;
                            ecx_39 = &ecx_39[1];
                        } while (eax_31 != 0);
                        if (((ecx_39 - &ecx_39[1]) >> 1) >= 0x1000)
                        {
                            sub_4053c9(0, 0x447);
                        }
                        else
                        {
                            wcscpy_s(0x412490, 0x8000, esi_9);
                        }
                        esi_8 = sub_405bce(0, _FileHandle_3, i_1);
                    }
                }
                int32_t eax_44;
                if (esi_8 == 0xffffffff)
                {
                    if (var_426 != 0)
                    {
                        goto label_407008;
                    }
                    eax_44 = *_errno();
                    if (eax_44 == 2)
                    {
                        void* var_45c_31 = *i_1;
                        sub_4053c9(0, 0x439);
                    }
                    if ((eax_44 != 0 && eax_44 != 2))
                    {
                        int32_t var_460_14;
                        if (eax_44 != 0xc)
                        {
                            void var_3a8;
                            _wcserror_s(&var_3a8, 0xc8, *_errno());
                            void* var_45c_29 = &var_3a8;
                            var_460_14 = 0x415;
                        }
                        else
                        {
                            void* i_2 = &i_1[2];
                            if (ebx_4 == 0)
                            {
                                i_2 = i_1;
                            }
                            int32_t var_45c_30 = *i_2;
                            var_460_14 = 0x43a;
                        }
                        sub_4053c9(0, var_460_14);
                    }
                }
                if ((((((((esi_8 == 0xffffffff && var_426 == 0) && eax_44 == 2) || esi_8 != 0xffffffff) && esi_8 != 0) || ((esi_8 == 0xffffffff && var_426 == 0) && eax_44 == 0)) || (((esi_8 == 0xffffffff && var_426 == 0) && eax_44 != 0) && eax_44 != 2)) && arg5 != 0))
                {
                    void* i_3 = &i_1[2];
                    if (ebx_4 == 0)
                    {
                        i_3 = i_1;
                    }
                    *arg5 = sub_40e917(*i_3);
                }
            }
            else
            {
                if (sub_406419(_FileHandle_2, i_1, &var_434) == 0)
                {
                    goto label_407008;
                }
                esi_8 = var_434;
                if ((esi_8 != 0 && arg5 != 0))
                {
                    *arg5 = sub_40e917(*i_1);
                }
            }
        }
        int32_t ecx_45 = 0;
        int32_t _FileHandle_4 = _FileHandle_3;
        if (_FileHandle_4 != 0xfffffff8)
        {
            while (i_1 != 0)
            {
                if (i_1[ecx_45] == 0)
                {
                    break;
                }
                if (i_1[ecx_45] == var_43c_1)
                {
                    var_448 = 0;
                    break;
                }
                ecx_45 = (ecx_45 + 1);
                if (ecx_45 >= (_FileHandle_4 + 8))
                {
                    break;
                }
            }
        }
        if (((_FileHandle_4 == 0xfffffff8 || (_FileHandle_4 != 0xfffffff8 && i_1 != 0)) && i_1 != 0))
        {
            free(i_1);
        }
        if ((var_43c_1 != 0 && var_448 != 0))
        {
            free(var_43c_1);
        }
        eax_14 = esi_8;
    }
    CookieCheckFunction(eax_14);
    return eax_14;
}

int32_t sub_4075e7()
{
    __security_cookie;
    uint8_t* var_218 = nullptr;
    _wdupenv_s(&var_218, 0, u"COMSPEC");
    uint8_t* ecx = var_218;
    int32_t eax_3;
    if (ecx != 0)
    {
        int32_t eax_2 = sub_40e917(ecx);
        free(var_218);
        eax_3 = eax_2;
    }
    else
    {
        int16_t var_214;
        _wsearchenv(u"CMD.EXE", u"PATH", &var_214);
        if (var_214 == 0)
        {
            sub_4053c9(0, 0x420);
        }
        eax_3 = sub_40e917(&var_214);
    }
    CookieCheckFunction(eax_3);
    return eax_3;
}

uint32_t __fastcall sub_407683(int16_t* arg1, int32_t* arg2, char arg3, char arg4, int32_t arg5, int32_t* arg6)
{
    int32_t* var_10 = arg2;
    uint32_t edi = *arg1;
    int32_t ebx = 0;
    int16_t* esi = arg1;
    int16_t var_c = 0;
    uint32_t eax_1 = edi;
    int32_t var_14 = 0;
    if (edi == 0)
    {
        goto label_407714;
    }
    int16_t ecx = edi;
    var_c = 0x3f;
    int16_t eax_2;
    int16_t eax_3;
    int16_t* edi_1;
    do
    {
        if (ecx == 0x24)
        {
            eax_2 = esi[1];
            if (eax_2 == 0x28)
            {
                esi = &esi[1];
            }
            edi_1 = &esi[1];
            eax_3 = *edi_1;
            if (eax_3 != 0x3f)
            {
                esi = edi_1;
                if ((eax_3 == 0x2a && esi[1] == 0x2a))
                {
                    if (eax_2 != 0x28)
                    {
                        break;
                    }
                    if ((wcschr(u"DFBR", esi[2]) != 0 && esi[3] == 0x29))
                    {
                        break;
                    }
                    if (esi[2] == 0x29)
                    {
                        break;
                    }
                    int32_t var_30_3 = 0x28;
                }
            }
            else
            {
                if (eax_2 != 0x28)
                {
                    break;
                }
                if ((wcschr(u"DFBR", esi[2]) != 0 && esi[3] == 0x29))
                {
                    break;
                }
                if (esi[2] == 0x29)
                {
                    break;
                }
            }
        }
        esi = &esi[1];
        eax_1 = *esi;
        ecx = eax_1;
    } while (eax_1 != 0);
    int16_t esi_1;
    if ((((ecx == 0x24 && eax_3 == 0x2a) && esi[1] == 0x2a) && eax_2 != 0x28))
    {
        ebx = data_422ec4;
        eax_1 = *edi_1;
        arg2 = var_10;
        var_14 = ebx;
        esi_1 = 0x2a;
    }
    else
    {
        if ((!((ecx == 0x24 && eax_3 == 0x3f) && eax_2 != 0x28)))
        {
            goto label_40771c;
        }
        ebx = data_422ed0;
        eax_1 = *esi;
        arg2 = var_10;
        var_14 = ebx;
    label_407714:
        esi_1 = var_c;
    }
    if (eax_1 == 0)
    {
    label_40771c:
        eax_1 = 0;
    }
    else
    {
        if (ebx != 0)
        {
            eax_1 = arg3;
            *ebx[1] = arg3;
            eax_1 = (eax_1 & 4);
            char var_5_1 = eax_1;
            eax_1 = arg4;
            ebx = var_5_1;
            eax_1 = (eax_1 >> 1);
            *ebx[1] = (*ebx[1] & 2);
            int32_t i;
            do
            {
                data_4226bc = arg2;
                int32_t* eax_9 = data_422ec4;
                if (esi_1 != 0x2a)
                {
                    eax_9 = data_422ed0;
                }
                i = *eax_9;
                arg2 = 0xff;
                *eax_9 = 0;
                int32_t eax_10 = sub_40f30f(arg1, arg2, &data_4226bc);
                char eax_11 = sub_410124(&data_422ef0, 0x8000, eax_10, arg5);
                if (eax_11 != 0)
                {
                    int32_t var_30_5 = eax_10;
                    sub_4053c9(0, 0x447);
                }
                if ((ebx == 0 || (ebx != 0 && (arg4 & 8) != 0)))
                {
                    eax_11 = 1;
                }
                if ((ebx != 0 && (arg4 & 8) == 0))
                {
                    eax_11 = 0;
                }
                char edx_1;
                if ((ebx != 0 || ((ebx == 0 && (arg3 & 8) == 0) && (arg4 & 1) == 0)))
                {
                    edx_1 = 1;
                }
                if ((ebx == 0 && ((arg3 & 8) != 0 || ((arg3 & 8) == 0 && (arg4 & 1) != 0))))
                {
                    edx_1 = 0;
                }
                int32_t var_20;
                int32_t eax_12 = sub_406e64(&data_422ef0, edx_1, eax_11, (eax_1 & 1), &var_20);
                *arg6 = eax_12;
                if ((*ebx[1] == 0 && (eax_12 != 0 && (eax_12 > data_432ef0 && data_4226b7 == *ebx[1]))))
                {
                    int32_t var_30_7 = eax_12;
                    int32_t var_34_3 = var_20;
                    sub_4053c9(0, 0x435);
                }
                int32_t* eax_13;
                if (esi_1 != 0x2a)
                {
                    eax_13 = data_422ed0;
                    data_422ed0 = i;
                }
                else
                {
                    eax_13 = data_422ec4;
                    data_422ec4 = i;
                }
                *eax_13 = i;
                free(eax_10);
                if ((*ebx[1] == 0 && data_4226b7 != *ebx[1]))
                {
                    int32_t eax_15 = *arg6;
                    if ((eax_15 != 0 && eax_15 > data_432ef0))
                    {
                        break;
                    }
                }
                arg2 = var_10;
            } while (i != 0);
            ebx = var_14;
        }
        if (esi_1 != 0x2a)
        {
            data_422ed0 = ebx;
        }
        else
        {
            data_422ec4 = ebx;
        }
        eax_1 = 1;
    }
    return eax_1;
}

void __fastcall sub_4078e8(int32_t arg1, int32_t* arg2)
{
    int32_t i = arg1;
    int32_t* ebx = arg2;
    int32_t* var_8 = ebx;
    if (i != 0)
    {
        do
        {
            int16_t* ecx = *ebx;
            i = (i - 1);
            int16_t* edi_1 = ecx;
            uint32_t eax = *ecx;
            if (eax != 0)
            {
                int16_t edx = eax;
                do
                {
                    if ((edx == 0x5c || edx == 0x5e))
                    {
                        void* eax_1 = &edi_1[1];
                        int16_t eax_2;
                        if (*eax_1 != 0x22)
                        {
                            eax_2 = edx;
                        }
                        else
                        {
                            *ecx = edx;
                            edi_1 = eax_1;
                            eax_2 = *eax_1;
                            ecx = &ecx[1];
                        }
                        *ecx = eax_2;
                    }
                    if (((edx != 0x5c && edx != 0x5e) && edx != 0x22))
                    {
                        *ecx = edx;
                    }
                    if (((((edx != 0x5c && edx != 0x5e) && edx != 0x22) || edx == 0x5c) || edx == 0x5e))
                    {
                        ecx = &ecx[1];
                    }
                    edi_1 = &edi_1[1];
                    eax = *edi_1;
                    edx = eax;
                } while (eax != 0);
                ebx = var_8;
            }
            ebx = &ebx[1];
            *ecx = 0;
            var_8 = ebx;
        } while (i != 0);
    }
}

HANDLE __fastcall sub_407972(int16_t* arg1, char arg2)
{
    if (*arg1 == 0x22)
    {
        void* edx = &arg1[1];
        *wcsrchr(arg1, 0x22) = 0;
        int16_t i = *edx;
        *arg1 = i;
        while (i != 0)
        {
            void* ecx = edx;
            edx = (ecx + 2);
            i = *edx;
            *ecx = i;
        }
    }
    int16_t* var_20 = arg1;
    HANDLE eax_2 = sub_4054a3(5);
    if (arg2 == 0)
    {
        void var_c;
        GetSystemTimeAsFileTime(&var_c);
        eax_2 = CreateFileW(arg1, FILE_WRITE_ATTRIBUTES, FILE_SHARE_NONE, nullptr, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, nullptr);
        if (eax_2 != 0xffffffff)
        {
            SetFileTime(eax_2, nullptr, nullptr, &var_c);
            eax_2 = CloseHandle(eax_2);
        }
    }
    return eax_2;
}

int32_t __fastcall sub_407a01(char* arg1)
{
    int32_t eax_1;
    if ((*arg1 & 0x10) != 0)
    {
        eax_1 = *(arg1 + 4);
    }
    if (((*arg1 & 0x10) == 0 || (((*arg1 & 0x10) != 0 && eax_1 == 0) && *(arg1 + 8) == 0)))
    {
        *(arg1 + 0x18);
        eax_1 = *(arg1 + 0x14);
    }
    return eax_1;
}

uint32_t __fastcall sub_407a1b(int16_t* arg1, int32_t* arg2, int32_t** arg3)
{
    __security_cookie;
    int16_t* ebx = arg1;
    void var_218;
    void* esi = &var_218;
    int32_t eax_3 = wcspbrk(ebx, u""^*?");
    bool cond:0 = eax_3 != 0;
    int32_t var_224 = 0;
    if (eax_3 != 0)
    {
        int16_t* ecx_1 = ebx;
        void* edx = &ecx_1[1];
        do
        {
            eax_3 = *ecx_1;
            ecx_1 = &ecx_1[1];
        } while (eax_3 != 0);
        if ((((ecx_1 - edx) >> 1) + 1) > 0x104)
        {
            int32_t eax_5;
            int32_t edx_1;
            edx_1 = HIGHD(((((ecx_1 - edx) >> 1) + 1) * 2));
            eax_5 = LOWD(((((ecx_1 - edx) >> 1) + 1) * 2));
            int32_t ecx_4;
            ecx_4 = (((((ecx_1 - edx) >> 1) + 1) * 2) >> 0x20) != 0;
            esi = sub_40aba4(((-ecx_4) | eax_5));
            if (esi == 0)
            {
                sub_4053c9(data_4226b0, 0x41b);
            }
        }
        int16_t i_2 = *ebx;
        int16_t* ecx_8 = esi;
        int16_t i_1 = i_2;
        if (i_2 != 0)
        {
            int16_t i;
            do
            {
                uint32_t i_3 = i_1;
                if ((i_3 != 0x5e && i_3 != 0x22))
                {
                    *ecx_8 = i_3;
                    ecx_8 = &ecx_8[1];
                }
                ebx = &ebx[1];
                i = *ebx;
                i_1 = i;
            } while (i != 0);
        }
        ebx = esi;
        *ecx_8 = 0;
    }
    FindFileHandle eax_7 = FindFirstFileW(ebx, arg2);
    *arg3 = eax_7;
    char eax_8;
    uint32_t eax_11;
    if (eax_7 != 0xffffffff)
    {
        eax_8 = sub_407d53(ebx, arg2);
        if (eax_8 != 0)
        {
            wchar16* eax_9;
            wchar16* eax_10;
            if (cond:0 != 0)
            {
                eax_9 = wcschr(ebx, 0x2a);
                if (eax_9 == 0)
                {
                    eax_10 = wcschr(ebx, 0x3f);
                }
            }
            if ((cond:0 == 0 || ((cond:0 != 0 && eax_9 == 0) && eax_10 == 0)))
            {
                FindClose(*arg3);
                *arg3 = 0xffffffff;
            }
            if (esi != &var_218)
            {
                free(esi);
            }
            if (((*arg2 & 0x10) == 0 && (arg2[5] == 0 && arg2[6] == 0)))
            {
                arg2[5] = 0xffffffff;
                arg2[6] = 0xffffffff;
            }
            eax_11 = &arg2[0xb];
        }
    }
    if ((eax_7 == 0xffffffff || (eax_7 != 0xffffffff && eax_8 == 0)))
    {
        if (esi != &var_218)
        {
            free(esi);
        }
        eax_11 = 0;
    }
    CookieCheckFunction(eax_11);
    return eax_11;
}

char (*)[0x104] __fastcall sub_407ba7(struct WIN32_FIND_DATAW* arg1, FindFileHandle arg2)
{
    char (* eax_1)[0x104];
    if (FindNextFileW(arg2, arg1) != 0)
    {
        eax_1 = &arg1->cFileName;
    }
    else
    {
        FindClose(arg2);
        eax_1 = nullptr;
    }
    return eax_1;
}

int32_t __fastcall sub_407bca(int16_t* arg1, uint8_t* arg2, int32_t* arg3, int32_t** arg4)
{
    int16_t* var_8 = arg1;
    int16_t* edi = arg1;
    int32_t eax_1;
    uint8_t* ecx_1;
    if (sub_407a1b(arg2, arg3, arg4) != 0)
    {
        ecx_1 = arg2;
    label_407be8:
        eax_1 = sub_40e917(ecx_1);
    }
    else
    {
        if (edi != 0)
        {
        label_407bf3:
            int16_t* esi_1 = &data_4226c0;
            int16_t i;
            int16_t j_1;
            do
            {
            label_407bf8:
                i = *edi;
                do
                {
                    if (i != 0)
                    {
                        int16_t edx_1 = i;
                        int16_t j;
                        do
                        {
                            j_1 = edx_1;
                            if (0x22 != edx_1)
                            {
                                break;
                            }
                            edi = &edi[1];
                            j = *edi;
                            edx_1 = j;
                            j_1 = j;
                        } while (j != 0);
                        if (j_1 != 0)
                        {
                            edi = &edi[1];
                            *esi_1 = j_1;
                            if (j_1 != 0x3b)
                            {
                                esi_1 = &esi_1[1];
                                break;
                            }
                        }
                    }
                    if (esi_1 != 0x4226c0)
                    {
                        uint32_t eax_2 = esi_1[-1];
                        if ((eax_2 != 0x5c && eax_2 != 0x2f))
                        {
                            *esi_1 = 0x5c;
                            esi_1 = &esi_1[1];
                        }
                        *esi_1 = 0;
                        if (wcspbrk(0x4226c0, &data_40103c) != 0)
                        {
                            goto label_407bf3;
                        }
                        wcscpy_s(esi_1, (0x400 - ((esi_1 - 0x4226c0) >> 1)), arg2);
                        esi_1 = &data_4226c0;
                        if (sub_407a1b(&data_4226c0, arg3, arg4) == 0)
                        {
                            goto label_407bf8;
                        }
                        ecx_1 = &data_4226c0;
                        goto label_407be8;
                    }
                    i = *edi;
                } while (i != 0);
            } while (((i != 0 && j_1 != 0) && j_1 != 0x3b));
        }
        eax_1 = 0;
    }
    return eax_1;
}

int32_t __fastcall sub_407cc4(int16_t* arg1, int32_t* arg2)
{
    int16_t* var_8 = arg1;
    int16_t* lpFileName = arg1;
    char ebx = 0;
    int16_t i;
    do
    {
        i = *arg1;
        arg1 = &arg1[1];
    } while (i != 0);
    if ((*lpFileName == 0x22 && lpFileName[(((arg1 - &arg1[1]) >> 1) - 1)] == 0x22))
    {
        lpFileName = sub_4105de(lpFileName);
        ebx = 1;
    }
    int32_t hFindFile_1 = FindFirstFileW(lpFileName, arg2);
    int32_t hFindFile = hFindFile_1;
    if (hFindFile_1 != 0xffffffff)
    {
        hFindFile_1 = sub_407d53(lpFileName, arg2);
        if (hFindFile_1 != 0)
        {
            FindClose(hFindFile);
            if (((*arg2 & 0x10) == 0 && (arg2[5] == 0 && arg2[6] == 0)))
            {
                arg2[5] = 0xffffffff;
                arg2[6] = 0xffffffff;
            }
            hFindFile_1 = 1;
        }
    }
    if ((hFindFile_1 == 0xffffffff || (hFindFile_1 != 0xffffffff && hFindFile_1 == 0)))
    {
        if (ebx != 0)
        {
            free(lpFileName);
        }
        hFindFile_1 = 0;
    }
    return hFindFile_1;
}

HANDLE __fastcall sub_407d53(int16_t* arg1, int32_t* arg2)
{
    int32_t* ebx = arg2;
    int32_t* var_c = ebx;
    BOOL eax_18;
    HANDLE edi_2;
    if (((*ebx & 0x400) != 0 && ebx[9] == 0xa000000c))
    {
        void* lpFileName = &ebx[0xb];
        wchar16* edx = wcsrchr(arg1, 0x5c);
        wchar16* var_10_1 = edx;
        int32_t var_8_1 = 0;
        if (edx != 0)
        {
            int16_t* ecx_1 = arg1;
            void* eax_2;
            do
            {
                eax_2 = *ecx_1;
                ecx_1 = &ecx_1[1];
            } while (eax_2 != 0);
            void* eax_3;
            do
            {
                eax_3 = *edx;
                edx = &edx[1];
            } while (eax_3 != 0);
            void* lpFileName_2 = lpFileName;
            void* var_18_1 = (lpFileName_2 + 2);
            void* eax_4;
            do
            {
                eax_4 = *lpFileName_2;
                lpFileName_2 = (lpFileName_2 + 2);
            } while (eax_4 != 0);
            void* lpFileName_3 = lpFileName_2;
            int32_t eax_9 = ((((lpFileName_2 - var_18_1) >> 1) - ((edx - &edx[1]) >> 1)) + (((ecx_1 - &ecx_1[1]) >> 1) + 2));
            int32_t eax_10;
            int32_t edx_3;
            edx_3 = HIGHD((eax_9 * 2));
            eax_10 = LOWD((eax_9 * 2));
            int32_t ecx_5;
            ecx_5 = ((eax_9 * 2) >> 0x20) != 0;
            int32_t lpFileName_4;
            int32_t edx_4;
            lpFileName_4 = sub_40aba4(((-ecx_5) | eax_10));
            ebx = var_c;
            int32_t lpFileName_1 = lpFileName_4;
            if (lpFileName_4 == 0)
            {
                edx_4 = sub_4053c9(data_4226b0, 0x41b);
                lpFileName_4 = lpFileName_1;
            }
            int32_t lpFileName_5 = lpFileName_4;
            int32_t edx_7 = ((!(edx_4 - edx_4)) & (((var_10_1 - arg1) + 1) >> 1));
            if (edx_7 != 0)
            {
                int32_t ebx_1 = 0;
                do
                {
                    uint32_t eax_14;
                    eax_14 = *((arg1 - lpFileName_1) + lpFileName_5);
                    *lpFileName_5 = eax_14;
                    lpFileName_5 = (lpFileName_5 + 2);
                    ebx_1 = (ebx_1 + 1);
                } while (ebx_1 != edx_7);
                ebx = var_c;
            }
            *lpFileName_5 = 0x5c;
            int16_t i_2 = *lpFileName;
            int16_t* ecx_9 = (lpFileName_5 + 2);
            if (i_2 != 0)
            {
                int16_t i_1 = i_2;
                int16_t i;
                do
                {
                    lpFileName = (lpFileName + 2);
                    *ecx_9 = i_1;
                    ecx_9 = &ecx_9[1];
                    i = *lpFileName;
                    i_1 = i;
                } while (i != 0);
            }
            lpFileName = lpFileName_1;
            *ecx_9 = 0;
        }
        edi_2 = CreateFileW(lpFileName, 0x80000000, FILE_SHARE_READ, nullptr, OPEN_EXISTING, SECURITY_ANONYMOUS, nullptr);
        if (var_10_1 != 0)
        {
            free(lpFileName);
        }
        if (edi_2 != 0xffffffff)
        {
            eax_18 = GetFileTime(edi_2, &ebx[1], &ebx[3], &ebx[5]);
            if (eax_18 != 0)
            {
                CloseHandle(edi_2);
            }
        }
    }
    HANDLE eax;
    if (((((((*ebx & 0x400) != 0 && ebx[9] == 0xa000000c) && edi_2 != 0xffffffff) && eax_18 != 0) || (*ebx & 0x400) == 0) || ((*ebx & 0x400) != 0 && ebx[9] != 0xa000000c)))
    {
        eax = 1;
    }
    if (((*ebx & 0x400) != 0 && ebx[9] == 0xa000000c))
    {
        if ((edi_2 != 0xffffffff && eax_18 == 0))
        {
            CloseHandle(edi_2);
        }
        if (((edi_2 != 0xffffffff && eax_18 == 0) || edi_2 == 0xffffffff))
        {
            eax = 0;
        }
    }
    return eax;
}

uint32_t __fastcall sub_407ee6(int32_t arg1)
{
    int32_t var_c = arg1;
    int32_t var_10 = arg1;
    uint32_t eax_2;
    while (true)
    {
        int16_t eax_1 = getwc(data_422edc);
        int32_t ecx = data_432ef8;
        eax_2 = eax_1;
        if (ecx == 0)
        {
            if (data_412021 == ecx)
            {
                break;
            }
            if ((data_412021 != ecx && eax_2 != 0x21))
            {
                break;
            }
        }
        data_412021 = 0;
        void* edi_1;
        if (ecx != 0)
        {
            ungetwc(eax_2, data_422edc);
            edi_1 = data_432ef8;
            data_432ef8 = 0;
        }
        else
        {
            edi_1 = sub_40808f();
        }
        *var_10[3] = edi_1 != data_432efc;
        void* eax_4 = sub_4081cb(edi_1, &*var_10[2]);
        char edx_2 = *var_10[2];
        void* esi_1 = eax_4;
        if (edx_2 == 9)
        {
            if (data_422ee1 != 0)
            {
                void* var_1c_3 = edi_1;
                sub_4053c9(data_4226a4, 0x409);
            }
            if (sub_40a593(esi_1) == 0x12)
            {
                eax_2 = 0x20;
                break;
            }
        }
        else if (edx_2 == 0xa)
        {
            sub_40831c(esi_1);
        }
        else if (edx_2 == 0xb)
        {
            void* var_1c_4 = esi_1;
            sub_4053c9(data_4226a4, 0x41a);
        }
        else if (edx_2 == 0xc)
        {
            if (_wcsnicmp(esi_1, &data_401794, 2) == 0)
            {
                sub_40ce84(&data_40179c);
                esi_1 = (esi_1 + 4);
            }
            void* var_1c_5 = esi_1;
            sub_4054a3(0xd);
        }
        else if (edx_2 != 0xd)
        {
            sub_40867b(esi_1, edx_2);
        }
        else
        {
            var_c = 0;
            int32_t eax_7 = wcstok_s(esi_1, &data_401044, &var_c);
            if (wcstok_s(0, &data_401044, &var_c) != 0)
            {
                int32_t var_1c_8 = eax_7;
                sub_4053c9(data_4226a4, 0x409);
            }
            void* eax_9 = sub_40ab10(eax_7);
            if (eax_9 != 0)
            {
                *(eax_9 + 0xc) = (*(eax_9 + 0xc) | 0x10);
            }
        }
        bool cond:1_1 = *var_10[3] == 0;
        data_412021 = 1;
        if ((!cond:1_1))
        {
            free(edi_1);
        }
        data_4226a4 = (data_4226a4 + 1);
    }
    return eax_2;
}

int32_t sub_40808f()
{
    int32_t ecx;
    ecx = 1;
    uint32_t esi = sub_409c05(ecx);
    if ((esi == 0xa || esi == 0xffff))
    {
        sub_4053c9(data_4226a4, 0x3fa);
    }
    int32_t edi = 0;
    int16_t eax_1 = sub_409ce2(esi, 1);
    uint32_t esi_1;
    while (true)
    {
        esi_1 = eax_1;
        if (esi_1 == 0x23)
        {
            break;
        }
        if (esi_1 == 0xa)
        {
            break;
        }
        if (esi_1 == 0xffff)
        {
            break;
        }
        int32_t ecx_3 = data_432ef4;
        int32_t eax_3;
        if ((ecx_3 < 2 || (ecx_3 >= 2 && edi > (ecx_3 - 2))))
        {
            int32_t ecx_4 = data_432efc;
            data_432ef4 = (ecx_3 + 0x400);
            if (ecx_4 != 0)
            {
                eax_3 = sub_40abe7(ecx_4, (((ecx_3 + 0x400) << 1) + 2));
            }
            else
            {
                int32_t eax_5;
                int32_t edx_2;
                edx_2 = HIGHD(((ecx_3 + 0x401) * 2));
                eax_5 = LOWD(((ecx_3 + 0x401) * 2));
                ecx_4 = (((ecx_3 + 0x401) * 2) >> 0x20) != 0;
                eax_3 = sub_40aba4(((-ecx_4) | eax_5));
            }
            data_432efc = eax_3;
        }
        if ((ecx_3 >= 2 && edi <= (ecx_3 - 2)))
        {
            eax_3 = data_432efc;
        }
        int32_t var_10_1 = data_422edc;
        *(eax_3 + (edi << 1)) = esi_1;
        edi = (edi + 1);
        eax_1 = sub_409ce2(getwc(var_10_1), 1);
    }
    *(data_432efc + (edi << 1)) = 0;
    if (esi_1 == 0x23)
    {
        int16_t eax_8 = getwc(data_422edc);
        while (true)
        {
            esi_1 = eax_8;
            if (esi_1 == 0xa)
            {
                break;
            }
            if (esi_1 == 0xffff)
            {
                break;
            }
            eax_8 = getwc(data_422edc);
        }
    }
    if ((esi_1 == 0xffff || (esi_1 == 0x23 && esi_1 == 0xffff)))
    {
        ungetwc(esi_1, data_422edc);
    }
    /* tailcall */
    return sub_40f2a7(data_432efc);
}

void* __fastcall sub_4081cb(void* arg1, char* arg2)
{
    void* var_8 = arg1;
    int16_t* edi = arg1;
    *arg2 = 0;
    void* edx = edi;
    int16_t* var_10 = edi;
    int16_t i_5 = *edi;
    void* var_c = arg1;
    char ebx = 9;
    if (i_5 != 0)
    {
        int16_t* esi_1 = edi;
        int16_t i_4 = i_5;
        int16_t i;
        do
        {
            edx = esi_1;
            if (i_4 == 0x20)
            {
                break;
            }
            if (i_4 == 9)
            {
                break;
            }
            arg1 = &esi_1[1];
            i = *arg1;
            esi_1 = arg1;
            var_c = arg1;
            edx = arg1;
            i_4 = i;
        } while (i != 0);
        edi = var_10;
        var_8 = arg1;
    }
    int16_t i_2 = *arg1;
    int32_t esi_4 = ((edx - edi) >> 1);
    if (i_2 != 0)
    {
        int16_t i_1 = i_2;
        while ((!(i_1 != 0x20 && i_1 != 9)))
        {
            void* ecx = (edx + 2);
            int16_t i_3 = *ecx;
            edx = ecx;
            var_8 = ecx;
            var_c = ecx;
            i_1 = i_3;
            if (i_3 == 0)
            {
                break;
            }
        }
        edi = var_10;
    }
    if ((_wcsnicmp(edi, u"INCLUDE", 7) == 0 && esi_4 == 7))
    {
        goto label_4082dc;
    }
    int32_t eax_2 = _wcsnicmp(edi, u"CMDSWITCHES", 0xb);
    void* esi_5;
    if ((eax_2 != 0 || (eax_2 == 0 && esi_4 != 0xb)))
    {
        if ((_wcsnicmp(edi, u"ERROR", 5) == 0 && esi_4 == 5))
        {
            ebx = 0xb;
            goto label_4082dc;
        }
        if ((_wcsnicmp(edi, u"MESSAGE", 7) == 0 && esi_4 == 7))
        {
            ebx = 0xc;
            goto label_4082dc;
        }
        if ((_wcsnicmp(edi, u"UNDEF", 5) == 0 && esi_4 == 5))
        {
            ebx = 0xd;
            goto label_4082dc;
        }
        char eax_6 = sub_40849f(edi, esi_4, &var_c);
        esi_5 = var_c;
        ebx = eax_6;
    }
    if ((eax_2 == 0 && esi_4 == 0xb))
    {
        ebx = 0xa;
    label_4082dc:
        esi_5 = var_8;
    }
    *arg2 = ebx;
    if (ebx == 0)
    {
        int32_t var_28_2 = data_432efc;
        sub_4053c9(data_4226a4, 0x3f9);
    }
    return esi_5;
}

uint32_t __fastcall sub_40831c(int16_t* arg1)
{
    int16_t* esi = arg1;
    uint32_t eax = *esi;
    if (eax != 0)
    {
        int16_t edx_1 = eax;
        do
        {
            uint32_t eax_1 = edx_1;
            int16_t ecx;
            if (eax_1 != 0x2b)
            {
                eax = (eax_1 - 0x2d);
                if (eax_1 != 0x2d)
                {
                    ecx = edx_1;
                    if (edx_1 != 0x20)
                    {
                        ecx = edx_1;
                        if (edx_1 != 9)
                        {
                            eax = sub_4053c9(data_4226a4, 0x400);
                            ecx = *esi;
                        }
                    }
                }
            }
            else
            {
                esi = &esi[1];
                eax = *esi;
                int16_t edx_2 = eax;
                if (eax != 0)
                {
                    uint32_t ecx_1 = eax;
                    do
                    {
                        edx_2 = ecx_1;
                        if (ecx_1 == 0x2d)
                        {
                            break;
                        }
                        wchar16* eax_6 = wcschr(u"DINSU", towupper(ecx_1));
                        wchar16* eax_10;
                        if ((eax_6 == 0 && data_422ee1 != eax_6))
                        {
                            eax_10 = wcschr(u"ABCEKLPQRTY", towupper(*esi));
                        }
                        if ((eax_6 != 0 || ((eax_6 == 0 && data_422ee1 != eax_6) && eax_10 != 0)))
                        {
                            uint32_t ecx_3;
                            ecx_3 = *esi;
                            sub_40c807(ecx_3, 1);
                        }
                        if ((eax_6 == 0 && (data_422ee1 == eax_6 || (data_422ee1 != eax_6 && eax_10 == 0))))
                        {
                            sub_4053c9(data_4226a4, 0x400);
                        }
                        esi = &esi[1];
                        eax = *esi;
                        ecx_1 = eax;
                        edx_2 = eax;
                    } while (eax != 0);
                }
                if (edx_2 == 0)
                {
                    break;
                }
            }
            if ((eax_1 == 0x2d || eax_1 == 0x2b))
            {
                esi = &esi[1];
                eax = *esi;
                ecx = eax;
                if (eax != 0)
                {
                    uint32_t edx_4 = eax;
                    do
                    {
                        eax = 0x2b;
                        ecx = edx_4;
                        if (edx_4 == 0x2b)
                        {
                            break;
                        }
                        wchar16* eax_13 = wcschr(u"DINSU", towupper(edx_4));
                        wchar16* eax_17;
                        if ((eax_13 == 0 && data_422ee1 != eax_13))
                        {
                            eax_17 = wcschr(u"ABCEKLMPQRTV", towupper(*esi));
                        }
                        if ((eax_13 != 0 || ((eax_13 == 0 && data_422ee1 != eax_13) && eax_17 != 0)))
                        {
                            uint32_t ecx_7;
                            ecx_7 = *esi;
                            sub_40c807(ecx_7, 0);
                        }
                        if ((eax_13 == 0 && (data_422ee1 == eax_13 || (data_422ee1 != eax_13 && eax_17 == 0))))
                        {
                            sub_4053c9(data_4226a4, 0x400);
                        }
                        esi = &esi[1];
                        eax = *esi;
                        edx_4 = eax;
                        ecx = eax;
                    } while (eax != 0);
                }
            }
            if (ecx == 0)
            {
                break;
            }
            esi = &esi[1];
            eax = *esi;
            edx_1 = eax;
        } while (eax != 0);
    }
    return eax;
}

int32_t __fastcall sub_40849f(int32_t arg1, int32_t arg2, int16_t** arg3)
{
    int32_t var_8 = arg1;
    int32_t var_c = arg1;
    char ebx = 0;
    int32_t eax_1 = _wcsnicmp(arg1, &data_401830, 2);
    if ((eax_1 != 0 || (eax_1 == 0 && arg2 != 2)))
    {
        eax_1 = _wcsnicmp(arg1, u"IFDEF", 5);
        if ((eax_1 != 0 || (eax_1 == 0 && arg2 != 5)))
        {
            eax_1 = _wcsnicmp(arg1, u"IFNDEF", 6);
            if ((eax_1 != 0 || (eax_1 == 0 && arg2 != 6)))
            {
                int32_t eax_2 = _wcsnicmp(arg1, u"ELSE", 4);
                if ((eax_2 != 0 || (eax_2 == 0 && arg2 != 4)))
                {
                    eax_1 = _wcsnicmp(arg1, u"ELSEIF", 6);
                    if ((eax_1 != 0 || (eax_1 == 0 && arg2 != 6)))
                    {
                        eax_1 = _wcsnicmp(arg1, u"ELSEIFDEF", 9);
                        if ((eax_1 != 0 || (eax_1 == 0 && arg2 != 9)))
                        {
                            eax_1 = _wcsnicmp(arg1, u"ELSEIFNDEF", 0xa);
                            if ((eax_1 != 0 || (eax_1 == 0 && arg2 != 0xa)))
                            {
                                eax_1 = _wcsnicmp(arg1, u"ENDIF", 5);
                                if ((eax_1 == 0 && arg2 == 5))
                                {
                                    ebx = 8;
                                }
                            }
                            if ((eax_1 == 0 && arg2 == 0xa))
                            {
                            label_408654:
                                ebx = 5;
                            }
                        }
                        if ((eax_1 == 0 && arg2 == 9))
                        {
                        label_408638:
                            ebx = 4;
                        }
                    }
                    if ((eax_1 == 0 && arg2 == 6))
                    {
                    label_40861a:
                        ebx = 3;
                    }
                }
                if ((eax_2 == 0 && arg2 == 4))
                {
                    int16_t* ecx_1 = *arg3;
                    eax_1 = *ecx_1;
                    if (eax_1 == 0)
                    {
                        ebx = 2;
                    }
                    else
                    {
                        int16_t* var_8_2 = ecx_1;
                        int16_t edx = eax_1;
                        uint32_t eax_3;
                        do
                        {
                            eax_3 = edx;
                            if (edx == 0x20)
                            {
                                break;
                            }
                            eax_3 = edx;
                            if (edx == 9)
                            {
                                break;
                            }
                            ecx_1 = &ecx_1[1];
                            eax_3 = *ecx_1;
                            edx = eax_3;
                            uint32_t var_c_1 = eax_3;
                        } while (eax_3 != 0);
                        int32_t esi_4 = ((ecx_1 - var_8_2) >> 1);
                        if (eax_3 != 0)
                        {
                            int16_t i = eax_3;
                            while ((!(i != 0x20 && i != 9)))
                            {
                                ecx_1 = &ecx_1[1];
                                int16_t i_1 = *ecx_1;
                                i = i_1;
                                if (i_1 == 0)
                                {
                                    break;
                                }
                            }
                        }
                        *arg3 = ecx_1;
                        eax_1 = _wcsnicmp(var_8_2, &data_401830, 2);
                        if ((eax_1 == 0 && esi_4 == 2))
                        {
                            goto label_40861a;
                        }
                        eax_1 = _wcsnicmp(var_8_2, u"IFDEF", 5);
                        if (eax_1 == 0)
                        {
                            if (esi_4 == 5)
                            {
                                goto label_408638;
                            }
                            goto label_4085f2;
                        }
                    label_4085f2:
                        eax_1 = _wcsnicmp(var_8_2, u"IFNDEF", 6);
                        if ((eax_1 == 0 && esi_4 == 6))
                        {
                            goto label_408654;
                        }
                    }
                }
            }
            if ((eax_1 == 0 && arg2 == 6))
            {
                ebx = 7;
            }
        }
        if ((eax_1 == 0 && arg2 == 5))
        {
            ebx = 6;
        }
    }
    if ((eax_1 == 0 && arg2 == 2))
    {
        ebx = 1;
    }
    eax_1 = ebx;
    return eax_1;
}

void __fastcall sub_40867b(int16_t* arg1, char arg2)
{
    int16_t* var_4 = arg1;
    int16_t* esi = arg1;
    int16_t* var_10_1;
    uint32_t eax;
    bool cond:2_1;
    if (arg2 == 2)
    {
        arg1 = data_412024;
        if (arg1 < 0)
        {
        label_408729:
            var_10_1 = 0x3fd;
            goto label_4086bd;
        }
        eax = arg1[0x219780];
        if ((eax & 9) == 0)
        {
            goto label_408729;
        }
        eax = (eax & 0xf6);
        arg1[0x219780] = eax;
        if ((eax & 4) != 0)
        {
            goto label_4086d6;
        }
        if ((2 & eax) == 0)
        {
            eax = (eax | 2);
        }
        else
        {
            eax = (eax & 0xfd);
        }
        arg1[0x219780] = eax;
        cond:2_1 = (2 & eax) != 0;
    }
    int32_t eax_1;
    if ((arg2 != 1 && arg2 != 2))
    {
        if (arg2 <= 2)
        {
        label_4086de:
            return;
        }
        if (arg2 <= 5)
        {
            arg1 = data_412024;
            if (arg1 < 0)
            {
                goto label_408729;
            }
            eax = arg1[0x219780];
            if ((eax & 9) == 0)
            {
                goto label_408729;
            }
            eax = (eax & 0xfe);
            eax = (eax | 8);
            arg1[0x219780] = eax;
            if ((eax & 4) != 0)
            {
                goto label_4086d6;
            }
            if ((2 & eax) != 0)
            {
                eax = (eax & 0xfd);
                eax = (eax | 4);
                arg1[0x219780] = eax;
                goto label_4086d6;
            }
            arg1 = esi;
        label_408713:
            if (sub_40e060(arg1, arg2) == 0)
            {
                goto label_4086d6;
            }
            eax = data_412024;
            *(eax + 0x432f00) = (*(eax + 0x432f00) | 2);
            goto label_4086de;
        }
        if (arg2 > 7)
        {
            if (arg2 == 8)
            {
                eax_1 = data_412024;
                if (eax_1 >= 0)
                {
                    goto label_4086c7;
                }
                var_10_1 = 0x401;
                goto label_4086bd;
            }
            goto label_4086de;
        }
    }
    if ((arg2 == 1 || (arg2 != 1 && arg2 != 2)))
    {
        void* eax_3 = data_412024;
        if (eax_3 != 0xf)
        {
            data_412024 = (eax_3 + 1);
            *(eax_3 + 0x432f01) = 1;
            if (eax_3 == 0xffffffff)
            {
                goto label_408713;
            }
            if ((*(eax_3 + 0x432f00) & 2) != 0)
            {
                goto label_408713;
            }
            *(eax_3 + 0x432f01) = 5;
        label_4086d6:
            sub_4087a4(arg1);
            goto label_4086de;
        }
        var_10_1 = 0x3fb;
    label_4086bd:
        eax_1 = sub_4053c9(data_4226a4, var_10_1);
        arg1 = var_10_1;
    label_4086c7:
        data_412024 = (eax_1 - 1);
        if ((eax_1 - 1) < 0)
        {
            goto label_4086de;
        }
        cond:2_1 = (*(eax_1 + 0x432eff) & 2) != 0;
    }
    if ((!cond:2_1))
    {
        goto label_4086d6;
    }
    goto label_4086de;
}

uint32_t __fastcall sub_4087a4(int32_t arg1)
{
    int32_t var_8 = arg1;
    uint32_t eax_2;
    while (true)
    {
        eax_2 = getwc(data_422edc);
        if (eax_2 != 0x21)
        {
            while (eax_2 != 0xffff)
            {
                data_4226a4 = (data_4226a4 + 1);
                while (true)
                {
                    if (eax_2 == 0x5c)
                    {
                        eax_2 = sub_409ce2(0x5c, 1);
                        if ((eax_2 == 0x21 && data_412021 != 0))
                        {
                            break;
                        }
                        data_412021 = 0;
                    }
                    if (eax_2 != 0x23)
                    {
                        if (eax_2 == 0xa)
                        {
                            break;
                        }
                        if (eax_2 == 0xffff)
                        {
                            break;
                        }
                        eax_2 = getwc(data_422edc);
                    }
                    else
                    {
                        while (true)
                        {
                            eax_2 = getwc(data_422edc);
                            if (eax_2 == 0xa)
                            {
                                break;
                            }
                            if (eax_2 == 0xffff)
                            {
                                break;
                            }
                            if ((!(eax_2 != 0xa && eax_2 != 0xffff)))
                            {
                                /* nop */
                            }
                        }
                        if (eax_2 != 0xffff)
                        {
                            break;
                        }
                    }
                }
                if ((eax_2 != 0xa && eax_2 != 0xffff))
                {
                    break;
                }
                if (eax_2 == 0xa)
                {
                    if (eax_2 == 0xffff)
                    {
                        break;
                    }
                    if (eax_2 == 0x21)
                    {
                        break;
                    }
                    eax_2 = getwc(data_422edc);
                    if (eax_2 == 0x21)
                    {
                        break;
                    }
                }
            }
            if ((eax_2 == 0xffff && eax_2 != 0x21))
            {
                if (eax_2 == 0xffff)
                {
                    eax_2 = sub_4053c9(data_4226a4, 0x3fc);
                }
                break;
            }
        }
        int32_t eax_7 = data_432ef8;
        if ((eax_7 != 0 && eax_7 != data_432efc))
        {
            free(eax_7);
        }
        void* eax_8 = sub_40808f();
        data_432ef8 = eax_8;
        eax_2 = sub_4081cb(eax_8, &*var_8[3]);
        if (*var_8[3] <= 8)
        {
            break;
        }
        data_4226a4 = (data_4226a4 + 1);
    }
    return eax_2;
}

int32_t sub_4088bc()
{
    char ebx = 0;
    data_4226a4 = 0;
    int32_t eax_3;
    while (true)
    {
        int32_t var_10;
        if (fgetws(0x4226c0, 0x400, data_422edc, nullptr, var_10, 0) == 0)
        {
            if (feof(data_422edc) == 0)
            {
                data_4226b0 = data_4226a4;
                sub_4053c9(0, 0x41d);
            }
            eax_3 = 0;
            break;
        }
        if (data_4226c0 == 0x5b)
        {
            int32_t var_8 = 0;
            int32_t* var_18_1 = &var_8;
            void* const var_1c_1 = &data_4015c4;
            int32_t var_20_1 = 0x4226c2;
            int32_t eax_1;
            while (true)
            {
                eax_1 = wcstok_s(var_20_1, &data_4015c4, var_18_1);
                if (eax_1 == 0)
                {
                    break;
                }
                if (ebx != 0)
                {
                    break;
                }
                int32_t edx_1 = eax_1;
                var_10 = (edx_1 + 2);
                int32_t eax_2;
                do
                {
                    eax_2 = *edx_1;
                    edx_1 = (edx_1 + 2);
                } while (eax_2 != 0);
                int32_t edx_3 = ((edx_1 - var_10) >> 1);
                if (*((eax_1 + (edx_3 << 1)) - 2) == 0x5d)
                {
                    ebx = 1;
                    *((eax_1 + (edx_3 << 1)) - 2) = 0;
                }
                if (_wcsicmp(eax_1, u"nmake") == 0)
                {
                    break;
                }
                var_18_1 = &var_8;
                void* const var_1c_3 = &data_4015c4;
                var_20_1 = 0;
            }
            if (eax_1 != 0)
            {
                eax_3 = 1;
                break;
            }
            ebx = 0;
        }
        data_4226a4 = (data_4226a4 + 1);
    }
    return eax_3;
}

uint32_t __fastcall sub_4089a5(uint32_t arg1, int32_t arg2)
{
    uint32_t esi = arg1;
    int32_t edi = (esi + (arg2 << 1));
    uint32_t eax_2;
    while (true)
    {
        eax_2 = sub_407ee6(arg1);
        if (eax_2 != 0)
        {
            arg1 = 0xffff;
            if (eax_2 == 0xffff)
            {
                *esi = 0;
                break;
            }
            *esi = eax_2;
            esi = (esi + 2);
            if (esi == edi)
            {
                int32_t var_c_1 = data_422edc;
                *(esi - 2) = 0;
                ungetwc(eax_2, var_c_1);
            }
            else if (eax_2 == 0xa)
            {
                data_4226a4 = (data_4226a4 + 1);
                data_412021 = 1;
                *esi = 0;
            }
            else
            {
                data_412021 = 0;
                continue;
            }
        }
        eax_2 = esi;
        break;
    }
    return eax_2;
}

wchar16* __fastcall sub_408a13(wchar16* arg1)
{
    wchar16* var_4 = arg1;
    int32_t var_10 = 0xa;
    wchar16* str = arg1;
    wchar16* eax_4;
    while (true)
    {
        eax_4 = wcschr(str, 0xa);
        if (eax_4 == 0)
        {
            break;
        }
        if ((eax_4 > arg1 && eax_4[-1] != 0x5e))
        {
            break;
        }
        if (fgetws(&eax_4[1], (0x400 - ((&eax_4[1] - arg1) >> 1)), data_422edc) == 0)
        {
            if (feof(data_422edc) != 0)
            {
                void* const var_10_3 = &data_4018a8;
                sub_4053c9(data_4226a4, 0x409);
            }
            sub_4053c9(data_4226a4, 0x41d);
        }
        data_4226a4 = (data_4226a4 + 1);
        int32_t var_10_4 = 0xa;
        str = &eax_4[1];
    }
    return eax_4;
}

int32_t __fastcall sub_408aa7(int32_t* arg1)
{
    char ebx = 0;
    int16_t* esi = &data_433400;
    bool var_5 = false;
    void* str = *arg1;
    int32_t eax_2;
    while (true)
    {
        wchar16* eax_1 = wcschr(str, 0x3c);
        if (eax_1 == 0)
        {
            eax_2 = 0;
            break;
        }
        str = &eax_1[1];
        if (*str == 0x3c)
        {
            ebx = 1;
        }
        if (ebx != 0)
        {
            void* edx_1 = (str + 2);
            int16_t i = *edx_1;
            if (i != 0)
            {
                int32_t var_10_1 = 0xa;
                while (i != 0x3e)
                {
                    if (i == 0x3c)
                    {
                        break;
                    }
                    if (i == 0x5e)
                    {
                        break;
                    }
                    if (i == 0x2c)
                    {
                        break;
                    }
                    if (i == 9)
                    {
                        break;
                    }
                    if (i == 0xa)
                    {
                        break;
                    }
                    bool ecx_1;
                    if (i != 0x22)
                    {
                        ecx_1 = var_5;
                    }
                    else
                    {
                        ecx_1 = var_5 == 0;
                        var_5 = ecx_1;
                    }
                    if ((i == 0x20 && ecx_1 == 0))
                    {
                        break;
                    }
                    int16_t i_1 = i;
                    int16_t i_2;
                    if (i == 0x24)
                    {
                        i_1 = *edx_1;
                        if (*(edx_1 + 2) == 0x28)
                        {
                            edx_1 = (edx_1 + 2);
                            *esi = 0x24;
                            esi = &esi[1];
                            *esi = 0x28;
                            int16_t j_3 = *edx_1;
                            int16_t j_1 = j_3;
                            if (j_3 != 0xa)
                            {
                                int16_t j_2 = j_3;
                                int16_t j;
                                do
                                {
                                    j_1 = j_2;
                                    if (j_2 == 0x29)
                                    {
                                        break;
                                    }
                                    edx_1 = (edx_1 + 2);
                                    *esi = j_2;
                                    esi = &esi[1];
                                    j = *edx_1;
                                    j_2 = j;
                                    j_1 = j;
                                } while (j != 0xa);
                            }
                            if (j_1 == 0xa)
                            {
                                break;
                            }
                            i_2 = j_1;
                        }
                    }
                    if ((i != 0x24 || (i == 0x24 && *(edx_1 + 2) != 0x28)))
                    {
                        *esi = i_1;
                        esi = &esi[1];
                        edx_1 = (edx_1 + 2);
                        i_2 = *edx_1;
                    }
                    i = i_2;
                    if (i_2 == 0)
                    {
                        break;
                    }
                }
            }
            eax_2 = 0x433400;
            *esi = 0;
            *arg1 = edx_1;
            break;
        }
    }
    return eax_2;
}

int16_t* __fastcall sub_408bf0(int16_t* arg1, int32_t* arg2, int32_t* arg3)
{
    __security_cookie;
    int16_t* edi = arg1;
    int32_t var_824 = 0;
    int32_t var_820 = 0;
    char var_811 = 0;
    int32_t var_818 = 0;
    int16_t i_4;
    wcscpy_s(&i_4, 0x400, &data_4018b0);
    int32_t (* const var_830)() = feof;
    void var_80c;
    if (sub_4089a5(&var_80c, 0x3fe) == 0)
    {
        if (feof(data_422edc) != 0)
        {
            void* const var_844_2 = &data_4018a8;
            sub_4053c9(data_4226a4, 0x409);
        }
        sub_4053c9(data_4226a4, 0x41d);
    }
    int16_t* var_81c = &i_4;
    sub_408a13(&i_4);
    uint8_t* eax_7;
    while (true)
    {
        eax_7 = sub_408aa7(&var_81c);
        if (eax_7 == 0)
        {
            break;
        }
        int32_t eax_5 = sub_40abc9(0xc);
        *(eax_5 + 4) = sub_40e917(eax_7);
        int32_t* i_5 = &data_433320;
        int32_t* i_2 = data_433320;
        if (i_2 != 0)
        {
            int32_t* i;
            do
            {
                i = *i_2;
                i_5 = i_2;
                i_2 = i;
            } while (i != 0);
        }
        *i_5 = eax_5;
    }
    if (data_433320 != eax_7)
    {
        var_81c = wcsncpy_s;
        while (true)
        {
            int16_t i_3 = i_4;
            int16_t* ebx_2 = &i_4;
            int16_t i_1;
            do
            {
                ebx_2 = &ebx_2[1];
                *edi = i_3;
                edi = &edi[1];
                if (edi == *arg3)
                {
                    int32_t eax_12;
                    int32_t esi_2;
                    if (var_818 == 0)
                    {
                        esi_2 = sub_40aba4(0x1000);
                        var_818 = esi_2;
                        var_81c(esi_2, 0x800, *arg2, 0x400);
                        edi = (esi_2 + 0x800);
                        var_820 = 0x800;
                        eax_12 = (esi_2 + 0x1000);
                    }
                    else
                    {
                        int32_t esi_3 = (var_820 + 0x400);
                        int32_t eax_13;
                        if (esi_3 >= var_820)
                        {
                            eax_13 = sub_40abe7(var_818, ((var_820 << 1) + 0x800));
                            var_824 = eax_13;
                        }
                        if ((esi_3 < var_820 || (esi_3 >= var_820 && eax_13 == 0)))
                        {
                            sub_4053c9(data_4226a4, 0x419);
                            eax_13 = var_824;
                        }
                        var_818 = eax_13;
                        esi_2 = var_818;
                        edi = (eax_13 + (var_820 << 1));
                        var_820 = esi_3;
                        eax_12 = (eax_13 + (esi_3 << 1));
                    }
                    *arg3 = eax_12;
                    *arg2 = esi_2;
                }
                i_1 = *ebx_2;
                i_3 = i_1;
            } while (i_1 != 0);
            int16_t var_80e;
            if ((var_811 != i_1 && (i_4 == 0x3c && var_80e == 0x3c)))
            {
                if ((**&data_433320 != 0 && sub_4089a5(&i_4, 0x400) == 0))
                {
                    if (feof(data_422edc) != 0)
                    {
                        void* const var_844_4 = &data_4018a8;
                        sub_4053c9(data_4226a4, 0x409);
                    }
                    sub_4053c9(data_4226a4, 0x41d);
                }
                int32_t eax_19 = **&data_433320;
                data_433320 = eax_19;
                if (eax_19 == 0)
                {
                    break;
                }
                continue;
            }
            var_811 = 1;
            if (sub_4089a5(&i_4, 0x400) == 0)
            {
                if (feof(data_422edc) != 0)
                {
                    void* const var_844_6 = &data_4018a8;
                    sub_4053c9(data_4226a4, 0x409);
                }
                sub_4053c9(data_4226a4, 0x41d);
            }
        }
    }
    *edi = 0;
    CookieCheckFunction(edi);
    return edi;
}

int32_t __fastcall sub_408f07(int32_t* arg1, int16_t* arg2)
{
    __security_cookie;
    int16_t* edi = *arg1;
    int16_t* esi = edi;
    int32_t* eax_2;
    do
    {
        eax_2 = *esi;
        esi = &esi[1];
    } while (eax_2 != 0);
    int16_t* ecx_1 = arg2;
    do
    {
        eax_2 = *ecx_1;
        ecx_1 = &ecx_1[1];
    } while (eax_2 != 0);
    void* esi_3 = (((esi - &esi[1]) >> 1) + (((ecx_1 - &ecx_1[1]) >> 1) - 1));
    __alloca_probe_16((esi_3 * 2));
    int32_t __saved_edi;
    int32_t* eax_4 = &__saved_edi;
    while (true)
    {
        int16_t ecx_5 = *edi;
        if (ecx_5 == 0x3c)
        {
            if (edi[1] == 0x3c)
            {
                *eax_4 = 0;
                wcscat_s(&__saved_edi, esi_3, arg2);
                wcscat_s(&__saved_edi, esi_3, &edi[2]);
                int32_t* esi_4 = &__saved_edi;
                int16_t i;
                do
                {
                    i = *esi_4;
                    esi_4 = (esi_4 + 2);
                } while (i != 0);
                int32_t eax_6 = sub_40abe7(*arg1, ((((esi_4 - &*__saved_edi[2]) >> 1) + 1) * 2));
                *arg1 = eax_6;
                int32_t eax_7 = wcscpy_s(eax_6, (((esi_4 - &*__saved_edi[2]) >> 1) + 1), &__saved_edi);
                CookieCheckFunction(eax_7);
                return eax_7;
            }
            ecx_5 = 0x3c;
        }
        *eax_4 = ecx_5;
        edi = &edi[1];
        eax_4 = (eax_4 + 2);
    }
}

int32_t __fastcall sub_408fe4(int16_t* arg1, int16_t* arg2, char arg3)
{
    int16_t* edi = arg1;
    int16_t* var_10 = arg1;
    int16_t* esi = edi;
    uint32_t eax = *edi;
    uint32_t ecx = eax;
    int32_t eax_1;
    if (eax != 0)
    {
        uint32_t eax_2;
        do
        {
            eax_1 = iswspace(ecx);
            if (eax_1 == 0)
            {
                break;
            }
            esi = &esi[1];
            eax_2 = *esi;
            ecx = eax_2;
        } while (eax_2 != 0);
    }
    int32_t eax_4;
    if ((eax == 0 || (eax != 0 && eax_1 != 0)))
    {
        void* const eax_3 = &data_4018c0;
        if (arg3 == 0)
        {
            eax_3 = &data_40166c;
        }
        int16_t* var_24_2 = arg2;
        void* const var_28_1 = eax_3;
        eax_4 = sub_40ce84(u"\techo. %s %s\n");
    }
    if ((eax != 0 && eax_1 == 0))
    {
        int16_t* ecx_2 = arg2;
        int32_t var_18_1 = 0;
        do
        {
            eax_1 = *ecx_2;
            ecx_2 = &ecx_2[1];
        } while (eax_1 != 0);
        eax_4 = (0x3f4 - ((ecx_2 - &ecx_2[1]) >> 1));
        int32_t var_14_1 = eax_4;
        if (*edi != 0)
        {
            int32_t ecx_4;
            ecx_4 = arg3;
            arg_7 = ecx_4;
            do
            {
                wcsncpy_s(0x436670, 0x400, edi, eax_4);
                int16_t* esi_1 = &data_436670;
                int16_t i;
                do
                {
                    i = *esi_1;
                    esi_1 = &esi_1[1];
                } while (i != 0);
                int16_t* ecx_5 = edi;
                int32_t esi_3 = ((esi_1 - 0x436672) >> 1);
                do
                {
                    i = *ecx_5;
                    ecx_5 = &ecx_5[1];
                } while (i != 0);
                if (var_14_1 < ((ecx_5 - &ecx_5[1]) >> 1))
                {
                    i = data_436670;
                    int16_t* var_c_1 = &data_436670;
                    if (i != 0)
                    {
                        int32_t edi_1 = 0;
                        uint32_t i_1 = i;
                        uint32_t i_2;
                        do
                        {
                            if (iswspace(i_1) != 0)
                            {
                                esi_3 = ((edi_1 >> 1) + 1);
                            }
                            edi_1 = (edi_1 + 2);
                            int16_t* eax_7 = &var_c_1[1];
                            var_c_1 = eax_7;
                            i_2 = *eax_7;
                            i_1 = i_2;
                        } while (i_2 != 0);
                        edi = var_10;
                    }
                }
                int32_t esi_6 = (esi_3 * 2);
                if (esi_6 >= 0x800)
                {
                    ___report_rangecheckfailure();
                    breakpoint();
                }
                *(esi_6 + 0x436670) = 0;
                void* const eax_8 = &data_4018c0;
                if (arg_7 == 0)
                {
                    eax_8 = &data_40166c;
                }
                int16_t* var_24_5 = arg2;
                void* const var_28_3 = eax_8;
                int32_t var_2c_1 = 0x436670;
                sub_40ce84(u"\techo %s %s %s\n");
                edi = (edi + esi_6);
                arg_7 = 1;
                var_10 = edi;
                eax_4 = var_14_1;
            } while (*edi != 0);
        }
    }
    return eax_4;
}

int32_t __fastcall sub_409155(FILE* arg1, int16_t* arg2, int32_t* arg3, char arg4, char arg5)
{
    int32_t* edi = arg3;
    int16_t* esi = arg2;
    int16_t* var_10 = esi;
    wchar16* eax = wcsstr(*edi, &data_4018b0);
    char var_5 = 0;
    int32_t var_18;
    if ((eax != 0 && (eax == *edi || (eax != *edi && eax[-1] == 0xa))))
    {
        wchar16* eax_1 = wcschr(&eax[2], 0xa);
        if (eax_1 != 0)
        {
            *eax_1 = 0;
        }
        int32_t eax_2 = sub_40e917(&eax[2]);
        var_18 = eax_2;
        if (eax_1 != 0)
        {
            *eax_1 = 0xa;
        }
        int32_t var_14 = 0;
        int32_t i = wcstok_s(eax_2, &data_40193c, &var_14);
        if (i != 0)
        {
            char* edi_1 = arg5;
            do
            {
                if (_wcsicmp(i, u"keep") == 0)
                {
                    *edi_1 = 1;
                }
                else
                {
                    int32_t eax_5 = _wcsicmp(i, u"nokeep");
                    if (eax_5 == 0)
                    {
                        *edi_1 = eax_5;
                    }
                    else if (_wcsicmp(i, u"unicode") != 0)
                    {
                        sub_4053c9(data_4226a4, 0x446);
                    }
                    else
                    {
                        var_5 = 1;
                    }
                }
                i = wcstok_s(0, &data_40193c, &var_14);
            } while (i != 0);
            edi = arg3;
        }
        free(var_18);
        if (var_5 != 0)
        {
            fwrite(&data_401938, 2, 1, arg1);
        }
        esi = var_10;
    }
    int32_t i_1 = wcsncmp(*edi, &data_4018b0, 2);
    if (i_1 != 0)
    {
        arg5 = 0;
        do
        {
            i_1 = wcschr(*edi, 0xa);
            if (i_1 == 0)
            {
                return i_1;
            }
            if (arg4 != 0)
            {
                int16_t* ecx_8 = *edi;
                *i_1 = 0;
                sub_408fe4(ecx_8, esi, arg5);
                *i_1 = 0xa;
            }
            char* esi_2 = *edi;
            if (var_5 != 0)
            {
                fwrite(esi_2, ((i_1 - esi_2) >> 1), 2, arg1);
                fwrite(&data_401934, 4, 1, arg1);
            }
            else
            {
                if (esi_2 < i_1)
                {
                    do
                    {
                        uint32_t _ElementSize = WideCharToMultiByte(0, 0, esi_2, 1, &var_18, 4, nullptr, nullptr);
                        if (_ElementSize != 0)
                        {
                            fwrite(&var_18, _ElementSize, 1, arg1);
                        }
                        esi_2 = &esi_2[2];
                    } while (esi_2 < i_1);
                    edi = arg3;
                }
                fwrite(&data_401930, 2, 1, arg1);
            }
            arg5 = 1;
            *edi = (i_1 + 2);
            i_1 = wcsncmp((i_1 + 2), &data_4018b0, 2);
            esi = var_10;
        } while (i_1 != 0);
    }
    *edi = (*edi + 4);
    return i_1;
}

int32_t __fastcall sub_409379(uint8_t* arg1, int32_t* arg2, int32_t** arg3, char arg4)
{
    __security_cookie;
    int32_t** str_2 = arg3;
    int32_t* edi = arg2;
    int32_t* var_438 = edi;
    wchar16* eax_3;
    int32_t* edx;
    eax_3 = wcschr(arg1, 0xa);
    int32_t i;
    if (eax_3 == 0)
    {
        *edi = sub_40e917(arg1);
        i = 0;
    }
    else
    {
        int32_t** str_4 = str_2;
        edx = 0xff;
        *eax_3 = 0;
        int32_t eax_4;
        int32_t* edx_1;
        eax_4 = sub_40f30f(arg1, edx, str_4);
        *edi = eax_4;
        *eax_3 = 0xa;
        int32_t eax_5 = *edi;
        if (eax_5 == arg1)
        {
            eax_5 = sub_40e917(arg1);
            *edi = eax_5;
        }
        int32_t** str_5 = str_2;
        edx_1 = 0xff;
        int32_t var_430 = eax_5;
        int32_t str_7 = sub_40f30f(&eax_3[1], edx_1, str_5);
        str_2 = str_7;
        i = sub_408aa7(&var_430);
        if (i != 0)
        {
            int32_t var_43c_1 = 0;
            do
            {
                char var_41d = 0;
                int32_t esi_1 = sub_40e917(i);
                int32_t var_42c_1 = esi_1;
                int32_t _Stream;
                if (*esi_1 != 0)
                {
                    int32_t _Stream_2 = sub_410653(esi_1, &data_4018b8);
                    _Stream = _Stream_2;
                    if (_Stream_2 == 0)
                    {
                        int32_t var_450_6 = esi_1;
                        sub_4053c9(data_4226a4, 0x41e);
                    }
                    else
                    {
                        wchar16* edx_3 = wcschr(*edi, 0x3c);
                        void* str = &edx_3[1];
                        if (*str != 0x3c)
                        {
                            do
                            {
                                edx_3 = wcschr(str, 0x3c);
                                str = &edx_3[1];
                            } while (*str != 0x3c);
                            edi = var_438;
                        }
                        int16_t* ecx_11 = &edx_3[2];
                        var_430 = &ecx_11[1];
                        int32_t eax_15;
                        do
                        {
                            eax_15 = *ecx_11;
                            ecx_11 = &ecx_11[1];
                        } while (eax_15 != 0);
                        memmove(edx_3, &edx_3[2], ((((ecx_11 - var_430) >> 1) << 1) + 2));
                        esi_1 = var_42c_1;
                    }
                }
                else
                {
                    int32_t var_434 = 0;
                    int16_t var_214;
                    int32_t eax_8 = _wgetenv_s(&var_434, &var_214, 0x103, &data_401694);
                    if ((eax_8 != 0 || (eax_8 == 0 && var_434 == eax_8)))
                    {
                        wcscpy_s(&var_214, 0x103, &data_40169c);
                    }
                    _Stream = 0;
                    void lpTempFileName;
                    int32_t _Stream_1;
                    if (GetTempFileNameW(&var_214, &data_4016a0, 0, &lpTempFileName) == 0)
                    {
                        _Stream_1 = _Stream;
                    }
                    else
                    {
                        wcscpy_s(&var_214, 0x103, &lpTempFileName);
                        _Stream_1 = _wfsopen(&var_214, &data_4018b8, 0x20);
                        _Stream = _Stream_1;
                    }
                    if (_Stream_1 == 0)
                    {
                        int16_t* var_450_3 = &var_214;
                        sub_4053c9(data_4226a4, 0x41e);
                    }
                    if ((wcschr(&var_214, 0x20) != 0 && wcschr(&var_214, 0x22) == 0))
                    {
                        int16_t* edi_1 = &var_214;
                        wchar16* eax_11;
                        do
                        {
                            eax_11 = *edi_1;
                            edi_1 = &edi_1[1];
                        } while (eax_11 != 0);
                        void var_212;
                        int32_t edi_3 = ((edi_1 - &var_212) >> 1);
                        uint32_t esi_2 = (edi_3 * 2);
                        memmove(&var_212, &var_214, esi_2);
                        var_214 = 0x22;
                        *(&var_212 + esi_2) = 0x22;
                        if (((edi_3 << 1) + 4) >= 0x206)
                        {
                            ___report_rangecheckfailure();
                            breakpoint();
                        }
                        esi_1 = var_42c_1;
                        *(&var_214 + ((edi_3 << 1) + 4)) = 0;
                        edi = var_438;
                    }
                    sub_408f07(edi, &var_214);
                    free(esi_1);
                    esi_1 = sub_40e917(&var_214);
                    var_42c_1 = esi_1;
                }
                var_430 = *edi;
                sub_409155(_Stream, esi_1, &str_2, arg4, &var_41d);
                int32_t** str_1 = str_2;
                wchar16* eax_18 = wcschr(str_1, 0xa);
                void* str_6;
                if (eax_18 != 0)
                {
                    str_6 = &eax_18[1];
                }
                else
                {
                    int16_t* str_3 = str_1;
                    do
                    {
                        eax_18 = *str_3;
                        str_3 = &str_3[1];
                    } while (eax_18 != 0);
                    str_6 = (str_1 + (((str_3 - &str_3[1]) >> 1) << 1));
                }
                str_2 = str_6;
                fclose(_Stream);
                if (var_41d == 0)
                {
                    int32_t* eax_19 = sub_40e8c5();
                    eax_19[1] = sub_40e917(var_42c_1);
                    sub_40ea1c(&data_4333f4, eax_19);
                }
                free(var_42c_1);
                i = sub_408aa7(&var_430);
            } while (i != 0);
        }
        if (str_7 != &eax_3[1])
        {
            free(str_7);
        }
        i = 1;
    }
    CookieCheckFunction(i);
    return i;
}

int32_t __fastcall sub_409772(int32_t arg1)
{
    if (fclose(data_422edc) == 0xffff)
    {
        int32_t var_8_1 = data_422ee4;
        sub_4053c9(0, 0x424);
    }
    free(data_422ee4, arg1);
    int32_t eax_2 = (data_433324 - 1);
    void* ecx_1 = (eax_2 * 0xc);
    data_433324 = eax_2;
    data_422edc = *(ecx_1 + 0x433338);
    data_422ee4 = *(ecx_1 + 0x433334);
    int32_t eax_5 = *(ecx_1 + 0x433330);
    data_4226a4 = eax_5;
    return eax_5;
}

uint32_t __fastcall sub_4097da(int32_t arg1)
{
    char ebx = arg1;
    while (true)
    {
        data_412021 = 0;
        while (true)
        {
            int16_t eax_1;
            if (ebx == 0)
            {
                eax_1 = sub_407ee6(arg1);
            }
            else
            {
                eax_1 = getwc(data_422edc, nullptr);
            }
            uint32_t eax_4 = eax_1;
            arg1 = 0xffff;
            if (eax_4 != 0xffff)
            {
                if (eax_4 != 0xa)
                {
                    continue;
                }
                else
                {
                    data_412021 = 1;
                    int16_t eax_2;
                    if (ebx == 0)
                    {
                        eax_2 = sub_407ee6(0xffff);
                    }
                    else
                    {
                        int32_t var_8_2 = data_422edc;
                        eax_2 = getwc(var_8_2, nullptr);
                        arg1 = var_8_2;
                    }
                    uint32_t eax_3 = eax_2;
                    if ((eax_3 == 0x3b && data_422ee1 != 0))
                    {
                        break;
                    }
                    if (eax_3 == 0x23)
                    {
                        break;
                    }
                    eax_4 = ungetwc(eax_3, data_422edc, nullptr);
                }
            }
            return eax_4;
        }
        data_4226a4 = (data_4226a4 + 1);
    }
}

uint32_t __fastcall sub_40985f(int32_t arg1)
{
    int32_t var_4 = arg1;
    int32_t esi;
    esi = arg1;
    if ((esi == 0xa || esi == 0xffff))
    {
        sub_4053c9(data_4226a4, 0x407);
    }
    int32_t var_10 = data_422edc;
    data_4226c0 = esi;
    if (fgetws(0x4226c2, 0x3ff, var_10) == 0)
    {
        if (feof(data_422edc) != 0)
        {
            void* const var_10_2 = &data_4018a8;
            sub_4053c9(data_4226a4, 0x409);
        }
        sub_4053c9(data_4226a4, 0x41d);
    }
    int16_t* ecx_3 = &data_4226c0;
    int16_t* edx = &data_4226c0;
    int32_t eax;
    do
    {
        eax = *edx;
        edx = &edx[1];
    } while (eax != 0);
    if (*((((edx - 0x4226c2) >> 1) << 1) + &*(data_4226bc + 2)) == 0xa)
    {
        if (((((edx - 0x4226c2) >> 1) << 1) + 0xfffffffe) >= 0x800)
        {
            ___report_rangecheckfailure();
            breakpoint();
        }
        *((((edx - 0x4226c2) >> 1) << 1) + &*(data_4226bc + 2)) = 0;
    }
    while (true)
    {
        uint32_t eax_2 = *ecx_3;
        if ((eax_2 != 0x20 && eax_2 != 9))
        {
            return sub_40a593(ecx_3);
        }
        ecx_3 = &ecx_3[1];
    }
}

int32_t __fastcall sub_409943(uint32_t arg1, void* arg2, int32_t arg3)
{
    uint32_t var_c = arg1;
    void* edi = arg2;
    arg2 = data_412021;
    int32_t eax_4;
    while (true)
    {
        uint32_t eax_1 = arg1;
        char ebx;
        if (eax_1 != 0xa)
        {
            if (eax_1 == 0x3a)
            {
                data_412021 = 0;
                arg1 = sub_407ee6(arg1);
                if (arg1 == 0x3a)
                {
                    *edi = 0x3a;
                    *(edi + 2) = 0;
                    eax_4 = 0x15;
                    break;
                }
                ebx = 0x14;
                goto label_409a69;
            }
            if (eax_1 == 0x3b)
            {
                eax_4 = 0x13;
            label_409b50:
                data_412021 = 0;
                break;
            }
            if (eax_1 == 0x3d)
            {
                eax_4 = 0x16;
                goto label_409b50;
            }
            if ((((eax_1 == 0x5b && data_422ee1 == 0) || eax_1 == 0x5e) || ((eax_1 == 0x5b && data_422ee1 != 0) && arg2 == 0)))
            {
                ungetwc(arg1, data_422edc);
                edi = (edi - 2);
            label_409aa0:
                sub_40a2f1((edi - 2), arg3);
                uint32_t esi_1;
                if (data_412021 != 0)
                {
                    eax_4 = _wcsicmp(0x4226c0, u"include");
                    if (eax_4 == 0)
                    {
                        data_412021 = eax_4;
                        esi_1 = sub_409c05(&data_401900);
                        if ((esi_1 == 0x3a || esi_1 == 0x3d))
                        {
                            ungetwc(esi_1, data_422edc);
                        }
                        if ((esi_1 != 0x3a && esi_1 != 0x3d))
                        {
                            if (data_422ee1 != 0)
                            {
                                void* var_1c_4 = edi;
                                sub_4053c9(data_4226a4, 0x409);
                            }
                            eax_4 = sub_40985f(esi_1);
                        }
                    }
                }
                if ((data_412021 == 0 || (data_412021 != 0 && eax_4 != 0)))
                {
                    data_412021 = 0;
                }
                if (((data_412021 == 0 || (data_412021 != 0 && eax_4 != 0)) || ((data_412021 != 0 && eax_4 == 0) && (esi_1 == 0x3a || esi_1 == 0x3d))))
                {
                    eax_4 = 0x10;
                }
                break;
            }
            if (eax_1 == 0xffff)
            {
                uint32_t var_1c_1 = data_422edc;
                eax_4 = feof(var_1c_1);
                arg1 = var_1c_1;
                if (eax_4 == 0)
                {
                    sub_4053c9(data_4226a4, 0x40e);
                    arg1 = 0x40e;
                }
                if (data_433324 != 0)
                {
                    sub_409772(arg1);
                }
            }
            if ((((eax_1 == 0x5b && data_422ee1 != 0) && arg2 != 0) || ((eax_1 == 0xffff && data_433324 == 0) && data_412024 < 0)))
            {
                eax_4 = 0x17;
                break;
            }
            if (((eax_1 == 0xffff && data_433324 == 0) && data_412024 >= 0))
            {
                sub_4053c9(data_4226a4, 0x3fc);
                arg1 = 0x3fc;
            }
            if (((eax_1 != 0x5b && eax_1 != 0x5e) && eax_1 != 0xffff))
            {
                goto label_409aa0;
            }
        }
        data_4226a4 = (data_4226a4 + 1);
        data_412021 = 1;
        eax_4 = sub_407ee6(arg1);
        arg1 = eax_4;
        if (((arg1 == 0x3b && data_422ee1 != 0) || ((arg1 != 0x3b || (arg1 == 0x3b && data_422ee1 == 0)) && arg1 == 0x23)))
        {
            arg1 = 0;
            int32_t ecx = sub_4097da(arg1);
            data_4226a4 = (data_4226a4 + 1);
            data_412021 = 1;
            eax_4 = sub_407ee6(ecx);
            arg1 = eax_4;
        }
        if ((arg1 != 0x20 && arg1 != 9))
        {
            arg2 = 1;
            data_412021 = 1;
            if (arg1 == 0xffff)
            {
                continue;
            }
            else
            {
                ebx = 0x11;
            }
        label_409a69:
            ungetwc(arg1, data_422edc);
            eax_4 = ebx;
            break;
        }
        eax_4 = 0x12;
        goto label_409b50;
    }
    return eax_4;
}

int32_t __fastcall sub_409b60(int32_t arg1, char arg2)
{
    uint32_t ecx;
    void* edx;
    if (data_422ee2 != 0)
    {
        data_4226a4 = (data_4226a4 + 1);
        data_422ee2 = 0;
        uint32_t eax_1 = sub_407ee6(arg1);
        if ((eax_1 == 0x20 || eax_1 == 9))
        {
            data_412021 = 0;
            eax_1 = 0x12;
            return eax_1;
        }
        if ((eax_1 != 0x20 && eax_1 != 9))
        {
            ecx = 0xffff;
            data_412021 = 1;
            if (eax_1 != 0xffff)
            {
                ungetwc(eax_1, data_422edc, nullptr);
                int32_t eax_3;
                eax_3 = 0x11;
                return eax_3;
            }
            edx = &data_4226c0;
        }
    }
    else
    {
        if ((arg2 == 0x18 || arg2 == 0x19))
        {
            int32_t var_8_1 = 0x422ec0;
            arg1 = arg2;
            sub_409d93(arg1);
            int32_t eax_5;
            eax_5 = arg2;
            return eax_5;
        }
        if ((arg2 != 0x18 && arg2 != 0x19))
        {
            arg1 = 0;
            ecx = sub_409c05(arg1);
            edx = &data_4226c2;
            data_4226c0 = ecx;
            data_4226c2 = 0;
        }
    }
    return sub_409943(ecx, edx, 0x422ec0);
}

uint32_t __fastcall sub_409c05(int32_t arg1)
{
    char ebx = arg1;
    uint32_t eax_2;
    while (true)
    {
        int16_t eax_1;
        if (ebx == 0)
        {
            eax_1 = sub_407ee6(arg1);
        }
        else
        {
            eax_1 = getwc(data_422edc);
        }
        eax_2 = eax_1;
        int32_t ecx_1 = 0x20;
        if (eax_2 != 0x20)
        {
            ecx_1 = 9;
        }
        if (((eax_2 == 0x20 || eax_2 == 9) || eax_2 == 0x5e))
        {
            if (eax_2 == 0x5e)
            {
                int16_t eax_3;
                if (ebx == 0)
                {
                    eax_3 = sub_407ee6(ecx_1);
                }
                else
                {
                    eax_3 = getwc(data_422edc);
                }
                eax_2 = eax_3;
                if ((eax_2 != 0x20 && eax_2 != 9))
                {
                    ungetwc(eax_2, data_422edc);
                    eax_2 = 0x5e;
                    break;
                }
            }
            data_412021 = 0;
        }
        if (eax_2 == 0x5c)
        {
            eax_2 = sub_409ce2(0x5c, ebx);
        }
        arg1 = 0x20;
        if (eax_2 != 0x20)
        {
            arg1 = 9;
            if (eax_2 != 9)
            {
                break;
            }
        }
    }
    if (eax_2 == 0x3b)
    {
        if (data_412021 == 0)
        {
            goto label_409ce1;
        }
        if (data_422ee1 != 0)
        {
            goto label_409cce;
        }
    }
    if (eax_2 != 0x23)
    {
        goto label_409ce1;
    }
label_409cce:
    arg1 = ebx;
    sub_4097da(arg1);
    eax_2 = 0xa;
    data_412021 = 1;
label_409ce1:
    return eax_2;
}

int32_t __fastcall sub_409ce2(uint32_t arg1, char arg2)
{
    int32_t eax;
    uint32_t eax_2;
    if (arg1 == 0x5c)
    {
        do
        {
            int16_t eax_1;
            int32_t ecx;
            if (arg2 == 0)
            {
                eax_1 = sub_407ee6(arg1);
            }
            else
            {
                int32_t var_10_1 = data_422edc;
                eax_1 = getwc(var_10_1);
                ecx = var_10_1;
            }
            eax_2 = eax_1;
            if (eax_2 != 0xa)
            {
                break;
            }
            data_4226a4 = (data_4226a4 + 1);
            data_412021 = 1;
            if (arg2 == 0)
            {
                eax = sub_407ee6(ecx);
            }
            else
            {
                eax = getwc(data_422edc);
            }
            arg1 = eax;
            if (((arg1 == 0x3b && data_422ee1 != 0) || ((arg1 != 0x3b || (arg1 == 0x3b && data_422ee1 == 0)) && arg1 == 0x23)))
            {
                arg1 = arg2;
                int32_t ecx_2 = sub_4097da(arg1);
                data_4226a4 = (data_4226a4 + 1);
                if (arg2 == 0)
                {
                    eax = sub_407ee6(ecx_2);
                }
                else
                {
                    eax = getwc(data_422edc);
                }
                arg1 = eax;
            }
        } while (arg1 == 0x5c);
    }
    if ((arg1 != 0x5c || (arg1 == 0x5c && eax_2 == 0xa)))
    {
        eax = arg1;
    }
    if ((arg1 == 0x5c && eax_2 != 0xa))
    {
        ungetwc(eax_2, data_422edc);
        eax = 0x5c;
    }
    return eax;
}

int32_t __fastcall sub_409d93(int32_t arg1)
{
    int32_t var_18 = 0;
    int16_t ebx;
    ebx = arg1;
    uint32_t i_1 = 0;
    uint32_t i = 0x4226c0;
    char var_5 = ebx;
    char var_6 = 0;
    uint8_t* var_14 = &data_4226c0;
    uint32_t i_2 = sub_407ee6(arg1);
    int32_t ecx = 0x5e;
    if (ebx == 0x18)
    {
        *ebx[1] = 2;
    }
    else
    {
        uint32_t eax_2;
        if (i_2 == 0x5e)
        {
            eax_2 = sub_407ee6(0x5e);
        }
        if ((((i_2 == 0x20 || i_2 == 9) || (i_2 == 0x5e && eax_2 == 0x20)) || (i_2 == 0x5e && eax_2 == 9)))
        {
            ecx = 0;
            *ebx[1] = 2;
            int16_t i_4 = sub_409c05(ecx);
            ecx = 0x5e;
            i_2 = i_4;
        }
        if (((i_2 == 0x5e && eax_2 != 0x20) && eax_2 != 9))
        {
            ungetwc(eax_2, data_422edc);
            ecx = 0x5e;
            i_2 = 0x5e;
        }
        if ((((i_2 == 0x5e && eax_2 != 0x20) && eax_2 != 9) || ((i_2 != 0x20 && i_2 != 9) && i_2 != 0x5e)))
        {
            *ebx[1] = 1;
        }
    }
    uint32_t var_c = arg_4;
    while (true)
    {
        uint32_t eax_3;
        if (i_2 != 0x22)
        {
            eax_3 = var_6;
        }
        else
        {
            eax_3 = var_6 == 0;
            var_6 = eax_3;
        }
        if (i_2 != 0x5e)
        {
            goto label_409f96;
        }
        if ((eax_3 == 0 && ebx == 0x19))
        {
            int16_t i_5;
            i_5 = sub_407ee6(0x5e);
            i_2 = i_5;
            uint32_t eax_4 = i_2;
            if (eax_4 > 0x2d)
            {
                if (eax_4 == 0x40)
                {
                label_409ec5:
                    *i = 0x5e;
                    i = (i + 2);
                    if (i == var_c)
                    {
                        int32_t ecx_1 = data_4226ac;
                        uint32_t eax_14;
                        if (ecx_1 == 0)
                        {
                            int32_t eax_12 = sub_40aba4(0x1000);
                            uint8_t* var_30_2 = var_14;
                            data_4226ac = eax_12;
                            wcsncpy_s(eax_12, 0x800, var_30_2, 0x400);
                            int32_t eax_13 = data_4226ac;
                            i_1 = 0x800;
                            i = (eax_13 + 0x800);
                            eax_14 = (eax_13 + 0x1000);
                        }
                        else
                        {
                            uint32_t i_3 = (i_1 + 0x400);
                            int32_t eax_15;
                            if (i_3 >= i_1)
                            {
                                eax_15 = sub_40abe7(ecx_1, (i_3 * 2));
                                var_18 = eax_15;
                            }
                            if ((i_3 < i_1 || (i_3 >= i_1 && eax_15 == 0)))
                            {
                                sub_4053c9(data_4226a4, 0x419);
                                eax_15 = var_18;
                            }
                            data_4226ac = eax_15;
                            i = (eax_15 + (i_1 << 1));
                            i_1 = i_3;
                            eax_14 = (eax_15 + (i_3 << 1));
                        }
                        var_c = eax_14;
                        arg_4 = eax_14;
                        var_14 = data_4226ac;
                    }
                    goto label_409f70;
                }
                if (eax_4 == 0x5c)
                {
                    goto label_409f70;
                }
                if (eax_4 == 0x5e)
                {
                    goto label_409ec5;
                }
                if (eax_4 == 0x7b)
                {
                    goto label_409ec5;
                }
                if (eax_4 != 0x7d)
                {
                    goto label_409f96;
                }
                goto label_409ec5;
            }
            if (eax_4 == 0x2d)
            {
                goto label_409ec5;
            }
            if (eax_4 == 0xa)
            {
                goto label_409f70;
            }
            if (eax_4 == 0x21)
            {
                goto label_409ec5;
            }
            if (eax_4 <= 0x21)
            {
                goto label_409f96;
            }
            if (eax_4 <= 0x23)
            {
                goto label_409f70;
            }
            if (eax_4 == 0x24)
            {
                goto label_409ec5;
            }
            if (eax_4 <= 0x27)
            {
                goto label_409f96;
            }
            if (eax_4 > 0x29)
            {
                goto label_409f96;
            }
            goto label_409ec5;
        }
        int16_t eax_17 = sub_407ee6(0x5e);
        int32_t var_2c_2 = data_422edc;
        ungetwc(eax_17, var_2c_2);
        ecx = var_2c_2;
        i_2 = 0x5e;
    label_409f96:
        uint32_t eax_19 = i_2;
        char edx_1;
        if (eax_19 == 0x3b)
        {
            if (*ebx[1] != 0)
            {
            label_409f70:
                edx_1 = 0;
                goto label_40a086;
            }
            if (data_422ee1 == *ebx[1])
            {
                goto label_409f70;
            }
        label_40a034:
            ecx = 0;
            var_6 = 0;
            ecx = sub_4097da(ecx);
            data_4226a4 = (data_4226a4 + 1);
        }
        if ((eax_19 <= 0x3b && eax_19 != 0x3b))
        {
            if (eax_19 > 0x24)
            {
                if (eax_19 == 0x28)
                {
                    edx_1 = 8;
                    goto label_40a086;
                }
                if (eax_19 == 0x29)
                {
                    edx_1 = 9;
                    goto label_40a086;
                }
                if (eax_19 == 0x2a)
                {
                    edx_1 = 0xb;
                    goto label_40a086;
                }
                if (eax_19 != 0x3a)
                {
                    goto label_40a1b9;
                }
                edx_1 = 4;
                goto label_40a086;
            }
            if (eax_19 == 0x24)
            {
                edx_1 = 7;
                goto label_40a086;
            }
            ecx = 9;
            if (eax_19 == 9)
            {
            label_409fe7:
                edx_1 = 5;
                goto label_40a086;
            }
            if (eax_19 == 0xa)
            {
                goto label_40a1cc;
            }
            if (eax_19 == 0x20)
            {
                goto label_409fe7;
            }
            if (eax_19 != 0x23)
            {
                goto label_40a1b9;
            }
            if (*ebx[1] == 0)
            {
                goto label_40a034;
            }
            if (ebx == 0x19)
            {
                break;
            }
            *ebx[1] = *((*ebx[1] * 0xe) + 0x4013a1);
        }
        if (eax_19 > 0x3b)
        {
            uint32_t eax_31;
            if (eax_19 <= 0x44)
            {
                if (eax_19 == 0x44)
                {
                    goto label_40a081;
                }
                if (eax_19 == 0x3c)
                {
                label_40a132:
                    ebx = 0xc;
                    edx_1 = 0xc;
                    if (var_5 != 0x18)
                    {
                        goto label_40a086;
                    }
                    if (i_2 != 0x3c)
                    {
                        goto label_40a086;
                    }
                    uint32_t eax_40 = sub_407ee6(ecx);
                    if (eax_40 != 0x3c)
                    {
                        ungetwc(eax_40, data_422edc);
                    }
                    else
                    {
                        i = sub_408bf0(i, &var_14, &arg_4);
                        ebx = 6;
                        uint32_t eax_42 = arg_4;
                        data_4226a4 = (data_4226a4 - 1);
                        i_2 = 0xa;
                        var_c = eax_42;
                    }
                    ecx = (*ebx[1] * 0xe);
                    eax_31 = ebx;
                    goto label_40a08c;
                }
                if (eax_19 == 0x3d)
                {
                    edx_1 = 2;
                    goto label_40a086;
                }
                if (eax_19 <= 0x3e)
                {
                    goto label_40a1b9;
                }
                if (eax_19 <= 0x40)
                {
                    goto label_40a132;
                }
                if (eax_19 == 0x42)
                {
                    goto label_40a081;
                }
                goto label_40a1b9;
            }
            if (eax_19 != 0x46)
            {
                if (eax_19 == 0x52)
                {
                    goto label_40a081;
                }
                if (eax_19 == 0x5c)
                {
                    edx_1 = 3;
                    goto label_40a086;
                }
                if (eax_19 == 0xffff)
                {
                label_40a1cc:
                    edx_1 = 6;
                    goto label_40a086;
                }
            label_40a1b9:
                char eax_44 = sub_4038ca(i_2);
                edx_1 = (-eax_44);
                edx_1 = ((edx_1 - edx_1) & 0xa);
                goto label_40a086;
            }
        label_40a081:
            edx_1 = 0xd;
        label_40a086:
            ecx = (*ebx[1] * 0xe);
            eax_31 = edx_1;
        label_40a08c:
            *ebx[1] = *((ecx + eax_31) + 0x4013a0);
        }
        if ((eax_19 > 0x3b || (eax_19 <= 0x3b && eax_19 != 0x3b)))
        {
            if (*ebx[1] == 0x40)
            {
                break;
            }
            if ((*ebx[1] & 0x20) != 0)
            {
                uint32_t var_2c_3 = i_2;
                ecx = sub_4053c9(data_4226a4, ((*ebx[1] & 0xffffffdf) + 0x3e8));
            }
            if (*ebx[1] == 0)
            {
                data_4226a4 = (data_4226a4 + 1);
                *(i - 2) = 0x20;
                data_412021 = 1;
                int16_t eax_36;
                int32_t ecx_4;
                eax_36 = sub_407ee6(ecx);
                uint32_t eax_37 = eax_36;
                data_412021 = *ebx[1];
                if ((eax_37 == 0x20 || eax_37 == 9))
                {
                    *ebx[1] = 2;
                    while (true)
                    {
                        int16_t eax_38;
                        eax_38 = sub_407ee6(ecx_4);
                        eax_37 = eax_38;
                        if (eax_37 == 0x20)
                        {
                            continue;
                        }
                        if ((eax_37 != 0x20 && eax_37 != 9))
                        {
                            break;
                        }
                        if (eax_37 != 9)
                        {
                            /* nop */
                        }
                    }
                }
                int32_t var_2c_4 = data_422edc;
                ungetwc(eax_37, var_2c_4);
                ecx = var_2c_4;
            }
            else
            {
                *i = i_2;
                i = (i + 2);
                if (i == var_c)
                {
                    uint32_t eax_47;
                    if (data_4226ac == 0)
                    {
                        int32_t eax_45 = sub_40aba4(0x1000);
                        uint8_t* var_30_8 = var_14;
                        data_4226ac = eax_45;
                        ecx = wcsncpy_s(eax_45, 0x800, var_30_8, 0x400);
                        int32_t eax_46 = data_4226ac;
                        i_1 = 0x800;
                        i = (eax_46 + 0x800);
                        eax_47 = (eax_46 + 0x1000);
                    }
                    else
                    {
                        i = i_1;
                        i_2 = (i + 0x400);
                        if (i_2 >= i)
                        {
                            ecx = sub_40abe7(data_4226ac, (i_2 * 2));
                            var_18 = ecx;
                            if (ecx != 0)
                            {
                                data_4226ac = ecx;
                                i_1 = i_2;
                                i = (ecx + (i << 1));
                                eax_47 = (ecx + (i_2 << 1));
                            }
                        }
                        if ((i_2 < i || (i_2 >= i && ecx == 0)))
                        {
                            sub_4053c9(data_4226a4, 0x419);
                            break;
                        }
                    }
                    arg_4 = eax_47;
                    var_c = eax_47;
                }
            }
            ebx = var_5;
        }
        i_2 = sub_407ee6(ecx);
        ecx = 0x5e;
    }
    ungetwc(i_2, data_422edc);
    uint8_t* ebx_1;
    for (ebx_1 = var_14; i > ebx_1; i = (i - 2))
    {
        if (iswspace(*(i - 2)) == 0)
        {
            break;
        }
    }
    int32_t ecx_12 = data_4226ac;
    *i = 0;
    int32_t eax_52;
    if (ecx_12 == 0)
    {
        eax_52 = sub_40e917(ebx_1);
    }
    else
    {
        eax_52 = sub_40abe7(ecx_12, ((((i - ecx_12) >> 1) << 1) + 2));
    }
    if ((ecx_12 == 0 || (ecx_12 != 0 && eax_52 != 0)))
    {
        data_4226ac = eax_52;
    }
    return eax_52;
}

int16_t* __fastcall sub_40a2f1(int16_t* arg1, int32_t arg2)
{
    int16_t* eax = arg1;
    int16_t ebx;
    *ebx[1] = 0;
    void* edi = &eax[1];
    char var_5 = nullptr;
    uint32_t eax_1 = *eax;
    void* var_c = edi;
    if (eax_1 == 0x22)
    {
        var_5 = 1;
        ebx = 0x10;
    }
    else if (eax_1 == 0x24)
    {
        ebx = 2;
    }
    else if (eax_1 == 0x7b)
    {
        ebx = 8;
    }
    else
    {
        ebx = 0;
    }
    uint32_t esi_1;
    while (true)
    {
        int16_t eax_6;
        int32_t ecx;
        eax_6 = sub_407ee6(arg1);
        esi_1 = eax_6;
        char edx;
        if (esi_1 == 0x5e)
        {
            esi_1 = sub_407ee6(ecx);
            if (esi_1 <= 0x5c)
            {
                if (esi_1 == 0x5c)
                {
                    goto label_40a3d1;
                }
                if (esi_1 == 0xa)
                {
                    goto label_40a3d1;
                }
                if (esi_1 == 0x23)
                {
                    goto label_40a3d1;
                }
                if (esi_1 == 0x24)
                {
                    goto label_40a3c8;
                }
                if (esi_1 <= 0x27)
                {
                    goto label_40a36e;
                }
                if (esi_1 > 0x29)
                {
                    goto label_40a36e;
                }
                goto label_40a3c8;
            }
            if (esi_1 != 0x5e)
            {
                if (esi_1 == 0x7b)
                {
                    goto label_40a3c8;
                }
                if (esi_1 != 0x7d)
                {
                    goto label_40a36e;
                }
                goto label_40a3c8;
            }
        label_40a3c8:
            *edi = 0x5e;
            edi = (edi + 2);
            var_c = edi;
        label_40a3d1:
            edx = 0;
        }
        else
        {
        label_40a36e:
            uint32_t eax_9 = esi_1;
            switch (eax_9)
            {
                case 9:
                {
                label_40a403:
                    edx = ((var_5 != 0 - 1) & 5);
                    break;
                }
                case 0xa:
                {
                label_40a471:
                    edx = 6;
                    break;
                }
                case 0x20:
                {
                    goto label_40a403;
                }
                case 0x22:
                {
                    edx = 0xe;
                    if (ebx == 0x12)
                    {
                        var_5 = 1;
                    }
                    break;
                }
                case 0x23:
                {
                    edx = 1;
                    break;
                }
                case 0x24:
                {
                    edx = 7;
                    break;
                }
                case 0x29:
                {
                    edx = 9;
                    break;
                }
                case 0x3a:
                {
                    edx = 4;
                    break;
                }
                case 0x3b:
                {
                    edx = 3;
                    break;
                }
                case 0x3d:
                {
                    edx = 2;
                    break;
                }
                case 0x5c:
                {
                    edx = 0xd;
                    break;
                }
                case 0x7b:
                {
                    edx = 0xb;
                    break;
                }
                case 0x7d:
                {
                    edx = 0xc;
                    break;
                }
            }
            if ((((((((eax_9 > 0x29 && eax_9 != 0x3a) && eax_9 != 0x3b) && eax_9 != 0x3d) && eax_9 != 0x5c) && eax_9 != 0x7b) && eax_9 != 0x7d) && eax_9 == 0xffff))
            {
                goto label_40a471;
            }
            if (eax_9 == 0x28)
            {
                edx = 8;
            }
            if ((((((((((eax_9 <= 0x29 && eax_9 != 0x29) && eax_9 != 9) && eax_9 != 0xa) && eax_9 != 0x20) && eax_9 != 0x22) && eax_9 != 0x23) && eax_9 != 0x24) && eax_9 != 0x28) || ((((((eax_9 > 0x29 && eax_9 != 0x3a) && eax_9 != 0x3b) && eax_9 != 0x3d) && eax_9 != 0x5c) && eax_9 != 0x7b) && eax_9 != 0x7d)))
            {
                if ((data_4226b4 & 0x80) == 0)
                {
                    char eax_32 = sub_4038ca(esi_1);
                    edx = (-eax_32);
                    edx = ((edx - edx) & 0xa);
                }
                else
                {
                    if (sub_4038ca(esi_1) == 0)
                    {
                        if (esi_1 == 0x2a)
                        {
                            goto label_40a45d;
                        }
                        if (esi_1 != 0x40)
                        {
                            goto label_40a3d1;
                        }
                        goto label_40a45d;
                    }
                label_40a45d:
                    edx = 0xa;
                }
            }
        }
        arg1 = (ebx * 0xf);
        ebx = *((arg1 + edx) + 0x401280);
        if ((var_5 != 0 && ebx == 1))
        {
            ebx = (ebx + 0xf);
        }
        if (*ebx[1] != 0)
        {
            if (edx != 6)
            {
                *edi = 0x5c;
                edi = (edi + 2);
                var_c = edi;
            }
            else
            {
                data_4226a4 = (data_4226a4 + 1);
                data_412021 = 1;
                int16_t eax_35;
                eax_35 = sub_407ee6(arg1);
                esi_1 = eax_35;
                data_412021 = 0;
                if ((esi_1 == 0x20 || esi_1 == 9))
                {
                    ebx = 0x40;
                    while (true)
                    {
                        int16_t eax_36;
                        eax_36 = sub_407ee6(arg1);
                        esi_1 = eax_36;
                        if (esi_1 == 0x20)
                        {
                            continue;
                        }
                        if ((esi_1 != 0x20 && esi_1 != 9))
                        {
                            break;
                        }
                        if (esi_1 != 9)
                        {
                            /* nop */
                        }
                    }
                    edi = var_c;
                }
                if ((esi_1 != 0x20 && esi_1 != 9))
                {
                    ebx = edi != 0x4226c2;
                }
            }
        }
        *ebx[1] = 0;
        if (edi >= arg2)
        {
            sub_4053c9(data_4226a4, 0x434);
            arg1 = 0x434;
        }
        if (ebx == 0x40)
        {
            break;
        }
        if ((ebx & 0x20) != 0)
        {
            uint32_t var_28_1 = esi_1;
            arg1 = sub_4053c9(data_4226a4, ((ebx & 0xffffffdf) + 0x3e8));
        }
        if (ebx != 0xf)
        {
            *edi = esi_1;
            edi = (edi + 2);
            var_c = edi;
        }
        else
        {
            *ebx[1] = 1;
        }
    }
    ungetwc(esi_1, data_422edc);
    *edi = 0;
    return sub_40caf1(eax);
}

uint32_t __fastcall sub_40a593(int16_t* arg1)
{
    __security_cookie;
    int16_t* edi = arg1;
    int32_t var_274 = 0;
    int16_t ebx = 0;
    int16_t eax_2 = *edi;
    if ((eax_2 != 0 && eax_2 != 0x23))
    {
        int32_t esi = wcspbrk(edi, &data_401954);
        int16_t var_264 = 0x20;
        int16_t var_260 = 9;
        wchar16* ebx_2;
        if (esi == 0)
        {
            int16_t* ecx_5 = edi;
            ebx_2 = nullptr;
            int32_t eax_3;
            do
            {
                eax_3 = *ecx_5;
                ecx_5 = &ecx_5[1];
            } while (eax_3 != 0);
            esi = &edi[((ecx_5 - &ecx_5[1]) >> 1)];
        }
        else
        {
            if (*esi == 0x23)
            {
                ebx = 0x23;
            }
            *esi = 0;
            if (ebx == 0)
            {
                int16_t* ebx_1 = (esi + 2);
                while (true)
                {
                    int16_t eax_4 = *ebx_1;
                    if (eax_4 == 0)
                    {
                        break;
                    }
                    if (eax_4 == 0x23)
                    {
                        break;
                    }
                    if ((eax_4 != var_264 && eax_4 != var_260))
                    {
                        int16_t* var_288_1 = ebx_1;
                        sub_4053c9(data_4226a4, 0x409);
                    }
                    ebx_1 = &ebx_1[1];
                }
            }
            ebx_2 = nullptr;
        }
        if (esi > edi)
        {
            int32_t eax_5;
            do
            {
                eax_5 = (esi - 2);
                int16_t ecx_1 = *eax_5;
                if ((ecx_1 != var_264 && ecx_1 != var_260))
                {
                    break;
                }
                esi = eax_5;
            } while (eax_5 > edi);
        }
        *esi = 0;
        uint32_t eax_6 = *edi;
        void var_26c;
        void var_25c;
        if ((eax_6 == 0x3c && *(esi - 2) == 0x3e))
        {
            *(esi - 2) = 0;
            wchar16* esi_1 = sub_40f2a7(&edi[1]);
            if (esi_1 == &edi[1])
            {
                esi_1 = sub_40e917(&edi[1]);
            }
            void* eax_9 = sub_40ab10(u"INCLUDE");
            uint8_t* ecx_4;
            if (eax_9 == 0)
            {
                ecx_4 = nullptr;
            }
            else
            {
                ecx_4 = *(*(eax_9 + 8) + 4);
            }
            if (ecx_4 != 0)
            {
                int32_t eax_11 = sub_40e917(ecx_4);
                ebx_2 = sub_40f2a7(eax_11);
                if (ebx_2 != eax_11)
                {
                    free(eax_11);
                }
            }
            edi = sub_407bca(ebx_2, esi_1, &var_25c, &var_26c);
            if (edi == 0)
            {
                wchar16* var_288_4 = esi_1;
                sub_4053c9(data_4226a4, 0x41c);
            }
            if (ebx_2 != 0)
            {
                free(ebx_2);
            }
            free(esi_1);
        }
        if ((eax_6 != 0x3c || (eax_6 == 0x3c && *(esi - 2) != 0x3e)))
        {
            if ((eax_6 == 0x22 && *(esi - 2) == 0x22))
            {
                edi = &edi[1];
                *(esi - 2) = 0;
            }
            int32_t ebx_3 = sub_40f2a7(edi);
            if (ebx_3 == edi)
            {
                ebx_3 = sub_40e917(edi);
            }
            if (sub_407a1b(ebx_3, &var_25c, &var_26c) == 0)
            {
                int32_t eax_17 = wcspbrk(ebx_3, &data_40195c);
                int32_t var_264_1;
                if (eax_17 != 0)
                {
                    int32_t var_288_15 = ebx_3;
                }
                else
                {
                    int32_t edx_4 = data_433324;
                    int32_t eax_18 = edx_4;
                    var_264_1 = eax_18;
                    if (eax_18 >= 0)
                    {
                        int32_t* ecx_18 = ((eax_18 * 0xc) + 0x433334);
                        int32_t* var_270_1 = ecx_18;
                        while (true)
                        {
                            int32_t ecx_19;
                            if (eax_18 != edx_4)
                            {
                                ecx_19 = *ecx_18;
                            }
                            else
                            {
                                ecx_19 = data_422ee4;
                            }
                            int32_t eax_19 = sub_40aa38(ecx_19);
                            int32_t var_260_1 = eax_19;
                            if (eax_19 != 0)
                            {
                                int32_t ecx_20 = eax_19;
                                int32_t edx_5 = (ecx_20 + 2);
                                do
                                {
                                    eax_19 = *ecx_20;
                                    ecx_20 = (ecx_20 + 2);
                                } while (eax_19 != 0);
                                int32_t edx_6 = ebx_3;
                                int32_t esi_2 = (edx_6 + 2);
                                do
                                {
                                    eax_19 = *edx_6;
                                    edx_6 = (edx_6 + 2);
                                } while (eax_19 != 0);
                                int32_t esi_4 = ((((ecx_20 - edx_5) >> 1) + 2) + ((edx_6 - esi_2) >> 1));
                                int32_t eax_21;
                                int32_t edx_9;
                                edx_9 = HIGHD((esi_4 * 2));
                                eax_21 = LOWD((esi_4 * 2));
                                int32_t ecx_23;
                                ecx_23 = ((esi_4 * 2) >> 0x20) != 0;
                                int32_t eax_22 = sub_40aba4(((-ecx_23) | eax_21));
                                wcscpy_s(eax_22, esi_4, var_260_1);
                                wcscat_s(eax_22, esi_4, &data_401964);
                                wcscat_s(eax_22, esi_4, ebx_3);
                                if (sub_407a1b(eax_22, &var_25c, &var_26c) != 0)
                                {
                                    edi = eax_22;
                                    free(var_260_1);
                                    break;
                                }
                                free(var_260_1);
                                free(eax_22);
                            }
                            eax_18 = (var_264_1 - 1);
                            ecx_18 = (var_270_1 - 0xc);
                            var_264_1 = eax_18;
                            var_270_1 = ecx_18;
                            if (eax_18 < 0)
                            {
                                break;
                            }
                            edx_4 = data_433324;
                        }
                    }
                    free(ebx_3);
                    if (var_264_1 < 0)
                    {
                        int16_t* var_288_14 = edi;
                    }
                }
                if ((eax_17 != 0 || (eax_17 == 0 && var_264_1 < 0)))
                {
                    sub_4053c9(data_4226a4, 0x41c);
                }
            }
        }
        int32_t edx_11 = data_433324;
        int32_t esi_6 = 0;
        if (edx_11 > 0)
        {
            int32_t* ebx_4 = &data_433334;
            do
            {
                if (_wcsicmp(edi, *ebx_4) == 0)
                {
                    int16_t* var_288_17 = edi;
                    sub_4053c9(data_4226a4, 0x430);
                }
                edx_11 = data_433324;
                esi_6 = (esi_6 + 1);
                ebx_4 = &ebx_4[3];
            } while (esi_6 < edx_11);
        }
        int32_t eax_26 = data_422edc;
        void* ecx_33 = (edx_11 * 0xc);
        bool cond:0 = data_422ee3 == 0;
        data_433324 = (edx_11 + 1);
        data_4226b0 = 0;
        *(ecx_33 + 0x433338) = eax_26;
        *(ecx_33 + 0x433330) = data_4226a4;
        *(ecx_33 + 0x433334) = data_422ee4;
        if ((!cond:0))
        {
            int16_t* var_288_18 = edi;
            sub_40ce84(u"Included: %s\n");
        }
        int32_t eax_29 = sub_410653(edi, u"rt,ccs=unicode");
        data_422edc = eax_29;
        if (eax_29 == 0)
        {
            int16_t* var_288_19 = edi;
            sub_4053c9(data_4226a4, 0x41c);
        }
        int32_t eax_30;
        int32_t ecx_37;
        eax_30 = sub_40e917(edi);
        data_422ee4 = eax_30;
        data_4226a4 = 1;
        data_412021 = 1;
        uint32_t eax_32 = sub_407ee6(ecx_37);
        if ((eax_32 == 0x20 || eax_32 == 9))
        {
            data_412021 = 0;
            eax_32 = 0x12;
        }
        if ((eax_32 != 0x20 && eax_32 != 9))
        {
            int32_t var_288_20 = data_422edc;
            data_412021 = 1;
            ungetwc(eax_32, var_288_20);
            data_4226a4 = (data_4226a4 - 1);
            eax_32 = 0x11;
        }
        CookieCheckFunction(eax_32);
        return eax_32;
    }
    sub_4053c9(data_4226a4, 0x407);
    /* tailcall */
    return sub_40aa38(0x407);
}

int32_t __fastcall sub_40aa38(int32_t arg1)
{
    __security_cookie;
    void var_214;
    void var_10;
    _wsplitpath_s(arg1, &var_10, 3, &var_214, 0x100, 0, 0, 0, 0);
    void* ecx = &var_10;
    int16_t i;
    do
    {
        i = *ecx;
        ecx = (ecx + 2);
    } while (i != 0);
    void* edx = &var_214;
    do
    {
        i = *edx;
        edx = (edx + 2);
    } while (i != 0);
    void var_212;
    void var_e;
    int32_t esi_1 = ((((ecx - &var_e) >> 1) + 1) + ((edx - &var_212) >> 1));
    int32_t eax_3;
    int32_t edx_3;
    edx_3 = HIGHD((esi_1 * 2));
    eax_3 = LOWD((esi_1 * 2));
    int32_t ecx_3;
    ecx_3 = ((esi_1 * 2) >> 0x20) != 0;
    int32_t eax_4 = sub_40aba4(((-ecx_3) | eax_3));
    _wmakepath_s(eax_4, esi_1, &var_10, &var_214, 0, 0);
    int32_t ecx_6 = eax_4;
    int32_t edx_4 = (ecx_6 + 2);
    int16_t i_1;
    do
    {
        i_1 = *ecx_6;
        ecx_6 = (ecx_6 + 2);
    } while (i_1 != 0);
    int32_t ecx_8 = ((ecx_6 - edx_4) >> 1);
    int16_t eax_5 = *((eax_4 + (ecx_8 << 1)) - 2);
    if ((0x5c == eax_5 || (0x5c != eax_5 && 0x2f == eax_5)))
    {
        *((eax_4 + (ecx_8 << 1)) - 2) = 0;
    }
    CookieCheckFunction(eax_4);
    return eax_4;
}

void* __fastcall sub_40ab10(int16_t* arg1)
{
    int16_t* edx = arg1;
    int16_t i_3 = *arg1;
    int32_t eax_5;
    void** i_1;
    if (i_3 == 0)
    {
        data_436624 = 0x432f10;
    }
    else
    {
        int32_t ecx = 0;
        int16_t i_2 = i_3;
        int16_t i;
        do
        {
            edx = &edx[1];
            ecx = (ecx + i_2);
            i = *edx;
            i_2 = i;
        } while (i != 0);
        i_1 = *((ecx << 2) + &data_432f10);
        data_436624 = ((ecx << 2) + &data_432f10);
        for (; i_1 != 0; i_1 = *i_1)
        {
            int16_t* eax_3 = i_1[1];
            int16_t* edx_1 = arg1;
            while (true)
            {
                i_2 = *eax_3;
                int16_t temp0_1 = *edx_1;
                bool c_1 = i_2 < temp0_1;
                if (i_2 == temp0_1)
                {
                    int16_t temp1_1;
                    if (i_2 != 0)
                    {
                        i_2 = eax_3[1];
                        temp1_1 = edx_1[1];
                        c_1 = i_2 < temp1_1;
                        if (i_2 == temp1_1)
                        {
                            eax_3 = &eax_3[2];
                            edx_1 = &edx_1[2];
                            if (i_2 != 0)
                            {
                                continue;
                            }
                        }
                    }
                    if ((i_2 == 0 || (i_2 != 0 && i_2 == temp1_1)))
                    {
                        eax_5 = 0;
                        break;
                    }
                }
                eax_5 = ((eax_3 - eax_3) | 1);
                break;
            }
            if (eax_5 == 0)
            {
                break;
            }
        }
    }
    void* eax_10;
    if ((i_3 == 0 || (i_3 != 0 && i_1 == 0)))
    {
        eax_10 = nullptr;
    }
    if ((i_3 != 0 && i_1 != 0))
    {
        eax_5 = i_1[3];
        eax_5 = (eax_5 & 0x10);
        uint32_t eax_6 = eax_5;
        int32_t eax_7 = (-eax_6);
        eax_10 = ((!(eax_7 - eax_7)) & i_1);
    }
    return eax_10;
}

int32_t __fastcall sub_40aba4(int32_t arg1)
{
    int32_t eax = malloc(arg1);
    if (eax == 0)
    {
        sub_4053c9(data_4226b0, 0x41b);
    }
    return eax;
}

int32_t __fastcall sub_40abc9(uint32_t arg1)
{
    uint32_t var_4 = arg1;
    int32_t eax = sub_40aba4(arg1);
    memset(eax, 0, arg1);
    return eax;
}

int32_t __fastcall sub_40abe7(int32_t arg1, int32_t arg2)
{
    int32_t esi;
    if (arg1 == 0)
    {
        esi = sub_40aba4(arg2);
    }
    else
    {
        esi = realloc(arg1, arg2);
        if (esi == 0)
        {
            sub_4053c9(data_4226b0, 0x41b);
        }
    }
    return esi;
}

uint32_t __fastcall sub_40ac1d(int16_t* arg1, int16_t* arg2)
{
    __security_cookie;
    int32_t i = 0;
    int16_t* var_6c4 = arg2;
    int16_t* var_6b8 = &data_4372dc;
    int32_t var_6b4 = 0;
    int32_t var_6cc = 0;
    int32_t** var_6bc = &data_4372d8;
    enum LOAD_LIBRARY_FLAGS dwFlags = LOAD_LIBRARY_AS_IMAGE_RESOURCE | LOAD_LIBRARY_AS_DATAFILE_EXCLUSIVE;
    uint32_t eax_19;
    if (arg1 == 0)
    {
    label_40b1e4:
        eax_19 = 0x80070057;
    }
    else
    {
        if (*arg1 == 0)
        {
            goto label_40b1e4;
        }
        if (arg2 == 0)
        {
            goto label_40b1e4;
        }
        if (*arg2 == 0)
        {
            goto label_40b1e4;
        }
        data_4372d8 = 0;
        void var_218;
        if (wcsncpy_s(&var_218, 0x104, arg1, 0xffffffff) != 0)
        {
        label_40b1dd:
            eax_19 = 0x80004005;
        }
        else
        {
            void* ecx = &var_218;
            int32_t eax_2;
            do
            {
                eax_2 = *ecx;
                ecx = (ecx + 2);
            } while (eax_2 != 0);
            void var_21a;
            void var_216;
            if ((*(&var_21a + (((ecx - &var_216) >> 1) << 1)) != 0x5c && wcsncat_s(&var_218, 0x104, &data_401964, 0xffffffff) != 0))
            {
                goto label_40b1dd;
            }
            uint32_t var_6d8 = 0x80070002;
            void* var_6ac = &var_218;
            int16_t** var_6a8_1 = &var_6c4;
            int32_t* var_6a4_1 = &dwFlags;
            int32_t* var_6a0_1 = &var_6bc;
            int32_t* var_69c_1 = &var_6b8;
            int32_t* var_698_1 = &var_6cc;
            int32_t* var_694_1 = &var_6b4;
            int32_t lpBuffer = 0;
            void var_434;
            void* edi_1 = &var_434;
            *edi_1 = 0;
            *(edi_1 + 4) = 0;
            uint32_t eax_4 = GetEnvironmentVariableW(u"VSLANG", &lpBuffer, 6);
            if ((eax_4 != 0 && eax_4 < 6))
            {
                <lambda_8e3c08aa9d5457651d5f58bced74548d>::operator()(&var_6ac, &lpBuffer, 0xa, &var_6d8);
            }
            if (((eax_4 == 0 || (eax_4 != 0 && eax_4 >= 6)) || ((eax_4 != 0 && eax_4 < 6) && var_6d8 != 0)))
            {
                void* eax_5 = data_436664;
                HINSTANCE hModule;
                FARPROC esi;
                if (eax_5 != 0)
                {
                    esi = DecodePointer(eax_5);
                }
                else
                {
                    hModule = GetModuleHandleW(u"kernel32.dll");
                    if (hModule != 0)
                    {
                        esi = GetProcAddress(hModule, "SetThreadPreferredUILanguages");
                        data_436664 = EncodePointer(esi);
                    }
                }
                if ((eax_5 != 0 || (eax_5 == 0 && hModule != 0)))
                {
                    if (esi == 0)
                    {
                        i = 0;
                    }
                    else
                    {
                        uint32_t eax_9 = GetEnvironmentVariableW(u"VS_UNICODE_OUTPUT", nullptr, 0);
                        if ((eax_9 == 0 && esi(0x100, eax_9, eax_9) == 0))
                        {
                            goto label_40b1dd;
                        }
                        void* var_6d0 = nullptr;
                        int32_t var_6c8 = 0;
                        void* eax_11 = data_436660;
                        HINSTANCE hModule_1;
                        FARPROC esi_1;
                        if (eax_11 != 0)
                        {
                            esi_1 = DecodePointer(eax_11);
                        }
                        else
                        {
                            hModule_1 = GetModuleHandleW(u"kernel32.dll");
                            if (hModule_1 != 0)
                            {
                                esi_1 = GetProcAddress(hModule_1, "GetThreadPreferredUILanguages");
                                data_436660 = EncodePointer(esi_1);
                            }
                        }
                        if ((eax_11 != 0 || (eax_11 == 0 && hModule_1 != 0)))
                        {
                            if (esi_1 == 0)
                            {
                                goto label_40af7c;
                            }
                            if (esi_1(0x34, &var_6c8, 0, &var_6d0) == 0)
                            {
                                goto label_40b1dd;
                            }
                            void* lpMem = HeapAlloc(GetProcessHeap(), HEAP_NONE, (var_6d0 * 2));
                            if (lpMem != 0)
                            {
                                if (esi_1(0x34, &var_6c8, lpMem, &var_6d0) == 0)
                                {
                                    goto label_40b1dd;
                                }
                                void* lpMem_1 = lpMem;
                                uint32_t ebx_1;
                                if (*lpMem == 0)
                                {
                                    ebx_1 = var_6d8;
                                }
                                else
                                {
                                    do
                                    {
                                        <lambda_8e3c08aa9d5457651d5f58bced74548d>::operator()(&var_6ac, lpMem_1, 0x10, &var_6d8);
                                        ebx_1 = var_6d8;
                                        if (ebx_1 == 0)
                                        {
                                            break;
                                        }
                                        lpMem_1 = (lpMem_1 + 0xa);
                                    } while (*lpMem_1 != 0);
                                }
                                HeapFree(GetProcessHeap(), HEAP_NONE, lpMem);
                                if (ebx_1 == 0)
                                {
                                    goto label_40aed8;
                                }
                                goto label_40af7c;
                            }
                            eax_19 = 0x8007000e;
                        }
                        if ((eax_11 == 0 && hModule_1 == 0))
                        {
                        label_40af7c:
                            <lambda_8e3c08aa9d5457651d5f58bced74548d>::operator()(&var_6ac, u"1033", 0xa, &var_6d8);
                            uint32_t ebx_2 = var_6d8;
                            if (ebx_2 == 0)
                            {
                                goto label_40aed8;
                            }
                            void var_420;
                            int32_t eax_27 = wcsncpy_s(&var_420, 0x104, &var_218, 0xffffffff);
                            int32_t eax_28;
                            if (eax_27 == 0)
                            {
                                eax_28 = wcsncat_s(&var_420, 0x104, &data_401a20, 0xffffffff);
                                if (eax_28 == 0)
                                {
                                    char lpFindFileData;
                                    FindFileHandle hFindFile = FindFirstFileW(&var_420, &lpFindFileData);
                                    if (hFindFile != 0xffffffff)
                                    {
                                        void* esi_2 = &var_218;
                                        FindFileHandle eax_29;
                                        do
                                        {
                                            eax_29 = *esi_2;
                                            esi_2 = (esi_2 + 2);
                                        } while (eax_29 != 0);
                                        while (true)
                                        {
                                            if (FindNextFileW(hFindFile, &lpFindFileData) == 0)
                                            {
                                                break;
                                            }
                                            if ((lpFindFileData & 0x10) != 0)
                                            {
                                                void* const ecx_9 = &data_40169c;
                                                void var_664;
                                                void* eax_31 = &var_664;
                                                int32_t eax_33;
                                                int16_t edx;
                                                while (true)
                                                {
                                                    edx = *eax_31;
                                                    int16_t temp1_1 = *ecx_9;
                                                    bool c_1 = edx < temp1_1;
                                                    if (edx == temp1_1)
                                                    {
                                                        int16_t temp2_1;
                                                        if (edx != 0)
                                                        {
                                                            edx = *(eax_31 + 2);
                                                            temp2_1 = *(ecx_9 + 2);
                                                            c_1 = edx < temp2_1;
                                                            if (edx == temp2_1)
                                                            {
                                                                eax_31 = (eax_31 + 4);
                                                                ecx_9 = (ecx_9 + 4);
                                                                if (edx != 0)
                                                                {
                                                                    continue;
                                                                }
                                                            }
                                                        }
                                                        if ((edx == 0 || (edx != 0 && edx == temp2_1)))
                                                        {
                                                            eax_33 = 0;
                                                            break;
                                                        }
                                                    }
                                                    eax_33 = ((eax_31 - eax_31) | 1);
                                                    break;
                                                }
                                                if (eax_33 != 0)
                                                {
                                                    void* const ecx_10 = &data_401a24;
                                                    void* eax_34 = &var_664;
                                                    int32_t eax_36;
                                                    while (true)
                                                    {
                                                        edx = *eax_34;
                                                        int16_t temp3_1 = *ecx_10;
                                                        bool c_2 = edx < temp3_1;
                                                        if (edx == temp3_1)
                                                        {
                                                            int16_t temp4_1;
                                                            if (edx != 0)
                                                            {
                                                                edx = *(eax_34 + 2);
                                                                temp4_1 = *(ecx_10 + 2);
                                                                c_2 = edx < temp4_1;
                                                                if (edx == temp4_1)
                                                                {
                                                                    eax_34 = (eax_34 + 4);
                                                                    ecx_10 = (ecx_10 + 4);
                                                                    if (edx != 0)
                                                                    {
                                                                        continue;
                                                                    }
                                                                }
                                                            }
                                                            if ((edx == 0 || (edx != 0 && edx == temp4_1)))
                                                            {
                                                                eax_36 = 0;
                                                                break;
                                                            }
                                                        }
                                                        eax_36 = ((eax_34 - eax_34) | 1);
                                                        break;
                                                    }
                                                    if (eax_36 != 0)
                                                    {
                                                        int32_t var_6ec_15 = 1;
                                                        void var_6b0;
                                                        void* var_6f0_9 = &var_6b0;
                                                        int16_t var_6d4;
                                                        int16_t* var_6f4_9 = &var_6d4;
                                                        if (sub_40cd1c(&var_664, u"%hu%c") != 0xffffffff)
                                                        {
                                                            int32_t eax_38 = (((esi_2 - &var_216) >> 1) * 2);
                                                            if (eax_38 >= 0x208)
                                                            {
                                                                ___report_rangecheckfailure();
                                                                breakpoint();
                                                            }
                                                            *(&var_420 + eax_38) = 0;
                                                            if ((wcsncat_s(&var_420, 0x104, &var_664, 0xffffffff) == 0 && wcsncat_s(&var_420, 0x104, &data_401964, 0xffffffff) == 0))
                                                            {
                                                                int32_t hFile = wcsncat_s(&var_420, 0x104, var_6c4, 0xffffffff);
                                                                if (hFile == 0)
                                                                {
                                                                    HINSTANCE eax_41 = LoadLibraryExW(&var_420, hFile, dwFlags);
                                                                    if (eax_41 != 0)
                                                                    {
                                                                        *var_6bc = eax_41;
                                                                        int16_t* ecx_12 = var_6b8;
                                                                        if (ecx_12 != 0)
                                                                        {
                                                                            int32_t** eax_43;
                                                                            eax_43 = var_6d4;
                                                                            *ecx_12 = eax_43;
                                                                        }
                                                                        if (var_6cc != 0)
                                                                        {
                                                                            wcscpy_s(var_6cc, var_6b4, &var_420);
                                                                        }
                                                                        ebx_2 = 0;
                                                                        break;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                        FindClose(hFindFile);
                                        eax_19 = ebx_2;
                                    }
                                    else
                                    {
                                        eax_19 = GetLastError();
                                        if (eax_19 > 0)
                                        {
                                            eax_19 = (eax_19 | 0x80070000);
                                        }
                                    }
                                }
                            }
                            if ((eax_27 != 0 || (eax_27 == 0 && eax_28 != 0)))
                            {
                                eax_19 = 0x80070003;
                            }
                        }
                    }
                }
                if ((((eax_5 != 0 || (eax_5 == 0 && hModule != 0)) && esi == 0) || (eax_5 == 0 && hModule == 0)))
                {
                    uint16_t eax_23 = GetUserDefaultUILanguage();
                    int16_t ecx_6 = (eax_23 & 0x3ff);
                    if ((ecx_6 == 1 || ecx_6 == 0xd))
                    {
                        eax_23 = 0x409;
                    }
                    uint16_t var_440 = eax_23;
                    int16_t var_43c = 0x409;
                    int16_t var_43e_1 = ((eax_23 & 0x3ff) | 0x400);
                    do
                    {
                        void var_42c;
                        _itow_s(&var_440[i], &var_42c, 6, 0xa);
                        <lambda_8e3c08aa9d5457651d5f58bced74548d>::operator()(&var_6ac, &var_42c, 0xa, &var_6d8);
                        if (var_6d8 == 0)
                        {
                            break;
                        }
                        i = (i + 1);
                    } while (i < 3);
                    if (var_6d8 == 0)
                    {
                        goto label_40aed8;
                    }
                    goto label_40af7c;
                }
            }
            if (((eax_4 != 0 && eax_4 < 6) && var_6d8 == 0))
            {
            label_40aed8:
                eax_19 = 0;
            }
        }
    }
    CookieCheckFunction(eax_19);
    return eax_19;
}

int16_t* __thiscall <lambda_8e3c08aa9d5457651d5f58bced74548d>::operator()(int32_t* arg1, int16_t* arg2, int32_t arg3, int32_t* arg4)
{
    __security_cookie;
    int16_t* eax_2 = arg2;
    if (*eax_2 != 0)
    {
        int16_t* var_220;
        eax_2 = wcstoul(eax_2, &var_220, arg3);
        int16_t var_224_1 = eax_2;
        if (*var_220 == 0)
        {
            void var_14;
            _itow_s(eax_2, &var_14, 6, 0xa);
            void lpLibFileName;
            eax_2 = wcsncpy_s(&lpLibFileName, 0x104, *arg1, 0xffffffff);
            if (eax_2 == 0)
            {
                eax_2 = wcsncat_s(&lpLibFileName, 0x104, &var_14, 0xffffffff);
                if (eax_2 == 0)
                {
                    eax_2 = wcsncat_s(&lpLibFileName, 0x104, &data_401964, 0xffffffff);
                    if (eax_2 == 0)
                    {
                        eax_2 = wcsncat_s(&lpLibFileName, 0x104, *arg1[1], 0xffffffff);
                        if (eax_2 == 0)
                        {
                            eax_2 = LoadLibraryExW(&lpLibFileName, nullptr, *arg1[2]);
                            if (eax_2 != 0)
                            {
                                **arg1[3] = eax_2;
                                int16_t* eax_7 = *arg1[4];
                                if (eax_7 != 0)
                                {
                                    *eax_7 = var_224_1;
                                }
                                eax_2 = arg1[5];
                                int32_t ecx_4 = *eax_2;
                                if (ecx_4 != 0)
                                {
                                    eax_2 = wcscpy_s(ecx_4, *arg1[6], &lpLibFileName);
                                }
                                *arg4 = 0;
                            }
                            else if (*arg4 == 0x80070002)
                            {
                                eax_2 = GetLastError();
                                if (eax_2 > 0)
                                {
                                    eax_2 = (eax_2 | 0x80070000);
                                }
                                *arg4 = eax_2;
                            }
                        }
                    }
                }
            }
        }
    }
    CookieCheckFunction(eax_2);
    return eax_2;
}

int32_t sub_40b36e() __pure
{
    return;
}

uint32_t ErrorReportingDisabled()
{
    int32_t eax_1 = data_436628;
    if (eax_1 > 0)
    {
        if (eax_1 <= 2)
        {
            eax_1 = 0;
            return eax_1;
        }
        if (eax_1 == 3)
        {
            uint32_t eax = sub_40b394();
            char temp0 = eax;
            eax = (-eax);
            eax = (eax - eax);
            eax = (eax + 1);
            return eax;
        }
    }
    eax_1 = 1;
    return eax_1;
}

uint32_t sub_40b394()
{
    if (GetVersion() >= 6)
    {
        uint32_t eax;
        eax = 1;
        return eax;
    }
    HKEY var_8;
    enum WIN32_ERROR eax_1;
    if (RegOpenKeyExW(0x80000001, u"Software\Microsoft\VisualStudio\", 0, KEY_READ, &var_8) != NO_ERROR)
    {
    label_40b40e:
        eax_1 = 0;
    }
    else
    {
        int32_t lpcbData = 4;
        int32_t lpData;
        enum REG_VALUE_TYPE lpType;
        enum WIN32_ERROR eax_2 = RegQueryValueExW(var_8, u"UserCanAutoSendErrorReport", nullptr, &lpType, &lpData, &lpcbData);
        RegCloseKey(var_8);
        if (eax_2 != NO_ERROR)
        {
            goto label_40b40e;
        }
        if (lpType != REG_DWORD)
        {
            goto label_40b40e;
        }
        if (lpcbData != 4)
        {
            goto label_40b40e;
        }
        eax_1 = lpData == 1;
    }
    return eax_1;
}

enum WIN32_ERROR __fastcall sub_40b413(uint8_t* arg1)
{
    HKEY var_8;
    enum WIN32_ERROR eax;
    if (RegOpenKeyExW(0x80000002, u"Software\Microsoft\PCHealth\Erro", 0, KEY_READ, &var_8) != NO_ERROR)
    {
    label_40b490:
        eax = 0;
    }
    else
    {
        int32_t lpcbData = 0x208;
        enum REG_VALUE_TYPE lpType;
        enum WIN32_ERROR eax_1 = RegQueryValueExW(var_8, u"DW0200", nullptr, &lpType, arg1, &lpcbData);
        RegCloseKey(var_8);
        *(arg1 + 0x206) = 0;
        if (eax_1 != NO_ERROR)
        {
            goto label_40b490;
        }
        if (lpType == REG_EXPAND_SZ)
        {
            eax = ExpandEnvironmentStringsW(arg1, arg1, 0x104);
            if (eax > 0x104)
            {
                goto label_40b490;
            }
            if (eax == NO_ERROR)
            {
                goto label_40b490;
            }
        }
        else if (lpType != REG_SZ)
        {
            goto label_40b490;
        }
        eax = 1;
    }
    return eax;
}

HANDLE InitializeWatsonSharedMem()
{
    HANDLE hFileMappingObject = CreateFileMappingW(0xffffffff, &data_436630, PAGE_READWRITE, 0, 0x9c9c, nullptr);
    data_43663c = hFileMappingObject;
    if (hFileMappingObject != 0)
    {
        void* eax = MapViewOfFileEx(hFileMappingObject, 0x6, 0, 0, nullptr, nullptr);
        data_43662c = eax;
        if (eax != 0)
        {
            eax = 1;
            return eax;
        }
        CloseHandle(data_43663c);
        data_43663c = 0;
    }
    hFileMappingObject = 0;
    return hFileMappingObject;
}

int32_t __fastcall sub_40b4f4(int32_t* arg1)
{
    HANDLE var_8 = nullptr;
    int32_t var_c = 1;
    int32_t eax_47;
    if (data_436650 != 0)
    {
    label_40b8c0:
        eax_47 = 1;
    }
    else
    {
        if (ErrorReportingDisabled() != 0)
        {
            goto label_40b8c0;
        }
        data_436630 = 0xc;
        data_436634 = 0;
        data_436638 = 1;
        if ((data_43662c == 0 && InitializeWatsonSharedMem() == 0))
        {
            goto label_40b8c0;
        }
        if (sub_40b413(&data_436e70) == 0)
        {
            goto label_40b8c0;
        }
        data_436650 = CreateEventW(&data_436630, 0, 0, nullptr);
        HANDLE edi_1 = CreateEventW(&data_436630, 0, 0, nullptr);
        HANDLE ebx_1 = CreateMutexW(&data_436630, 0, nullptr);
        HANDLE eax_7 = GetCurrentProcess();
        BOOL eax_8 = DuplicateHandle(eax_7, eax_7, eax_7, &var_8, 0x1fffff, 1, 0);
        if ((((eax_8 != 0 && data_436650 != 0) && edi_1 != 0) && (ebx_1 != 0 && var_8 != 0)))
        {
            uint8_t* esi_1 = data_43662c;
            memset(esi_1, 0, 0x9c9c);
            *(esi_1 + 0x28) = var_8;
            *(data_43662c + 8) = GetCurrentProcessId();
            uint32_t eax_11 = GetCurrentThreadId();
            int32_t* ecx_1 = data_43662c;
            ecx_1[3] = eax_11;
            ecx_1[8] = data_436650;
            ecx_1[6] = edi_1;
            ecx_1[9] = ebx_1;
            *ecx_1 = 0x9c9c;
            ecx_1[1] = 0x20000;
            ecx_1[5] = arg1;
            ecx_1[4] = *(*arg1 + 0xc);
            char eax_16 = GetVersion();
            int32_t eax_17 = data_436628;
            int32_t eax_19;
            void* edx_1;
            if (eax_17 == 1)
            {
                edx_1 = data_43662c;
                *(edx_1 + 0x2c) = 0;
                *(edx_1 + 0x30) = 0;
            }
            else
            {
                eax_19 = (eax_17 - 2);
            }
            if (eax_17 == 2)
            {
                edx_1 = data_43662c;
                *(edx_1 + 0x2c) = 8;
            }
            int32_t temp2_1;
            if ((eax_17 != 1 && eax_17 != 2))
            {
                temp2_1 = eax_19;
                eax_19 = (eax_19 - 1);
                if (temp2_1 == 1)
                {
                    edx_1 = data_43662c;
                    *(edx_1 + 0x2c) = (*(edx_1 + 0x2c) & eax_19);
                }
            }
            if ((eax_17 == 2 || ((eax_17 != 1 && eax_17 != 2) && temp2_1 == 1)))
            {
                *(edx_1 + 0x30) = (-(eax_19 - eax_19));
            }
            if (((eax_17 == 1 || eax_17 == 2) || ((eax_17 != 1 && eax_17 != 2) && temp2_1 == 1)))
            {
                *(edx_1 + 0x34) = 0;
                char ecx_2 = data_4333fb;
                void* var_74_1 = data_41206c;
                int32_t eax_22;
                eax_22 = ecx_2 == 0;
                *(edx_1 + 0x44) = 1;
                *(edx_1 + 0x3c) = 0;
                *(edx_1 + 0x38) = (((eax_22 - 1) & 0xfffffff0) + 0x14);
                int32_t eax_26;
                eax_26 = ecx_2 == 0;
                *(edx_1 + 0x4c) = (((eax_26 - 1) & 0x10) + 1);
                wcsncpy_s((edx_1 + 0x21ac), 0x38, var_74_1, 0xffffffff);
                int32_t var_84_2 = *__p__wpgmptr();
                int32_t eax_34 = wcsncpy_s((data_43662c + 0x258), 0x104, var_84_2, 0xffffffff);
                void var_60;
                __builtin_strcpy(&var_60, "HKLM\Software\Microsoft\Internet", 0x48);
                sub_40cc9c(eax_34, &var_60, (data_43662c + 0x460), 0x48);
                wcsncpy_s((data_43662c + 0x7a4), 0x104, data_412068, 0xffffffff);
                int32_t var_a4_1 = data_43663c;
                sub_40cc6e(0x437078, 0x104, u"dw20.exe -x -s %u");
                memset(&data_437280, 0, 0x44);
                data_437280 = 0x44;
                if (CreateProcessW(&data_436e70, 0x437078, nullptr, nullptr, 1, NORMAL_PRIORITY_CLASS | CREATE_DEFAULT_ERROR_MODE, nullptr, nullptr, &data_437280, &data_4372c4) != 0)
                {
                    CloseHandle(data_4372c4);
                    CloseHandle(data_4372c8);
                    uint32_t i;
                    do
                    {
                        if (WaitForSingleObject(data_436650, 0x4e20) != 0)
                        {
                            uint32_t eax_39 = WaitForSingleObject(ebx_1, 0x4e20);
                            if (eax_39 == 0x102)
                            {
                                break;
                            }
                            if (eax_39 != 0x80)
                            {
                                if (WaitForSingleObject(data_436650, 1) != 0)
                                {
                                    SetEvent(edi_1);
                                }
                                else if (WaitForSingleObject(edi_1, 1) != 0)
                                {
                                    ReleaseMutex(ebx_1);
                                    continue;
                                }
                            }
                            ReleaseMutex(ebx_1);
                            break;
                        }
                        i = WaitForSingleObject(edi_1, 1);
                    } while (i != 0);
                    void* eax_42;
                    eax_42 = *(data_43662c + 0x9a84);
                    eax_42 = (eax_42 & 0x10);
                    uint32_t eax_43 = eax_42;
                    int32_t eax_44 = (-eax_43);
                    var_c = (var_c & (!(eax_44 - eax_44)));
                }
            }
        }
        if ((((eax_8 == 0 || (eax_8 != 0 && data_436650 == 0)) || ((eax_8 != 0 && data_436650 != 0) && edi_1 != 0)) && edi_1 != 0))
        {
            CloseHandle(edi_1);
        }
        if (ebx_1 != 0)
        {
            CloseHandle(ebx_1);
        }
        if (var_8 != 0)
        {
            CloseHandle(var_8);
        }
        HANDLE hObject = data_436650;
        if (hObject != 0)
        {
            CloseHandle(hObject);
            data_436650 = 0;
        }
        void* lpBaseAddress = data_43662c;
        if (lpBaseAddress != 0)
        {
            UnmapViewOfFile(lpBaseAddress);
            data_43662c = 0;
        }
        HANDLE hObject_1 = data_43663c;
        if (hObject_1 != 0)
        {
            CloseHandle(hObject_1);
            data_43663c = 0;
        }
        if (data_412066 != 0)
        {
            exit(1);
            /* no return */
        }
        eax_47 = var_c;
    }
    return eax_47;
}

int32_t __stdcall sub_40b8c6(int32_t* arg1)
{
    int32_t eax_1;
    if ((**arg1 == 0x80000003 || (**arg1 != 0x80000003 && data_4333fc != 0)))
    {
        eax_1 = 0;
    }
    if ((**arg1 != 0x80000003 && data_4333fc == 0))
    {
        data_4333fc = 1;
        data_412068 = u"msvcr140.dll";
        data_41206c = &data_402558;
        data_412066 = 0;
        eax_1 = sub_40b4f4(arg1);
    }
    return eax_1;
}

int32_t __fastcall sub_40b90e(int32_t* arg1, int32_t arg2, int32_t arg3)
{
    if (data_422ee0 == 0)
    {
        sub_405532();
    }
    sub_40ce84(u"\nNMAKE : fatal error U1038: Int");
    sub_40ce66();
    __builtin_memcpy(arg2, *arg1, 0x50);
    if (arg3 != 0)
    {
        __builtin_memcpy(arg3, arg1[1], 0x2cc);
    }
    int32_t eax_1;
    if (ErrorReportingDisabled() != 0)
    {
        eax_1 = data_4333fc == 0;
    }
    else
    {
        eax_1 = sub_40b8c6(arg1);
    }
    return eax_1;
}

int32_t sub_40b971(int32_t arg1, int32_t arg2) __noreturn
{
    int32_t var_4 = 0x558;
    int32_t var_8 = 0x411580;
    enum _EXCEPTION_DISPOSITION (* var_10)(int32_t* arg1, struct _EXCEPTION_REGISTRATION_RECORD* arg2, struct _CONTEXT* arg3, int32_t arg4) = __except_handler4;
    int32_t* fsbase;
    int32_t var_14 = *fsbase;
    int32_t ebp;
    var_4 = ebp;
    uint32_t __security_cookie_1 = __security_cookie;
    int32_t var_8_2 = (0x411580 ^ __security_cookie_1);
    int16_t* str_4 = (__security_cookie_1 ^ &var_4);
    int16_t* str_5 = str_4;
    int16_t* str_1 = str_4;
    int32_t* var_1c = &str_1;
    void* const var_580_1 = &data_40b980;
    int32_t var_8_3 = 0xfffffffe;
    int32_t var_c = var_8_2;
    *fsbase = &var_14;
    int32_t edi = arg2;
    int32_t var_27c = edi;
    SetErrorMode(SEM_FAILCRITICALERRORS);
    void var_278;
    memset(&var_278, 0, 0x50);
    void var_56c;
    memset(&var_56c, 0, 0x2cc);
    int32_t var_8_1 = 0;
    int32_t var_584 = 2;
    setlocale(2, ".ACP");
    data_4333fe = sub_40cd46(__acrt_iob_func(1));
    data_4333fd = sub_40cd46(__acrt_iob_func(2));
    _set_invalid_parameter_handler(sub_40b36e);
    data_436630 = 0xc;
    data_436634 = 0;
    data_436638 = 1;
    InitializeWatsonSharedMem();
    data_436628 = 2;
    int32_t esi = 1;
    int32_t ebx = arg1;
    while (true)
    {
        int32_t var_280_1 = esi;
        if (esi >= ebx)
        {
            break;
        }
        int16_t* ecx_3 = *(edi + (esi << 2));
        uint32_t eax_5 = *ecx_3;
        if ((eax_5 == 0x2d || eax_5 == 0x2f))
        {
            uint8_t* edi_1 = (edi + (esi << 2));
            int32_t eax_7 = _wcsicmp(&ecx_3[1], u"errorreport:none");
            int32_t eax_14;
            int32_t eax_17;
            if (eax_7 != 0)
            {
                eax_14 = _wcsicmp((*edi_1 + 2), u"errorreport:prompt");
                if (eax_14 != 0)
                {
                    eax_17 = _wcsicmp((*edi_1 + 2), u"errorreport:queue");
                    if (eax_17 == 0)
                    {
                        data_436628 = 2;
                    }
                    else
                    {
                        uint32_t var_570_7;
                        void* eax_24;
                        uint8_t* ecx_8;
                        if (_wcsicmp((*edi_1 + 2), u"errorreport:send") == 0)
                        {
                            data_436628 = 3;
                            var_570_7 = (((ebx - esi) << 2) + 0xfffffffc);
                            eax_24 = &edi_1[4];
                            edi = var_27c;
                            ecx_8 = (edi + (esi << 2));
                        }
                        else
                        {
                            if (_wcsicmp((*edi_1 + 2), u"errorreport:test") != 0)
                            {
                                goto label_40ba8b;
                            }
                            data_4333fa = 1;
                            var_570_7 = (((ebx - esi) << 2) + 0xfffffffc);
                            edi = var_27c;
                            ecx_8 = (edi + (esi << 2));
                            eax_24 = &ecx_8[4];
                        }
                        memmove(ecx_8, eax_24, var_570_7);
                        ebx = (ebx - 1);
                        arg1 = ebx;
                        esi = (esi - 1);
                        int32_t var_280_3 = esi;
                    }
                }
                else
                {
                    data_436628 = 1;
                }
            }
            else
            {
                data_436628 = eax_7;
            }
            if (((eax_7 == 0 || (eax_7 != 0 && eax_14 == 0)) || ((eax_7 != 0 && eax_14 != 0) && eax_17 == 0)))
            {
                memmove(edi_1, &edi_1[4], (((ebx - esi) << 2) + 0xfffffffc));
                ebx = (ebx - 1);
                arg1 = ebx;
                esi = (esi - 1);
                int32_t var_280_2 = esi;
            label_40ba8b:
                edi = var_27c;
            }
        }
        esi = (esi + 1);
    }
    if ((data_436628 == 3 && sub_40b394() == 0))
    {
        void* const var_570_9 = u"http://go.microsoft.com/fwlink/?";
        sub_4053c9(0, 0xfae);
    }
    if (ErrorReportingDisabled() == 0)
    {
        SetUnhandledExceptionFilter(sub_40b8c6);
    }
    if (data_4333fa != 0)
    {
        *nullptr = 0;
    }
    int32_t eax_33 = 0;
    while (true)
    {
        int32_t var_284_1 = eax_33;
        if (eax_33 >= 0x100)
        {
            break;
        }
        *((eax_33 << 2) + &data_432f10) = 0;
        eax_33 = (eax_33 + 1);
    }
    if (data_422ee8 == 0)
    {
        int16_t* str = *__p__wpgmptr();
        if (wcschr(str, 0x20) != 0)
        {
            int16_t* str_3 = str;
            void* ecx_11 = &str_3[1];
            int32_t var_570_12 = 2;
            wchar16* eax_35;
            do
            {
                eax_35 = *str_3;
                str_3 = &str_3[1];
            } while (eax_35 != 0);
            int32_t eax_37;
            int32_t edx_1;
            edx_1 = HIGHD(((((str_3 - ecx_11) >> 1) + 3) * 2));
            eax_37 = LOWD(((((str_3 - ecx_11) >> 1) + 3) * 2));
            int32_t ecx_12;
            ecx_12 = (((((str_3 - ecx_11) >> 1) + 3) * 2) >> 0x20) != 0;
            int32_t str_2 = sub_40aba4(((-ecx_12) | eax_37));
            wcscpy_s(str_2, (((str_3 - ecx_11) >> 1) + 3), &data_40104c);
            str_1 = str;
            wcscat_s(str_2, (((str_3 - ecx_11) >> 1) + 3), str_1);
            wcscat_s(str_2, (((str_3 - ecx_11) >> 1) + 3), &data_40104c);
            str = str_2;
            ebx = arg1;
            edi = var_27c;
        }
        data_422ee8 = sub_40e917(str);
    }
    int32_t var_574_11 = 2;
    signal(2, sub_40ca03);
    int32_t (* var_578_5)() = sub_40ca03;
    str_1 = 0xf;
    signal(str_1, var_578_5);
    uint32_t status = sub_40bf6e(ebx, edi);
    sub_40cab3();
    if (data_412020 == 0)
    {
        status = 1;
    }
    exit(status);
    /* no return */
}

int32_t sub_40bcb6(void* arg1 @ ebp)
{
    int32_t esp_51 = *(arg1 - 0x18);
    *(esp_51 - 4) = *(arg1 - 0x268);
    *(esp_51 - 8) = *(arg1 - 0x270);
    *(esp_51 - 0xc) = *(arg1 - 0x274);
    *(esp_51 - 0x10) = u"\n  Version 14.21.27702.2\n\n  E";
    sub_40ce84();
    *(esp_51 - 4) = 0x1c;
    *(esp_51 - 8) = (arg1 - 0x29c);
    *(esp_51 - 0xc) = *(arg1 - 0x268);
    if (VirtualQuery() != 0)
    {
        *(esp_51 - 4) = 0x104;
        *(esp_51 - 8) = (arg1 - 0x224);
        *(esp_51 - 0xc) = *(arg1 - 0x298);
        if (GetModuleFileNameW() != 0)
        {
            *(esp_51 - 4) = (arg1 - 0x224);
            *(esp_51 - 8) = *(arg1 - 0x298);
            *(esp_51 - 0xc) = u" (%p) "%s"";
            sub_40ce84();
        }
    }
    int32_t edi = *(arg1 - 0x264);
    *(esp_51 - 4) = edi;
    *(esp_51 - 8) = u"\n  NumberParameters         = %";
    sub_40ce84();
    *(esp_51 - 4);
    void* esp_19 = esp_51;
    int32_t esi = 0;
    if (edi != 0)
    {
        do
        {
            *(esp_19 - 4) = *((arg1 + (esi << 2)) - 0x260);
            *(esp_19 - 8) = esi;
            *(esp_19 - 0xc) = u"  ExceptionInformation[%2u] = %p";
            sub_40ce84();
            esi = (esi + 1);
        } while (esi < edi);
    }
    *(esp_19 - 4) = *(arg1 - 0x550);
    *(esp_19 - 8) = *(arg1 - 0x55c);
    *(esp_19 - 0xc) = *(arg1 - 0x554);
    *(esp_19 - 0x10) = *(arg1 - 0x560);
    *(esp_19 - 0x14) = *(arg1 - 0x558);
    *(esp_19 - 0x18) = *(arg1 - 0x564);
    *(esp_19 - 0x1c) = *(arg1 - 0x4dc);
    *(esp_19 - 0x20) = *(arg1 - 0x4d8);
    *(esp_19 - 0x24) = *(arg1 - 0x4d4);
    *(esp_19 - 0x28) = *(arg1 - 0x4a0);
    *(esp_19 - 0x2c) = *(arg1 - 0x4d0);
    *(esp_19 - 0x30) = *(arg1 - 0x4ac);
    *(esp_19 - 0x34) = *(arg1 - 0x4a8);
    *(esp_19 - 0x38) = *(arg1 - 0x4b0);
    *(esp_19 - 0x3c) = *(arg1 - 0x4cc);
    *(esp_19 - 0x40) = *(arg1 - 0x4c0);
    *(esp_19 - 0x44) = *(arg1 - 0x4c8);
    *(esp_19 - 0x48) = *(arg1 - 0x4bc);
    *(esp_19 - 0x4c) = *(arg1 - 0x4b4);
    *(esp_19 - 0x50) = *(arg1 - 0x4c4);
    *(esp_19 - 0x54) = *(arg1 - 0x4a4);
    *(esp_19 - 0x58) = *(arg1 - 0x4b8);
    *(esp_19 - 0x5c) = u"\nCONTEXT:\n  Eax    = %p  Esp  ";
    sub_40ce84();
    sub_40ce66();
    *(arg1 - 4) = 0xfffffffe;
    int32_t* fsbase;
    *fsbase = *(arg1 - 0x10);
    *esp_19;
    *(esp_19 + 4);
    *(esp_19 + 8);
    *(esp_19 + 0xc);
    *arg1;
    return 0x40e;
}

void* const sub_40be0c()
{
    int32_t edi = 0;
    sub_403430(sub_40e917(&data_402428), sub_40e917(&data_402430), 0);
    sub_403430(sub_40e917(&data_402438), sub_40e917(&data_402430), 0);
    sub_403430(sub_40e917(&data_402440), sub_40e917(&data_402430), 0);
    sub_403430(sub_40e917(&data_402448), sub_40e917(&data_402450), 0);
    sub_403430(sub_40e917(&data_402458), sub_40e917(&data_402460), 0);
    sub_403430(sub_40e917(u"_NMAKE_VER"), sub_40e917(u"14.21.27702.2"), 2);
    sub_403430(sub_40e917(u"MAKE"), sub_40e917(data_422ee8), 0x4c);
    void* const i = u".SUFFIXES";
    int32_t esi_7 = 0;
    do
    {
        int32_t eax_14 = sub_40e917(i);
        int32_t* esi_8 = *(esi_7 + 0x401170);
        data_4226b8 = eax_14;
        wcscpy_s(0x4226c0, 0x400, *esi_8);
        sub_402ce6();
        void* esi_9 = &esi_8[1];
        while (true)
        {
            int32_t eax_15 = *esi_9;
            if (eax_15 == 0)
            {
                break;
            }
            sub_402b07(wcscpy_s(0x4226c0, 0x400, eax_15));
            esi_9 = (esi_9 + 4);
        }
        if (edi == 0)
        {
            sub_4030d2();
        }
        sub_4031ec();
        edi = (edi + 1);
        esi_7 = (edi << 2);
        i = *(esi_7 + 0x401240);
    } while (i != 0);
    return i;
}

uint32_t __fastcall sub_40bf6e(int32_t arg1, int32_t arg2)
{
    __security_cookie;
    int16_t* var_214 = nullptr;
    int32_t eax_2 = sub_40e917(u"MAKEDIR");
    int32_t eax_3 = _wgetcwd(0, 0);
    sub_403430(eax_2, eax_3, 0x42);
    _wdupenv_s(&var_214, 0, u"MAKEFLAGS");
    int16_t* edi = var_214;
    if (edi != 0)
    {
        void* ecx_1 = u"MAKEFLAGS=                  ";
        int16_t i;
        do
        {
            i = *ecx_1;
            ecx_1 = (ecx_1 + 2);
        } while (i != 0);
        wcsncpy_s(u"                  ", (((ecx_1 - u"AKEFLAGS=                  ") >> 1) - 9), edi, 0xffffffff);
    }
    data_41248d = 1;
    int32_t eax_5 = sub_40e917(u"                  ");
    sub_403430(sub_40e917(u"MAKEFLAGS"), eax_5, 6);
    if (edi != 0)
    {
        void* i_1;
        do
        {
            uint32_t ecx_5 = *edi;
            if (ecx_5 == 0)
            {
                break;
            }
            sub_40c807(ecx_5, 1);
            i_1 = (edi + 1);
            edi = (i_1 + 1);
        } while (i_1 != 0xffffffff);
    }
    free(var_214);
    var_214 = nullptr;
    int32_t var_218;
    if ((_wgetenv_s(&var_218, 0, 0, u"NTMAKEENV") == 0 && var_218 != 0))
    {
        data_4333f9 = 1;
    }
    sub_40c429((arg1 - 1), (arg2 + 4));
    if (data_422ee0 == 0)
    {
        sub_405532();
    }
    if ((data_41248c & 2) == 0)
    {
        sub_40be0c();
        data_422ee4 = u"tools.ini";
        int16_t var_210;
        _wsearchenv(u"tools.ini", u"INIT", &var_210);
        if (var_210 != 0)
        {
            int32_t eax_8 = _wfsopen(&var_210, u"rt,ccs=unicode", 0x20);
            data_422edc = eax_8;
            if (eax_8 == 0)
            {
                int16_t* var_230_2 = &var_210;
                sub_4053c9(0, 0x41d);
            }
            char eax_9 = sub_4088bc();
            int32_t eax_10;
            int32_t eax_11;
            if (eax_9 != 0)
            {
                data_4226a4 = (data_4226a4 + 1);
                data_422ee1 = 1;
                sub_40cf09();
                eax_11 = fclose(data_422edc);
                if (eax_11 == 0xffffffff)
                {
                    int32_t var_230_6 = data_422ee4;
                }
            }
            else
            {
                eax_10 = fclose(data_422edc);
                if (eax_10 == 0xffffffff)
                {
                    int16_t* var_230_4 = &var_210;
                }
            }
            if (((eax_9 != 0 && eax_11 == 0xffffffff) || (eax_9 == 0 && eax_10 == 0xffffffff)))
            {
                sub_4053c9(0, 0x424);
            }
        }
    }
    if (_wputenv_s(u"MAKEFLAGS", sub_40e917(u"                  ")) != 0)
    {
        sub_4053c9(0, 0x41f);
    }
    if (data_4333f0 == 0)
    {
        sub_40c737();
    }
    sub_40c213(sub_40c35d());
    data_4226b0 = 0;
    sub_40e52c();
    if ((data_41248c & 1) != 0)
    {
        sub_40d3e4();
        sub_40d455();
        sub_40d4f5();
    }
    int32_t eax_14 = data_432efc;
    if (eax_14 != 0)
    {
        free(eax_14);
    }
    uint32_t eax_15 = sub_4038ef();
    _wchdir(eax_3);
    CookieCheckFunction(eax_15);
    return eax_15;
}

int32_t __fastcall sub_40c213(int32_t arg1)
{
    int32_t var_c = arg1;
    int32_t lpFileSize = arg1;
    void** i = data_4333f0;
    if (i != 0)
    {
        do
        {
            int16_t* ecx = i[1];
            if ((*ecx != 0x2d || (*ecx == 0x2d && ecx[1] != 0)))
            {
                int32_t eax_3 = sub_40e917(ecx);
                data_422ee4 = eax_3;
                int32_t _Stream = _wfsopen(eax_3, u"rt,ccs=unicode", 0x20);
                data_422edc = _Stream;
                if (_Stream == 0)
                {
                    int32_t var_1c_1 = data_422ee4;
                    sub_4053c9(0, 0x41c);
                    _Stream = data_422edc;
                }
                lpFileSize = 0;
                int32_t var_c_1 = 0;
                intptr_t hFile = _get_osfhandle(_fileno(_Stream));
                if ((hFile != 0xffffffff && GetFileSizeEx(hFile, &lpFileSize) != 0))
                {
                    int32_t lpFileSize_1 = lpFileSize;
                    int32_t eax_8 = ((var_c_1 + 0) - 1);
                    if ((eax_8 <= 0 && (eax_8 < 0 || (eax_8 >= 0 && (lpFileSize_1 - 1) <= 0x7ffffffd))))
                    {
                        setvbuf(data_422edc, 0, 0, (lpFileSize_1 + 1));
                    }
                }
            }
            if ((*ecx == 0x2d && ecx[1] == 0))
            {
                data_422ee4 = sub_40e917(u"STDIN");
                data_422edc = __acrt_iob_func(0);
            }
            data_4226a4 = 0;
            data_422ee1 = 0;
            sub_40cf09();
            int32_t eax_9 = __acrt_iob_func(0);
            FILE* _Stream_1 = data_422edc;
            if ((_Stream_1 != eax_9 && fclose(_Stream_1) == 0xffffffff))
            {
                int32_t var_1c_7 = data_422ee4;
                sub_4053c9(0, 0x424);
            }
            i = *i;
        } while (i != 0);
        i = data_4333f0;
    }
    return sub_404b9e(i);
}

wchar16* sub_40c35d()
{
    int32_t ecx;
    int32_t var_8 = ecx;
    int32_t var_c = ecx;
    int32_t* esi = *__p__wenviron();
    wchar16* str = *esi;
    if (str != 0)
    {
        int32_t var_8_1 = 0;
        do
        {
            wchar16* eax_1 = wcschr(str, 0x3d);
            if ((eax_1 != 0 && _wcsnicmp(*esi, u"MAKEFLAGS", 8) != 0))
            {
                *eax_1 = 0;
                int16_t* ecx_2 = *esi;
                if (*ecx_2 != 0)
                {
                    int32_t eax_3 = sub_40e917(ecx_2);
                    int32_t ebx_1 = eax_3;
                    int32_t edx_1 = (eax_3 + 2);
                    int16_t j;
                    do
                    {
                        j = *eax_3;
                        eax_3 = (eax_3 + 2);
                    } while (j != 0);
                    _wcsupr_s(ebx_1, (((eax_3 - edx_1) >> 1) + 1));
                    int32_t eax_7 = sub_40e917(&eax_1[1]);
                    *eax_1 = 0x3d;
                    data_41248d = 0;
                    if (sub_403430(ebx_1, eax_7, 4) == 0)
                    {
                        free(ebx_1);
                        free(eax_7);
                    }
                }
            }
            esi = &esi[1];
            str = *esi;
        } while (str != 0);
    }
    return str;
}

int32_t __fastcall sub_40c429(int32_t arg1, int32_t arg2)
{
    int32_t eax = arg1;
    int32_t var_2c = arg2;
    int32_t var_24 = eax;
    char var_2d = 0;
    int32_t edi = 0;
    if (eax != 0)
    {
        int32_t (* const var_14_1)() = __acrt_iob_func;
        int32_t (* const var_10_1)() = _wfopen_s;
        int32_t (* const var_c_1)(FILE* _Stream) = fclose;
        int32_t (* const var_1c_1)() = _wcsicmp;
        int32_t (* const var_20_1)() = wcsspn;
        wchar16* (* const var_28_1)(wchar16 const* str, wchar16 ch) = wcschr;
        uint32_t ecx_1;
        do
        {
            int16_t* str = *(arg2 + (edi << 2));
            uint32_t eax_1 = *str;
            if (eax_1 != 0x40)
            {
                if ((eax_1 != 0x2d && eax_1 != 0x2f))
                {
                    wchar16* eax_2 = wcschr(str, 0x3d);
                    if (eax_2 == 0)
                    {
                        eax = sub_40caf1(str);
                        if (*str != 0)
                        {
                            int32_t* eax_8 = sub_40e8c5();
                            int32_t eax_10;
                            if (wcschr(str, 0x20) == 0)
                            {
                                eax_10 = sub_40e917(str);
                            }
                            else
                            {
                                eax_10 = sub_40e95b(str);
                            }
                            eax_8[1] = eax_10;
                            eax = sub_40ea1c(&data_422690, eax_8);
                        }
                    }
                    else
                    {
                        if (eax_2 == str)
                        {
                            sub_4053c9(0, 0x427);
                        }
                        *eax_2 = 0;
                        void* eax_3 = &eax_2[-1];
                        while (true)
                        {
                            uint32_t ecx_4 = *eax_3;
                            if ((ecx_4 != 0x20 && ecx_4 != 9))
                            {
                                break;
                            }
                            eax_3 = (eax_3 - 2);
                        }
                        data_41248d = 1;
                        *(eax_3 + 2) = 0;
                        int16_t* eax_5 = sub_40e917(&eax_2[(1 + wcsspn(&eax_2[1], &data_401044, 2))]);
                        eax = sub_403430(sub_40e917(&str[wcsspn(str, &data_401044)]), eax_5);
                    }
                    arg2 = var_2c;
                    *(arg2 + (edi << 2)) = 0;
                    goto label_40c70b;
                }
                void* esi_5 = &str[1];
                eax = _wcsicmp(esi_5, u"help");
                if (eax == 0)
                {
                    ecx_1 = 1;
                    break;
                }
                if (*esi_5 == 0)
                {
                    goto label_40c707;
                }
                while (true)
                {
                    eax = _wcsicmp(esi_5, u"nologo");
                    if (eax == 0)
                    {
                        void* const ecx_10;
                        ecx_10 = *(esi_5 + 4);
                        eax = sub_40c807(ecx_10, 1);
                        break;
                    }
                    ecx_1 = *esi_5;
                    if (ecx_1 == 0x3f)
                    {
                        arg2 = var_2c;
                        ecx_1 = 1;
                        var_2d = 1;
                        break;
                    }
                    if ((ecx_1 != 0x66 && ecx_1 != 0x46))
                    {
                        if ((ecx_1 != 0x78 && ecx_1 != 0x58))
                        {
                            eax = sub_40c807(ecx_1, 1);
                            esi_5 = (esi_5 + 2);
                            if (*esi_5 == 0)
                            {
                                break;
                            }
                            continue;
                        }
                        void* esi_6 = (esi_5 + 2);
                        int16_t eax_11 = *esi_6;
                        int16_t ecx_11 = eax_11;
                        if (eax_11 == 0)
                        {
                            edi = (edi + 1);
                            int16_t eax_12;
                            if (edi < var_24)
                            {
                                esi_6 = *(var_2c + (edi << 2));
                                eax_12 = *esi_6;
                                ecx_11 = eax_12;
                            }
                            if ((edi >= var_24 || (edi < var_24 && eax_12 == 0)))
                            {
                                sub_4053c9(0, 0x426);
                                ecx_11 = *esi_6;
                            }
                        }
                        if ((ecx_11 != 0x2d || (ecx_11 == 0x2d && *(esi_6 + 2) != 0)))
                        {
                            FILE* _Stream;
                            if (var_10_1(&_Stream, esi_6, &data_402518) != 0)
                            {
                                void* var_44_1 = esi_6;
                                sub_4053c9(0, 0x418);
                            }
                            sub_40cddf(_Stream);
                            eax = var_c_1(_Stream);
                        }
                        if ((ecx_11 == 0x2d && *(esi_6 + 2) == 0))
                        {
                            eax = sub_40cddf(var_14_1(1));
                        }
                        break;
                    }
                    void* ebx_2 = (esi_5 + 2);
                    if (*ebx_2 == 0)
                    {
                        edi = (edi + 1);
                        if (edi < var_24)
                        {
                            ebx_2 = *(var_2c + (edi << 2));
                        }
                        if ((edi >= var_24 || (edi < var_24 && *ebx_2 == 0)))
                        {
                            sub_4053c9(0, 0x425);
                        }
                    }
                    int32_t* eax_15 = sub_40e8c5();
                    eax_15[1] = sub_40e917(ebx_2);
                    eax = sub_40ea1c(&data_4333f0, eax_15);
                    break;
                }
                if (eax == 0)
                {
                    goto label_40c707;
                }
                goto label_40c70f;
            }
            eax = sub_4051e1(&str[1]);
        label_40c707:
            arg2 = var_2c;
        label_40c70b:
            ecx_1 = var_2d;
        label_40c70f:
            edi = (edi + 1);
        } while (edi < var_24);
        if (ecx_1 != 0)
        {
            sub_40555e();
            exit(0);
            /* no return */
        }
    }
    return eax;
}

int32_t sub_40c737()
{
    __security_cookie;
    int32_t eax_2 = _waccess(u"makefile", 4);
    if (eax_2 == 0)
    {
        int32_t* eax_3 = sub_40e8c5();
        eax_2 = sub_40e917(u"makefile");
        eax_3[1] = eax_2;
        data_4333f0 = eax_3;
    }
    else
    {
        void* esi_1 = data_422690;
        if (esi_1 != 0)
        {
            wchar16* str = *(esi_1 + 4);
            eax_2 = _waccess(str, 4);
            if (eax_2 == 0)
            {
                int16_t* eax_4 = wcsrchr(str, 0x2e);
                void var_468;
                void var_218;
                if (eax_4 != 0)
                {
                    eax_2 = sub_40e0bd(&var_218, 0x101, str, eax_4, &var_468);
                }
                if ((eax_4 == 0 || (eax_4 != 0 && eax_2 == 0)))
                {
                    int32_t* ecx_4 = data_422690;
                    eax_2 = *ecx_4;
                    data_422690 = eax_2;
                    data_4333f0 = ecx_4;
                }
            }
        }
        else if ((data_41248c & 1) == 0)
        {
            eax_2 = sub_4053c9(0, 0x428);
        }
    }
    CookieCheckFunction(eax_2);
    return eax_2;
}

uint32_t __fastcall sub_40c807(int32_t arg1, char arg2)
{
    char ebx = 0;
    char* esi = &data_41248e;
    uint32_t edi = towupper(arg1);
    uint32_t eax_2 = edi;
    if (eax_2 > 0x4c)
    {
        if (eax_2 > 0x52)
        {
            uint32_t temp0_1 = eax_2;
            eax_2 = (eax_2 - 0x53);
            if (temp0_1 == 0x53)
            {
                goto label_40c8e7;
            }
            uint32_t temp1_1 = eax_2;
            eax_2 = (eax_2 - 1);
            if (temp1_1 == 1)
            {
                ebx = 0x10;
                goto label_40c8bc;
            }
            uint32_t temp4_1 = eax_2;
            eax_2 = (eax_2 - 1);
            if (temp4_1 == 1)
            {
                ebx = 0x40;
            }
            else
            {
                uint32_t temp8_1 = eax_2;
                eax_2 = (eax_2 - 4);
                if (temp8_1 == 4)
                {
                    ebx = 0x40;
                    goto label_40c8bc;
                }
            label_40c93e:
                uint32_t var_20_1 = arg1;
                eax_2 = sub_4053c9(0, 0x429);
            }
        }
        else if (eax_2 == 0x52)
        {
            ebx = 2;
        label_40c8bc:
            esi = &data_41248c;
        }
        else
        {
            uint32_t temp2_1 = eax_2;
            eax_2 = (eax_2 - 0x4e);
            if (temp2_1 == 0x4e)
            {
                ebx = 4;
            }
            else
            {
                uint32_t temp5_1 = eax_2;
                eax_2 = (eax_2 - 1);
                if (temp5_1 == 1)
                {
                    data_4226b5 = 1;
                label_40ca02:
                    return eax_2;
                }
                uint32_t temp9_1 = eax_2;
                eax_2 = (eax_2 - 1);
                if (temp9_1 == 1)
                {
                    ebx = 1;
                    goto label_40c8bc;
                }
                uint32_t temp12_1 = eax_2;
                eax_2 = (eax_2 - 1);
                if (temp12_1 != 1)
                {
                    goto label_40c93e;
                }
                esi = &data_41248c;
            label_40c8e7:
                ebx = 8;
            }
        }
    }
    else if (eax_2 == 0x4c)
    {
        ebx = 0x80;
    label_40c861:
        esi = &data_41248c;
        data_422ee0 = 1;
    }
    else if (eax_2 > 0x44)
    {
        uint32_t temp3_1 = eax_2;
        eax_2 = (eax_2 - 0x45);
        if (temp3_1 == 0x45)
        {
            ebx = 4;
            goto label_40c8bc;
        }
        int32_t eax_3 = (eax_2 - 1);
        eax_2 = (eax_3 - 1);
        if (eax_3 == 1)
        {
            data_422ee3 = 1;
            goto label_40ca02;
        }
        int32_t eax_4 = (eax_2 - 1);
        eax_2 = (eax_4 - 1);
        if (eax_4 != 1)
        {
            int32_t eax_5 = (eax_2 - 1);
            eax_2 = (eax_5 - 1);
            if (eax_5 != 1)
            {
                goto label_40c93e;
            }
            data_4226b7 = 1;
            goto label_40ca02;
        }
        ebx = 2;
    }
    else if (eax_2 == 0x44)
    {
        ebx = 1;
    }
    else
    {
        uint32_t temp7_1 = eax_2;
        eax_2 = (eax_2 - 0x20);
        if (temp7_1 == 0x20)
        {
            goto label_40ca02;
        }
        uint32_t temp11_1 = eax_2;
        eax_2 = (eax_2 - 0x21);
        if (temp11_1 != 0x21)
        {
            uint32_t temp14_1 = eax_2;
            eax_2 = (eax_2 - 1);
            if (temp14_1 != 1)
            {
                uint32_t temp15_1 = eax_2;
                eax_2 = (eax_2 - 1);
                if (temp15_1 != 1)
                {
                    goto label_40c93e;
                }
                ebx = 0x20;
                goto label_40c861;
            }
            data_4226b6 = 1;
            goto label_40ca02;
        }
        ebx = 0x10;
    }
    void* ecx_1;
    if (data_43332c != 0)
    {
        ecx_1 = data_433328;
    }
    else
    {
        eax_2 = sub_40ab10(u"MAKEFLAGS");
        data_43332c = eax_2;
        ecx_1 = *(eax_2 + 8);
        data_433328 = ecx_1;
    }
    if (arg2 == 0)
    {
        if (esi == 0x41248e)
        {
            *esi = (*esi & (!ebx));
            wchar16* eax_11 = wcschr(*(ecx_1 + 4), edi);
            if (eax_11 != 0)
            {
                wchar16 i;
                do
                {
                    i = eax_11[1];
                    *eax_11 = i;
                    eax_11 = &eax_11[1];
                } while (i != 0);
            }
            goto label_40c9e0;
        }
        goto label_40ca02;
    }
    eax_2 = *esi;
    eax_2 = (eax_2 | ebx);
    *esi = eax_2;
    if (edi == 0x51)
    {
        eax_2 = (eax_2 | 0x20);
        *esi = eax_2;
    }
    if (wcschr(*(ecx_1 + 4), edi) == 0)
    {
        int16_t* eax_10 = wcschr(*(data_433328 + 4), 0x20);
        if (eax_10 != 0)
        {
            *eax_10 = edi;
        }
    }
label_40c9e0:
    eax_2 = _wputenv_s(u"MAKEFLAGS", sub_40e917(u"                  "));
    if (eax_2 != 0)
    {
        eax_2 = sub_4053c9(data_4226a4, 0x41f);
    }
    goto label_40ca02;
}

int32_t sub_40ca03()
{
    signal(2, 1);
    signal(0xf, 1);
    if ((data_4333f8 != 0 && ((data_41248e & 4) == 0 && (data_41248c & 0x10) == 0)))
    {
        int32_t eax_1 = data_422ed4;
        if ((eax_1 != 0 && _waccess(eax_1, 0) != 0))
        {
            void** i = data_42269c;
            int32_t edi_1 = data_422ed4;
            int32_t eax_3;
            if (i != 0)
            {
                do
                {
                    eax_3 = _wcsicmp(i[1], edi_1);
                    if (eax_3 == 0)
                    {
                        break;
                    }
                    i = *i;
                } while (i != 0);
                if (eax_3 != 0)
                {
                    edi_1 = data_422ed4;
                }
            }
            if ((((i != 0 && eax_3 != 0) || i == 0) && _wunlink(edi_1) == 0))
            {
                int32_t var_c_4 = data_422ed4;
                sub_4053c9(data_4226a4, 0xfa8);
            }
        }
    }
    sub_4053c9(0, 0x422);
    /* tailcall */
    return sub_40cab3();
}

int32_t sub_40cab3()
{
    int32_t eax = _fcloseall();
    for (void** i = data_4333f4; i != 0; i = *i)
    {
        eax = _wunlink(i[1]);
        if ((data_41248e & 4) != 0)
        {
            int32_t var_8_2 = i[1];
            sub_40ce84(u"\tdel %s\n");
            eax = sub_40ce66();
        }
    }
    return eax;
}

int16_t* __fastcall sub_40caf1(int16_t* arg1)
{
    int16_t* edx = arg1;
    char ebx = 0;
    int16_t i;
    do
    {
        i = *edx;
        edx = &edx[1];
    } while (i != 0);
    int16_t* i_1 = &arg1[(-1 + ((edx - &edx[1]) >> 1))];
    if ((*arg1 == 0x22 && *i_1 == 0x22))
    {
        ebx = 1;
        goto label_40cb2d;
    }
    for (; i_1 > arg1; i_1 = (i_1 - 2))
    {
        uint32_t edx_3 = *i_1;
        if ((edx_3 != 0x20 && edx_3 != 0x2e))
        {
            break;
        }
    label_40cb2d:
    }
    if (ebx != 0)
    {
        i_1 = &i_1[1];
        *i_1 = 0x22;
    }
    i_1[1] = 0;
    return i_1;
}

void* __fastcall sub_40cb47(int32_t arg1)
{
    __security_cookie;
    void* esi = nullptr;
    HINSTANCE hModule;
    if (data_4372d4 != 0)
    {
        hModule = data_4372d8;
    }
    else
    {
        void var_414;
        void var_214;
        void var_10;
        _wsplitpath_s(*__p__wpgmptr(), &var_10, 3, &var_414, 0x100, &var_214, 0x100, 0, 0);
        void var_61c;
        _wmakepath_s(&var_61c, 0x104, &var_10, &var_414, 0, 0);
        int32_t eax_3 = wcsncat_s(&var_214, 0x100, u"UI.DLL", 0xffffffff);
        uint32_t eax_4;
        if (eax_3 == 0)
        {
            eax_4 = sub_40ac1d(&var_61c, &var_214);
            if (eax_4 >= 0)
            {
                hModule = data_4372d8;
            }
        }
        if ((eax_3 != 0 || (eax_3 == 0 && eax_4 < 0)))
        {
            hModule = nullptr;
            data_4372d8 = 0;
        }
        data_4372d4 = 1;
    }
    HRSRC hResInfo = FindResourceExW(hModule, 6, ((arg1 >> 4) + 1), data_4372dc);
    if (hResInfo != 0)
    {
        int32_t* edx_2 = LoadResource(hModule, hResInfo);
        if (edx_2 != 0)
        {
            int32_t i_1 = (arg1 & 0xf);
            if (i_1 != 0)
            {
                int32_t i;
                do
                {
                    edx_2 = ((edx_2 + (*edx_2 << 1)) + 2);
                    i = i_1;
                    i_1 = (i_1 - 1);
                } while (i != 1);
            }
            uint32_t esi_1 = *edx_2;
            int32_t esi_2 = (-esi_1);
            esi = ((esi_2 - esi_2) & (edx_2 + 2));
        }
    }
    CookieCheckFunction(esi);
    return esi;
}

int32_t sub_40cc68() __pure
{
    return 0x436648;
}

int32_t sub_40cc6e(int32_t arg1, int32_t arg2, int32_t arg3)
{
    int32_t eax = __stdio_common_vswprintf_s(data_436648, data_43664c, arg1, arg2, arg3, 0, &arg_10);
    if (eax < 0)
    {
        eax = 0xffffffff;
    }
    return eax;
}

int32_t __convention("regparm") sub_40cc9c(int32_t arg1, uint8_t* arg2, uint8_t* arg3, uint32_t arg4)
{
    int32_t eax_1;
    if (arg3 == 0)
    {
        *_errno() = 0x16;
        _invalid_parameter_noinfo();
        eax_1 = 0x16;
    }
    else
    {
        if ((arg2 == 0 || (arg2 != 0 && arg4 > 0x104)))
        {
            memset(arg3, 0, 0x104);
            int32_t var_10_2;
            int32_t* eax_2;
            if (arg2 == 0)
            {
                eax_2 = _errno();
                var_10_2 = 0x16;
            }
            else if (arg4 <= 0x104)
            {
                eax_1 = 0x16;
            }
            else
            {
                eax_2 = _errno();
                var_10_2 = 0x22;
            }
            if ((arg2 == 0 || (arg2 != 0 && arg4 > 0x104)))
            {
                *eax_2 = var_10_2;
                _invalid_parameter_noinfo();
                eax_1 = var_10_2;
            }
        }
        if ((arg2 != 0 && arg4 <= 0x104))
        {
            memcpy(arg3, arg2, arg4);
            eax_1 = 0;
        }
    }
    return eax_1;
}

int32_t sub_40cd16() __pure
{
    return 0x436658;
}

int32_t sub_40cd1c(int32_t arg1, int32_t arg2)
{
    return __stdio_common_vswscanf((data_436658 | 1), data_43665c, arg1, 0xffffffff, arg2, 0, &arg_c);
}

BOOL __fastcall sub_40cd46(FILE* arg1)
{
    FILE* lpMode = arg1;
    intptr_t eax_1 = _get_osfhandle(_fileno(arg1));
    BOOL eax_3 = (GetFileType(eax_1) & 0xffff7fff);
    if (eax_3 == 2)
    {
        GetConsoleMode(eax_1, &lpMode);
        eax_3 = 1;
    }
    if ((eax_3 != 2 || (eax_3 == 2 && eax_3 == 0)))
    {
        eax_3 = 0;
    }
    return eax_3;
}

int32_t sub_40cd86()
{
    if (data_4333fd == 0)
    {
        return fflush(__acrt_iob_func(2));
    }
    return 0;
}

int32_t sub_40cda4(int32_t arg1)
{
    /* tailcall */
    return sub_40ce1c(arg1, &arg_8);
}

uint32_t sub_40cdb3()
{
    int16_t eax;
    if (data_4333fd == 0)
    {
        eax = fputwc(0xa, __acrt_iob_func(2));
    }
    else
    {
        eax = _putwch(0xa);
    }
    return eax;
}

BOOL __fastcall sub_40cddf(FILE* arg1)
{
    int32_t eax_1 = _fileno(__acrt_iob_func(2));
    _dup2(_fileno(arg1), eax_1);
    BOOL eax_4 = sub_40cd46(__acrt_iob_func(2));
    data_4333fd = eax_4;
    return eax_4;
}

int32_t __fastcall sub_40ce1c(int32_t arg1, int32_t arg2)
{
    int32_t eax;
    if (data_4333fd == 0)
    {
        int32_t eax_1 = __acrt_iob_func(2);
        eax = __stdio_common_vfwprintf(data_436648, data_43664c, eax_1, arg1, 0, arg2);
    }
    else
    {
        eax = __conio_common_vcwprintf(data_436648, data_43664c, arg1, 0, arg2);
    }
    return eax;
}

int32_t sub_40ce66()
{
    if (data_4333fe == 0)
    {
        return fflush(__acrt_iob_func(1));
    }
    return 0;
}

int32_t sub_40ce84(int32_t arg1)
{
    /* tailcall */
    return sub_40cebf(arg1, &arg_8);
}

uint32_t sub_40ce93()
{
    int16_t eax;
    if (data_4333fe == 0)
    {
        eax = fputwc(0xa, __acrt_iob_func(1));
    }
    else
    {
        eax = _putwch(0xa);
    }
    return eax;
}

int32_t __fastcall sub_40cebf(int32_t arg1, int32_t arg2)
{
    int32_t eax;
    if (data_4333fe == 0)
    {
        int32_t eax_1 = __acrt_iob_func(1);
        eax = __stdio_common_vfwprintf(data_436648, data_43664c, eax_1, arg1, 0, arg2);
    }
    else
    {
        eax = __conio_common_vcwprintf(data_436648, data_43664c, arg1, 0, arg2);
    }
    return eax;
}

int32_t sub_40cf09()
{
    void* eax = data_412028;
    data_422ee2 = 1;
    *(eax + 0x433311) = 0x17;
    data_412028 = (eax + 2);
    if ((eax + 2) >= 0x10)
    {
        ___report_rangecheckfailure();
        breakpoint();
    }
    *(eax + 0x433312) = 0;
    data_4226b0 = data_4226a4;
    int32_t eax_3;
    int32_t ecx;
    uint32_t i_1;
    eax_3 = sub_409b60(ecx, 0);
    void* edx_1 = data_412028;
    *i_1[1] = eax_3;
    int16_t ebx;
    *ebx[1] = 0;
    char var_5 = *i_1[1];
    i_1 = *(edx_1 + 0x433310);
    ebx = i_1;
    if (ebx != 0x17)
    {
        do
        {
            if ((ebx & 0x40) != 0)
            {
                data_412028 = (edx_1 - 1);
                eax_3 = &data_401460[(i_1 & 0xf)]();
            }
            if ((((ebx & 0x40) == 0 && (ebx & 0x10) != 0) && ebx != *i_1[1]))
            {
                int32_t var_20_1 = 0x4226c0;
                eax_3 = sub_4053c9(data_4226b0, 0x409);
            }
            if (((ebx & 0x40) != 0 || (((ebx & 0x40) == 0 && (ebx & 0x10) != 0) && ebx != *i_1[1])))
            {
                edx_1 = data_412028;
            }
            if ((ebx & 0x40) == 0)
            {
                if (((ebx & 0x10) != 0 && ebx == *i_1[1]))
                {
                    i_1 = *(edx_1 + 0x43330f);
                    edx_1 = (edx_1 - 1);
                    data_412028 = edx_1;
                    if ((i_1 & 0x40) != 0)
                    {
                        data_412028 = (edx_1 - 1);
                        i_1 = &data_401460[(i_1 & 0xf)]();
                        edx_1 = data_412028;
                    }
                    eax_3 = data_4226a4;
                    data_4226b0 = eax_3;
                    if (*ebx[1] == 0)
                    {
                        edx_1 = *(edx_1 + 0x433310);
                        char eax_10;
                        eax_10 = sub_409b60(i_1, edx_1);
                        edx_1 = data_412028;
                        *i_1[1] = eax_10;
                        eax_3 = data_4226a4;
                        var_5 = *i_1[1];
                        data_4226b0 = eax_3;
                    }
                    else
                    {
                        if (data_4226c0 == 0xa)
                        {
                            eax_3 = (eax_3 - 1);
                            data_4226b0 = eax_3;
                        }
                        *i_1[1] = *ebx[1];
                        *ebx[1] = 0;
                        var_5 = *i_1[1];
                    }
                }
                if ((ebx & 0x10) == 0)
                {
                    uint32_t esi_1 = ebx;
                    eax_3 = *(((*i_1[1] & 0xf) + (esi_1 << 3)) + 0x4014a0);
                    if ((eax_3 & 0x20) != 0)
                    {
                        int32_t var_20_2 = 0x4226c0;
                        i_1 = sub_4053c9(data_4226b0, (eax_3 + 0x3e8));
                        edx_1 = data_412028;
                    }
                    edx_1 = (edx_1 - 1);
                    data_412028 = edx_1;
                    if (eax_3 < 0)
                    {
                        if (*ebx[1] == 0)
                        {
                            edx_1 = ebx;
                            char eax_15 = sub_409b60(i_1, edx_1);
                            edx_1 = data_412028;
                            *ebx[1] = eax_15;
                        }
                        eax_3 = ((eax_3 & 0xf) + *(((*ebx[1] & 0xf) + (esi_1 << 3)) + 0x401480));
                    }
                    char* esi_2 = &data_4014e0[eax_3];
                    i_1 = *esi_2;
                    if (i_1 != 0)
                    {
                        uint32_t i;
                        do
                        {
                            eax_3 = esi_2[i_1];
                            edx_1 = (edx_1 + 1);
                            *(edx_1 + 0x433310) = eax_3;
                            i = i_1;
                            i_1 = (i_1 - 1);
                        } while (i != 1);
                        data_412028 = edx_1;
                    }
                }
            }
            if ((((ebx & 0x40) != 0 || (((ebx & 0x40) == 0 && (ebx & 0x10) != 0) && ebx != *i_1[1])) || ((ebx & 0x40) == 0 && (ebx & 0x10) == 0)))
            {
                *i_1[1] = var_5;
            }
            i_1 = *(edx_1 + 0x433310);
            ebx = i_1;
        } while (ebx != 0x17);
    }
    data_412028 = (edx_1 - 1);
    return eax_3;
}

int32_t __fastcall sub_40d0ed(int32_t arg1, int16_t* arg2)
{
    int32_t eax;
    do
    {
        eax = *arg2;
        arg2 = &arg2[1];
    } while (eax != 0);
    int32_t esi_1 = (((arg2 - &arg2[1]) >> 1) + arg1);
    bool c = 0x28 < esi_1;
    if (c)
    {
        eax = sub_40ce84(u"\n\t\t\t");
        c = 0x28 < esi_1;
    }
    return ((!(eax - eax)) & esi_1);
}

uint32_t __thiscall sub_40d121(int32_t arg1, int32_t arg2, int32_t arg3)
{
    __security_cookie;
    uint32_t eax_5;
    int32_t edx;
    if ((arg2 | arg3) == 0)
    {
        int32_t var_70 = edx;
        int32_t var_74 = 0x20;
        int32_t var_78_1 = (arg1 + 0x1a);
        eax_5 = sub_4054a3(6);
    }
    else
    {
        void var_60;
        eax_5 = FileTimeToLocalFileTime(&arg2, &var_60);
        if (eax_5 != 0)
        {
            void var_58;
            eax_5 = FileTimeToSystemTime(&var_60, &var_58);
            if (eax_5 != 0)
            {
                void lpDateStr;
                eax_5 = GetDateFormatW(0x400, 0, &var_58, u"ddd, MMM dd yyyy", &lpDateStr, 0x14);
                if (eax_5 != 0)
                {
                    void lpTimeStr;
                    eax_5 = GetTimeFormatW(0x400, 0, &var_58, u"HH:mm:ss", &lpTimeStr, 0xc);
                    if (eax_5 != 0)
                    {
                        int32_t var_70_3 = edx;
                        int32_t var_74_5 = 0x20;
                        int32_t var_78_2 = arg1;
                        void* var_7c_3 = &lpTimeStr;
                        void* var_80_1 = &lpDateStr;
                        eax_5 = sub_4054a3(4);
                    }
                }
            }
        }
    }
    CookieCheckFunction(eax_5);
    return eax_5;
}

uint32_t __fastcall sub_40d1db(void** arg1, int32_t arg2)
{
    __security_cookie;
    void** i = arg1;
    void** i_1 = arg1;
    int32_t var_270 = arg2;
    uint32_t j = sub_4054a3(0xc);
    uint32_t j_3 = 0;
    uint32_t j_4 = 0;
    while (i != 0)
    {
        wchar16* eax_2;
        int32_t* edx;
        eax_2 = wcschr(i[1], 0x24);
        int32_t* var_264;
        void var_25c;
        if (eax_2 == 0)
        {
            int32_t eax_10 = wcspbrk(i[1], &data_40103c);
            if (eax_10 == 0)
            {
                int32_t var_288_11 = i[1];
                sub_40ce84(&data_402608);
                j = sub_40d0ed(j_3, i[1]);
                j_3 = j;
            }
            else
            {
                j = sub_407a1b(i[1], &var_25c, &var_264);
                if (j != 0)
                {
                    do
                    {
                        int32_t eax_11 = sub_40ff31(i[1], j);
                        int32_t var_288_9 = eax_11;
                        sub_40ce84(&data_402608);
                        j_3 = sub_40d0ed(j_3, eax_11);
                        free(eax_11);
                        j = sub_407ba7(&var_25c, var_264);
                    } while (j != 0);
                }
            }
            if ((eax_10 == 0 || (eax_10 != 0 && j != 0)))
            {
                j_4 = j_3;
            }
        }
        else
        {
            int16_t* ecx_2 = i[1];
            int32_t var_268 = 0;
            edx = 1;
            int32_t eax_3 = sub_40f30f(ecx_2, edx, &var_270);
            int32_t j_1 = wcstok_s(eax_3, &data_401044, &var_268);
            if (j_1 != 0)
            {
                uint32_t j_5 = j_4;
                do
                {
                    if (wcspbrk(j_1, &data_40103c) == 0)
                    {
                        int32_t j_2 = j_1;
                        sub_40ce84(&data_402608);
                        j_5 = sub_40d0ed(j_5, j_1);
                    }
                    else
                    {
                        for (uint32_t k = sub_407a1b(j_1, &var_25c, &var_264); k != 0; k = sub_407ba7(&var_25c, var_264))
                        {
                            int32_t eax_6 = sub_40ff31(j_1, k);
                            int32_t var_288_4 = eax_6;
                            sub_40ce84(&data_402608);
                            j_5 = sub_40d0ed(j_5, eax_6);
                            free(eax_6);
                        }
                    }
                    j_1 = wcstok_s(0, &data_401044, &var_268);
                } while (j_1 != 0);
                j_4 = j_5;
                i = i_1;
            }
            j = free(eax_3);
            j_3 = j_4;
        }
        i = *i;
        i_1 = i;
    }
    CookieCheckFunction(j);
    return j;
}

int32_t sub_40d3e4()
{
    sub_4054a3(8);
    int32_t* i = &data_432f10;
    do
    {
        for (void** j = *i; j != 0; j = *j)
        {
            void* eax_1 = j[2];
            if ((eax_1 != 0 && *(eax_1 + 4) != 0))
            {
                int32_t var_10_1 = *(eax_1 + 4);
                int32_t var_14_1 = j[1];
                sub_4054a3(0xe);
                for (void** k = *j[2]; k != 0; k = *k)
                {
                    if (k[1] != 0)
                    {
                        int32_t var_10_2 = k[1];
                        sub_40ce84(u"\t\t%s\n");
                    }
                }
            }
        }
        i = &i[1];
    } while (i < 0x433310);
    sub_40ce93();
    /* tailcall */
    return sub_40ce66();
}

int32_t sub_40d455()
{
    sub_4054a3(7);
    void** i = data_422694;
    if (i != 0)
    {
        do
        {
            void* const eax_1 = u"%s::";
            if (i[5] == 0)
            {
                eax_1 = &data_402628;
            }
            int32_t var_c_1 = i[2];
            sub_40ce84(eax_1);
            sub_4054a3(0xa);
            void** edi_1 = i[3];
            if (edi_1 != 0)
            {
                int32_t var_c_2 = edi_1[1];
                void* const var_10_2 = &data_402630;
                while (true)
                {
                    sub_40ce84(var_10_2);
                    edi_1 = *edi_1;
                    if (edi_1 == 0)
                    {
                        break;
                    }
                    var_c_2 = edi_1[1];
                    var_10_2 = u"\t\t\t%s\n";
                }
            }
            sub_40ce93();
            i = *i;
        } while (i != 0);
    }
    void* const __saved_edi = u".SUFFIXES";
    sub_40ce84(u"%s: ");
    for (void** i_1 = data_4226a0; i_1 != 0; i_1 = *i_1)
    {
        __saved_edi = i_1[1];
        sub_40ce84(&data_402608);
    }
    sub_40ce93();
    /* tailcall */
    return sub_40ce66();
}

int32_t sub_40d4f5()
{
    sub_4054a3(9);
    void* i = nullptr;
    void* i_1 = nullptr;
    do
    {
        void** j = *(i + 0x422490);
        void** j_1 = j;
        if (j != 0)
        {
            do
            {
                void* eax_2;
                eax_2 = *(*(j[6] + 4) + 0x10);
                eax_2 = (eax_2 & 0x20);
                uint32_t eax_3 = eax_2;
                int32_t eax_4 = (-eax_3);
                int32_t var_24_1 = (((eax_4 - eax_4) & 0x1a) + 0x20);
                int32_t var_28_1 = j[1];
                sub_40ce84(u"%s:%c");
                int32_t eax_8 = j[1];
                void** k = j[6];
                data_422ec8 = eax_8;
                data_422ed4 = eax_8;
                data_422ed8 = eax_8;
                if (k != 0)
                {
                    do
                    {
                        int32_t* edi_1 = k[1];
                        sub_4054a3(0xb);
                        void* const esi_1 = u"dinsb";
                        int32_t eax_9 = 1;
                        int32_t var_14_1 = 1;
                        do
                        {
                            if ((edi_1[4] & eax_9) != 0)
                            {
                                uint32_t var_24_2 = *esi_1;
                                sub_40ce84(u"-%c ");
                                eax_9 = var_14_1;
                            }
                            eax_9 = (eax_9 * 2);
                            esi_1 = (esi_1 + 2);
                            var_14_1 = eax_9;
                        } while (eax_9 < 0x10);
                        sub_40d1db(*edi_1, edi_1[1]);
                        sub_4054a3(0xa);
                        void** edi_2 = edi_1[2];
                        if (edi_2 == 0)
                        {
                            sub_40ce93();
                        }
                        else
                        {
                            void* const var_28_2;
                            int32_t var_24_3;
                            if (edi_2[1] != 0)
                            {
                                var_24_3 = edi_2[1];
                                var_28_2 = &data_402630;
                                goto label_40d5dc;
                            }
                            while (true)
                            {
                                edi_2 = *edi_2;
                                if (edi_2 == 0)
                                {
                                    break;
                                }
                                if (edi_2[1] != 0)
                                {
                                    var_24_3 = edi_2[1];
                                    var_28_2 = u"\t\t\t%s\n";
                                label_40d5dc:
                                    sub_40ce84(var_28_2);
                                }
                            }
                        }
                        k = *k;
                    } while (k != 0);
                    j = j_1;
                }
                j = *j;
                j_1 = j;
                sub_40ce93();
            } while (j != 0);
            i = i_1;
        }
        i = (i + 4);
        i_1 = i;
    } while (i < 0x200);
    sub_40ce93();
    int32_t eax_11 = sub_40ce66();
    data_422ec8 = 0;
    data_422ed4 = 0;
    data_422ed8 = 0;
    return eax_11;
}

uint32_t __stdcall sub_40d64a(char arg1)
{
    char* edi = data_433610;
    int32_t eax;
    eax = *edi;
    data_433610 = &edi[0xfffffff8];
    if (eax != 0x16)
    {
        if (eax != 0x17)
        {
        label_40d846:
            eax = 0;
        }
        else
        {
            if (edi[0xfffffff8] != eax)
            {
                goto label_40d846;
            }
            int16_t* ecx_6 = *(edi + 4);
            int16_t* eax_11 = *(edi - 4);
            int32_t ecx_8;
            while (true)
            {
                int16_t edx = *eax_11;
                int16_t temp2_1 = *ecx_6;
                bool c_2 = edx < temp2_1;
                if (edx == temp2_1)
                {
                    int16_t temp5_1;
                    if (edx != 0)
                    {
                        edx = eax_11[1];
                        temp5_1 = ecx_6[1];
                        c_2 = edx < temp5_1;
                        if (edx == temp5_1)
                        {
                            eax_11 = &eax_11[2];
                            ecx_6 = &ecx_6[2];
                            if (edx != 0)
                            {
                                continue;
                            }
                        }
                    }
                    if ((edx == 0 || (edx != 0 && edx == temp5_1)))
                    {
                        ecx_8 = 0;
                        break;
                    }
                }
                ecx_8 = ((ecx_6 - ecx_6) | 1);
                break;
            }
            uint32_t eax_12 = arg1;
            if (eax_12 == 6)
            {
                eax = ecx_8 != 0;
            }
            else if (eax_12 == 7)
            {
                eax = ecx_8 == 0;
            }
            else if (eax_12 == 8)
            {
                eax = ecx_8 > 0;
            }
            else
            {
                int32_t eax_19;
                if (eax_12 == 9)
                {
                    eax_19 = ecx_8;
                }
                if (eax_12 == 0xa)
                {
                    eax_19 = (!ecx_8);
                }
                if ((eax_12 == 9 || eax_12 == 0xa))
                {
                    eax = (eax_19 >> 0x1f);
                }
                if ((eax_12 != 9 && eax_12 != 0xa))
                {
                    if (eax_12 != 0xb)
                    {
                        goto label_40d846;
                    }
                    eax = ecx_8 <= 0;
                }
            }
            *(edi - 4) = eax;
            edi[0xfffffff8] = 0x16;
        label_40d842:
            eax = 1;
        }
        return eax;
    }
    if (edi[0xfffffff8] != eax)
    {
        goto label_40d846;
    }
    if ((arg1 - 1) > 0x11)
    {
        goto label_40d846;
    }
    int32_t ecx_1;
    switch (arg1)
    {
        case 1:
        {
            eax = 0;
            break;
        }
        case 2:
        {
            eax = 0;
            if (*(edi - 4) == 0)
            {
                goto label_40d7a4;
            }
            break;
        }
        case 3:
        {
            *(edi - 4) = (*(edi - 4) | *(edi + 4));
            break;
        }
        case 4:
        {
            *(edi - 4) = (*(edi - 4) ^ *(edi + 4));
            break;
        }
        case 5:
        {
            *(edi - 4) = (*(edi - 4) & *(edi + 4));
            break;
        }
        case 6:
        {
            ecx_1 = *(edi + 4) != *(edi - 4);
            break;
        }
        case 8:
        {
            ecx_1 = *(edi - 4) > *(edi + 4);
            break;
        }
        case 9:
        {
            ecx_1 = *(edi - 4) < *(edi + 4);
            break;
        }
        case 0xa:
        {
            ecx_1 = *(edi - 4) >= *(edi + 4);
            break;
        }
        case 0xb:
        {
            ecx_1 = *(edi - 4) <= *(edi + 4);
            break;
        }
        case 0xc:
        {
            *(edi - 4) = (*(edi - 4) >> *(edi + 4));
            break;
        }
        case 0xd:
        {
            *(edi - 4) = (*(edi - 4) << *(edi + 4));
            break;
        }
        case 0xe:
        {
            *(edi - 4) = (*(edi - 4) - *(edi + 4));
            break;
        }
        case 0xf:
        {
            *(edi - 4) = (*(edi - 4) + *(edi + 4));
            break;
        }
        case 0x10:
        {
            int32_t ecx_4 = *(edi + 4);
            if (ecx_4 == 0)
            {
                sub_4053c9(data_4226a4, 0x437);
                ecx_4 = *(edi + 4);
            }
            int32_t eax_7;
            int32_t edx_1;
            edx_1 = HIGHD(*(edi - 4));
            eax_7 = LOWD(*(edi - 4));
            *(edi - 4) = (COMBINE(edx_1, eax_7) % ecx_4);
            break;
        }
    }
    if (((((arg1 == 6 || arg1 == 8) || arg1 == 9) || arg1 == 0xa) || arg1 == 0xb))
    {
        *(edi - 4) = ecx_1;
    }
    if (((arg1 == 1 && *(edi - 4) != 0) || (((arg1 == 1 && *(edi - 4) == 0) || arg1 == 2) && *(edi + 4) != 0)))
    {
        eax = 1;
        goto label_40d7a4;
    }
    if ((((arg1 == 1 && *(edi - 4) == 0) || arg1 == 2) && *(edi + 4) == 0))
    {
        goto label_40d7a4;
    }
    if (arg1 == 7)
    {
        int32_t eax_3 = (*(edi + 4) - *(edi - 4));
        int32_t eax_4 = (-eax_3);
        eax = ((eax_4 - eax_4) + 1);
    label_40d7a4:
        *(edi - 4) = eax;
    }
    if (arg1 == 0x12)
    {
        eax = (*(edi - 4) * *(edi + 4));
        goto label_40d7a4;
    }
    if (arg1 == 0x11)
    {
        int32_t ecx_5 = *(edi + 4);
        if (ecx_5 == 0)
        {
            sub_4053c9(data_4226a4, 0x437);
            ecx_5 = *(edi + 4);
        }
        int32_t eax_9;
        int32_t edx_3;
        edx_3 = HIGHD(*(edi - 4));
        eax_9 = LOWD(*(edi - 4));
        eax = (COMBINE(edx_3, eax_9) / ecx_5);
        goto label_40d7a4;
    }
    goto label_40d842;
}

int32_t __stdcall sub_40d89a(char arg1)
{
    char* ecx = data_433610;
    int32_t eax;
    uint32_t eax_1;
    if (*ecx == 0x16)
    {
        eax_1 = arg1;
        if (eax_1 == 0x13)
        {
            *(ecx + 4) = (-*(ecx + 4));
        }
        if (eax_1 == 0x14)
        {
            *(ecx + 4) = (!*(ecx + 4));
        }
        if (eax_1 == 0x15)
        {
            eax = *(ecx + 4) == (eax_1 - 0x15);
            *(ecx + 4) = eax;
        }
        if (((eax_1 == 0x13 || eax_1 == 0x14) || eax_1 == 0x15))
        {
            eax = 1;
        }
    }
    if ((*ecx != 0x16 || (((*ecx == 0x16 && eax_1 != 0x13) && eax_1 != 0x14) && eax_1 != 0x15)))
    {
        eax = 0;
    }
    return eax;
}

void* sub_40d8d8()
{
    void* esi_1 = (data_433614 + 2);
    int16_t* ecx = esi_1;
    data_433614 = ecx;
    int16_t i_2 = *ecx;
    if (i_2 != 0)
    {
        void* edx_1 = esi_1;
        int16_t i_1 = i_2;
        int16_t i;
        do
        {
            if (i_1 == 0x22)
            {
                edx_1 = &ecx[1];
                if (*edx_1 != 0x22)
                {
                    break;
                }
            }
            ecx = (edx_1 + 2);
            data_433614 = ecx;
            edx_1 = ecx;
            i = *ecx;
            i_1 = i;
        } while (i != 0);
    }
    if ((i_2 == 0 || (i_2 != 0 && *ecx == 0)))
    {
        int32_t var_10_1 = 0x22;
        sub_4053c9(data_4226a4, 0x3fe);
        ecx = data_433614;
    }
    *ecx = 0;
    data_433614 = (data_433614 + 2);
    return esi_1;
}

int16_t* sub_40d94f()
{
    int16_t* edi_1 = (data_433614 + 2);
    int16_t* ecx = edi_1;
    data_433614 = ecx;
    int16_t i_2 = *ecx;
    if (i_2 != 0)
    {
        int16_t* ebx_1 = edi_1;
        int16_t i_1 = i_2;
        int16_t i;
        do
        {
            void* edx_1;
            if (i_1 == 0x5e)
            {
                edx_1 = &ecx[1];
                if (*edx_1 == 0x5d)
                {
                    void* ecx_1 = (edx_1 + 2);
                    int16_t j;
                    do
                    {
                        j = *edx_1;
                        edx_1 = (edx_1 + 2);
                    } while (j != 0);
                    memmove(ebx_1, &ebx_1[1], ((((edx_1 - ecx_1) >> 1) << 1) + 2));
                    ecx = data_433614;
                }
            }
            if (((i_1 != 0x5e || (i_1 == 0x5e && *edx_1 != 0x5d)) && i_1 == 0x5d))
            {
                break;
            }
            ecx = &ecx[1];
            data_433614 = ecx;
            ebx_1 = ecx;
            i = *ecx;
            i_1 = i;
        } while (i != 0);
    }
    if ((i_2 == 0 || (i_2 != 0 && *ecx == 0)))
    {
        int32_t var_10_2 = 0x5d;
        sub_4053c9(data_4226a4, 0x3fe);
        ecx = data_433614;
    }
    *ecx = 0;
    data_433614 = (data_433614 + 2);
    return edi_1;
}

uint32_t __fastcall sub_40da07(int32_t arg1, int32_t arg2)
{
    int32_t var_4 = arg1;
    int16_t ebx;
    *ebx[1] = arg1;
    if (*ebx[1] == 0x19)
    {
        ebx = 3;
    }
    else if (*ebx[1] == 0)
    {
        ebx = 4;
    }
    else if (*ebx[1] <= 0x15)
    {
        ebx = *ebx[1] > 0x12;
        ebx = (ebx + 1);
    }
    else
    {
        ebx = 0;
    }
    uint32_t eax_1 = ebx;
    if (*(((data_4333ff * 5) + eax_1) + 0x401570) == 0)
    {
        eax_1 = sub_4053c9(data_4226a4, 0x3ff);
    }
    data_433608 = arg2;
    data_4333ff = ebx;
    data_433603 = *ebx[1];
    data_433604 = *ebx[1];
    return eax_1;
}

int16_t* sub_40da75()
{
    int32_t ecx;
    int32_t var_8 = ecx;
    int16_t* eax = data_433614;
    while (true)
    {
        int16_t ecx_1 = *eax;
        if ((ecx_1 != 0x20 && ecx_1 != 9))
        {
            if (ecx_1 != 0x28)
            {
                sub_4053c9(data_4226a4, 0x3ff);
                eax = data_433614;
            }
            int16_t ecx_3;
            while (true)
            {
                eax = &eax[1];
                data_433614 = eax;
                ecx_3 = *eax;
                if (ecx_3 == 0x20)
                {
                    continue;
                }
                if ((ecx_3 != 0x20 && ecx_3 != 9))
                {
                    break;
                }
                if (ecx_3 != 9)
                {
                    /* nop */
                }
            }
            int16_t* var_8_1 = eax;
            int16_t* edi_2;
            if (ecx_3 != 0x22)
            {
                int16_t* ebx_1 = eax;
                while (true)
                {
                    int16_t esi_1 = *eax;
                    eax = &eax[1];
                    data_433614 = eax;
                    if (esi_1 == 0)
                    {
                        sub_4053c9(data_4226a4, 0x3ff);
                        eax = data_433614;
                    }
                    if (esi_1 == 0x29)
                    {
                        break;
                    }
                    if ((esi_1 != 0x20 && esi_1 != 9))
                    {
                        ebx_1 = eax;
                    }
                }
                edi_2 = var_8_1;
                *ebx_1 = 0;
            }
            else
            {
                int16_t* eax_1 = sub_40d8d8();
                int16_t* ecx_4 = data_433614;
                edi_2 = eax_1;
                int16_t edx_1;
                while (true)
                {
                    edx_1 = *ecx_4;
                    if ((edx_1 != 0x20 && edx_1 != 9))
                    {
                        break;
                    }
                    ecx_4 = &ecx_4[1];
                    data_433614 = ecx_4;
                }
                if (edx_1 != 0x29)
                {
                    sub_4053c9(data_4226a4, 0x3ff);
                    ecx_4 = data_433614;
                }
                data_433614 = &ecx_4[1];
            }
            return edi_2;
        }
        eax = &eax[1];
        data_433614 = eax;
    }
}

int32_t sub_40db82()
{
    int16_t* ecx = data_433614;
    while (true)
    {
        uint32_t esi_1 = *ecx;
        if ((esi_1 != 0x20 && esi_1 != 9))
        {
            void** edi;
            if ((esi_1 >= 0x80 || (esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) == 0)))
            {
                edi = &data_412118;
            }
            void* i;
            if ((esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) != 0))
            {
                i = data_412070;
                edi = &data_412070;
                if (i != 0)
                {
                    int16_t* ebx_1;
                    do
                    {
                        int16_t j_1 = *i;
                        ebx_1 = ecx;
                        if (j_1 != 0)
                        {
                            int16_t j = j_1;
                            while (*ebx_1 == j)
                            {
                                i = (i + 2);
                                ebx_1 = &ebx_1[1];
                                int16_t j_2 = *i;
                                j = j_2;
                                if (j_2 == 0)
                                {
                                    break;
                                }
                            }
                            ecx = data_433614;
                        }
                        if (*i == 0)
                        {
                            break;
                        }
                        edi = &edi[2];
                        i = *edi;
                    } while (i != 0);
                    if (*i == 0)
                    {
                        ecx = ebx_1;
                        data_433614 = ecx;
                    }
                }
            }
            void* edx_1;
            if (((((esi_1 >= 0x80 || (esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) == 0)) || (((esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) != 0) && i != 0) && *i == 0)) || ((esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) != 0) && i == 0)) && *edi != 0))
            {
                ecx = edi[1];
                edx_1 = nullptr;
            }
            if ((((((esi_1 >= 0x80 || (esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) == 0)) || (((esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) != 0) && i != 0) && *i == 0)) || ((esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) != 0) && i == 0)) && *edi == 0) || (((esi_1 < 0x80 && (*(esi_1 + 0x401060) & 2) != 0) && i != 0) && *i != 0)))
            {
                if (esi_1 == 0x2d)
                {
                    bool cond:0_1 = data_433603 != 0x16;
                    data_433614 = &ecx[1];
                    ecx = cond:0_1;
                    ecx = (ecx - 1);
                    ecx = (ecx & 0xfb);
                    ecx = (ecx + 0x13);
                    edx_1 = nullptr;
                }
                else if (esi_1 == 0x22)
                {
                    void* eax_3;
                    eax_3 = sub_40d8d8();
                    edx_1 = eax_3;
                    ecx = 0x17;
                }
                else if (esi_1 == 0x5b)
                {
                    int16_t* eax_4;
                    eax_4 = sub_40d94f();
                    edx_1 = eax_4;
                    ecx = 0x18;
                }
                else
                {
                    int32_t eax_5 = iswdigit(esi_1);
                    if (eax_5 == 0)
                    {
                        if (esi_1 == 0)
                        {
                            edx_1 = nullptr;
                            data_433602 = 1;
                            ecx = 0;
                        }
                        else if (_wcsnicmp(data_433614, u"DEFINED", 7) == 0)
                        {
                            data_433614 = (data_433614 + 0xe);
                            char eax_14;
                            eax_14 = sub_40dff1(sub_40da75());
                            edx_1 = eax_14;
                        }
                        else
                        {
                            if (_wcsnicmp(data_433614, u"EXISTS", 6) == 0)
                            {
                                data_433614 = (data_433614 + 0xc);
                            }
                            else
                            {
                                if (_wcsnicmp(data_433614, u"EXIST", 5) != 0)
                                {
                                    return sub_4053c9(data_4226a4, 0x3ff);
                                }
                                data_433614 = (data_433614 + 0xa);
                            }
                            int32_t eax_17 = _waccess(sub_40da75(), 0);
                            int32_t eax_18 = (-eax_17);
                            edx_1 = ((eax_18 - eax_18) + 1);
                        }
                    }
                    else
                    {
                        int32_t ebx_2 = data_433614;
                        *_errno() = 0;
                        void* edi_1 = wcstol(data_433614, 0x433614, 0);
                        if (*_errno() == 0x22)
                        {
                            int32_t var_10_2 = ebx_2;
                            int32_t var_18_2 = data_4226a4;
                            **&data_433614 = 0;
                            sub_4053c9(var_18_2, 0x436);
                        }
                        if (towupper(**&data_433614) == 0x4c)
                        {
                            data_433614 = (data_433614 + 2);
                        }
                        edx_1 = edi_1;
                    }
                    if ((eax_5 != 0 || (eax_5 == 0 && esi_1 != 0)))
                    {
                        ecx = 0x16;
                    }
                }
            }
            /* tailcall */
            return sub_40da07(ecx, edx_1);
        }
        ecx = &ecx[1];
        data_433614 = ecx;
    }
}

int32_t sub_40de60()
{
    int32_t* ecx = data_433610;
    if (ecx < 0x435620)
    {
        sub_4053c9(data_4226a4, 0x3ff);
        ecx = data_433610;
    }
    int32_t* edx = data_43360c;
    if (edx > 0x435618)
    {
        sub_4053c9(data_4226a4, 0x412);
        edx = data_43360c;
        ecx = data_433610;
    }
    *edx = *ecx;
    int32_t eax_1 = ecx[1];
    edx[1] = eax_1;
    data_43360c = &edx[2];
    data_433610 = (ecx - 8);
    return eax_1;
}

int32_t sub_40ded1()
{
    data_43360c = 0x433620;
    data_433610 = 0x435620;
    int32_t ecx;
    ecx = 0x19;
    data_433602 = 0;
    data_4333ff = 3;
    data_433603 = 0x19;
    sub_40da07(ecx, 0);
    int32_t* ecx_1 = data_433610;
    *ecx_1 = *data_433604;
    while (true)
    {
        ecx_1[1] = data_433608;
        while (true)
        {
            int32_t eax_1;
            int32_t edx;
            if (data_433602 != 0)
            {
                if (ecx_1 != 0x435618)
                {
                    eax_1 = sub_4053c9(data_4226a4, 0x3ff);
                }
                char* ecx_4 = data_433610;
                int32_t esi;
                int32_t var_4 = esi;
                char* i = &data_433620;
                if (data_43360c > 0x433620)
                {
                    do
                    {
                        eax_1 = *i;
                        if (eax_1 <= 0x15)
                        {
                            int32_t (__stdcall* ecx_6)(char arg1) = sub_40d89a;
                            if (eax_1 <= 0x12)
                            {
                                ecx_6 = sub_40d64a;
                            }
                            eax_1 = ecx_6(eax_1);
                            if (eax_1 == 0)
                            {
                                eax_1 = sub_4053c9(data_4226a4, 0x438);
                            }
                            ecx_4 = data_433610;
                        }
                        else
                        {
                            ecx_4 = &ecx_4[8];
                            data_433610 = ecx_4;
                            if (eax_1 != 0x18)
                            {
                                *ecx_4 = *i;
                                *(ecx_4 + 4) = *(i + 4);
                            }
                            else
                            {
                                edx = 0;
                                eax_1 = sub_406e64(*(i + 4), edx, 1, 0, nullptr);
                                ecx_4 = data_433610;
                                *(ecx_4 + 4) = eax_1;
                                *ecx_4 = 0x16;
                            }
                        }
                        i = &i[8];
                    } while (i < data_43360c);
                }
                if ((ecx_4 == 0x435620 && *ecx_4 == 0x16))
                {
                    eax_1 = *(ecx_4 + 4) != 0;
                    return eax_1;
                }
                sub_4053c9(data_4226a4, 0x3ff);
                int32_t eax_4;
                eax_4 = 0;
                return eax_4;
            }
            sub_40db82();
            edx = *data_433604;
            char* ecx_2 = data_433610;
            if (edx != 0x19)
            {
                char ebx;
                while (true)
                {
                    ebx = *(edx + 0x401590);
                    if (ebx > *(*ecx_2 + 0x401590))
                    {
                        break;
                    }
                    if (ebx == 0)
                    {
                        break;
                    }
                    sub_40de60();
                    edx = *data_433604;
                    ecx_2 = data_433610;
                }
                if (ebx <= *(*ecx_2 + 0x401590))
                {
                    while (*ecx_2 != 0x19)
                    {
                        eax_1 = sub_40de60();
                        ecx_2 = data_433610;
                    }
                    if (ecx_2 < 0x435620)
                    {
                        eax_1 = sub_4053c9(data_4226a4, 0x3ff);
                        ecx_2 = data_433610;
                    }
                    ecx_1 = (ecx_2 - 8);
                    data_433610 = ecx_1;
                    continue;
                }
            }
            if (ecx_2 != 0x436618)
            {
                ecx_1 = &ecx_2[8];
                data_433610 = ecx_1;
                *ecx_1 = edx;
                break;
            }
            eax_1 = sub_4053c9(data_4226a4, 0x412);
            ecx_1 = data_433610;
        }
    }
}

void* __fastcall sub_40dff1(int32_t arg1)
{
    int32_t var_8 = arg1;
    int32_t var_c = arg1;
    var_8 = 0;
    int32_t eax = wcstok_s(arg1, &data_401044, &var_8);
    if (wcstok_s(0, &data_401044, &var_8) != 0)
    {
        int32_t var_18_2 = eax;
        sub_4053c9(data_4226a4, 0x409);
    }
    if (eax == 0)
    {
        sub_4053c9(data_4226a4, 0x417);
    }
    void* eax_2;
    eax_2 = sub_40ab10(eax) != 0;
    return eax_2;
}

void* __fastcall sub_40e060(int16_t* arg1, char arg2)
{
    int16_t* var_4 = arg1;
    if (*arg1 == 0)
    {
        sub_4053c9(data_4226a4, 0x3fa);
    }
    uint32_t eax = arg2;
    void* eax_5;
    if ((eax == 4 || eax == 6))
    {
        eax_5 = sub_40dff1(arg1);
    }
    if ((eax == 5 || eax == 7))
    {
        eax_5 = sub_40dff1(arg1);
        char temp2_1 = eax_5;
        eax_5 = (-eax_5);
        eax_5 = (eax_5 - eax_5);
        eax_5 = (eax_5 + 1);
    }
    if ((((eax != 4 && eax != 5) && eax != 6) && eax != 7))
    {
        data_433614 = arg1;
        eax_5 = sub_40ded1();
    }
    return eax_5;
}

void** __fastcall sub_40e0bd(int16_t* arg1, int32_t arg2, int16_t* arg3, int16_t* arg4, int32_t* arg5)
{
    int32_t __saved_ebp_1;
    int32_t __saved_ebp = __saved_ebp_1;
    void** i = data_422694;
    void** i_1 = i;
    void* const var_30 = nullptr;
    int32_t esi;
    int32_t var_34 = esi;
    int32_t edi;
    int32_t var_38 = edi;
    int32_t* esp_1 = &var_38;
    int16_t* edi_1 = arg1;
    int16_t* var_8 = edi_1;
    void** i_2;
    if (i != 0)
    {
        int16_t var_18_1 = 0x2f;
        int16_t var_2c_1 = 0x3a;
        do
        {
            void* ebx_1 = i[2];
            *(esp_1 - 4) = 0x2e;
            *(esp_1 - 8) = ebx_1;
            void* var_14_1 = ebx_1;
            int16_t* eax = wcsrchr();
            int16_t* var_28_1 = eax;
            int32_t eax_1 = sub_4104da(eax, arg4);
            if (eax_1 == 0)
            {
                int16_t* ebx_2 = (ebx_1 + 2);
                *edi_1 = eax_1;
                int16_t* esi_1 = ebx_2;
                int16_t* var_10_1 = ebx_2;
                int16_t* var_20_1 = esi_1;
                int16_t j_10 = *esi_1;
                int16_t j_8 = j_10;
                if (j_10 != 0)
                {
                    *(esp_1 - 4) = 0x5e;
                    int16_t edi_2 = *(esp_1 - 4);
                    *(esp_1 - 4) = 0x7b;
                    int16_t j_6 = j_10;
                    int16_t ebx_3 = *(esp_1 - 4);
                    int16_t j;
                    do
                    {
                        j_8 = j_6;
                        if (j_6 == ebx_3)
                        {
                            break;
                        }
                        if (j_6 == edi_2)
                        {
                            esi_1 = &esi_1[1];
                        }
                        else
                        {
                            *(esp_1 - 4) = 0x22;
                            int16_t k = *(esp_1 - 4);
                            if (j_6 == k)
                            {
                                do
                                {
                                    esi_1 = &esi_1[1];
                                } while (*esi_1 != k);
                            }
                        }
                        esi_1 = &esi_1[1];
                        j = *esi_1;
                        j_6 = j;
                        j_8 = j;
                    } while (j != 0);
                    ebx_2 = var_10_1;
                    edi_1 = var_8;
                    var_20_1 = esi_1;
                }
                if (j_8 == 0)
                {
                    goto label_40e27f;
                }
                *(esp_1 - 4) = 0x5e;
                int16_t* ebx_4 = esi_1;
                int16_t j_7 = j_8;
                int16_t esi_2 = *(esp_1 - 4);
                void* esp_10 = esp_1;
                int16_t j_1;
                do
                {
                    *(esp_10 - 4) = 0x7d;
                    if (j_7 == *(esp_10 - 4))
                    {
                        break;
                    }
                    if (j_7 == esi_2)
                    {
                        ebx_4 = &ebx_4[1];
                    }
                    ebx_4 = &ebx_4[1];
                    j_1 = *ebx_4;
                    j_7 = j_1;
                } while (j_1 != 0);
                esi_1 = var_20_1;
                int32_t j_11 = (((ebx_4 - esi_1) - 2) >> 1);
                int32_t j_9 = j_11;
                void* ecx_1 = arg3;
                *(esp_10 - 4) = 0x22;
                if (*arg3 == *(esp_10 - 4))
                {
                    ecx_1 = &arg3[1];
                }
                void* edi_3 = &esi_1[1];
                *(esp_10 - 4) = 0x5c;
                int32_t edx_2 = *(esp_10 - 4);
                esp_1 = esp_10;
                if (j_9 == 0)
                {
                label_40e217:
                    if (j_9 == 0xffffffff)
                    {
                    label_40e4f6:
                        edi_1 = var_8;
                    }
                }
                else
                {
                    void* ecx_2 = (ecx_1 - edi_3);
                    void* var_28_2 = ecx_2;
                    int16_t eax_7;
                    int32_t eax_9;
                    int32_t j_2;
                    do
                    {
                        eax_7 = *edi_3;
                        if ((eax_7 == edx_2 || (eax_7 != edx_2 && eax_7 == var_18_1)))
                        {
                            int16_t eax_10 = *(ecx_2 + edi_3);
                            if ((eax_10 != edx_2 && eax_10 != var_18_1))
                            {
                                j_9 = 0xffffffff;
                                goto label_40e217;
                            }
                        }
                        if ((eax_7 != edx_2 && eax_7 != var_18_1))
                        {
                            *(esp_1 - 4) = 1;
                            *(esp_1 - 8) = (ecx_2 + edi_3);
                            *(esp_1 - 0xc) = edi_3;
                            eax_9 = _wcsnicmp();
                            if (eax_9 != 0)
                            {
                                break;
                            }
                            ecx_2 = var_28_2;
                            *(esp_1 - 4) = 0x5c;
                            edx_2 = *(esp_1 - 4);
                        }
                        edi_3 = (edi_3 + 2);
                        j_2 = j_9;
                        j_9 = (j_9 - 1);
                    } while (j_2 != 1);
                    if (((eax_7 != edx_2 && eax_7 != var_18_1) && eax_9 != 0))
                    {
                        goto label_40e4f6;
                    }
                }
                *(esp_1 - 4) = edx_2;
                var_28_1 = esi_1;
                void* edi_4 = &arg3[(j_11 + 1)];
                *(esp_1 - 8) = edi_4;
                int32_t eax_13 = wcschr();
                *(esp_1 - 4);
                if (eax_13 == 0)
                {
                    *(esp_1 - 4) = 0x2f;
                    *(esp_1 - 4) = *(esp_1 - 4);
                    *(esp_1 - 8) = edi_4;
                    eax_13 = wcschr();
                    *(esp_1 - 4);
                    edi_1 = var_8;
                }
                int16_t eax_16;
                int16_t ecx_6;
                int16_t ecx_7;
                if (eax_13 == edi_4)
                {
                    *(esp_1 - 4) = 0x5c;
                    ecx_6 = *(esp_1 - 4);
                    eax_16 = ebx_4[-1];
                    if (eax_16 != ecx_6)
                    {
                        edi_1 = var_8;
                        *(esp_1 - 4) = 0x2f;
                        ecx_7 = *(esp_1 - 4);
                    }
                }
                if ((eax_13 == 0 || ((eax_13 == edi_4 && eax_16 != ecx_6) && eax_16 != ecx_7)))
                {
                    ebx_2 = var_10_1;
                label_40e27f:
                    *(esp_1 - 4) = 0x7b;
                    void* esp_30 = esp_1;
                    void* esp_70;
                    int32_t esi_6;
                    if (*var_14_1 == *(esp_1 - 4))
                    {
                        int16_t j_4 = *ebx_2;
                        int16_t* esi_3 = ebx_2;
                        if (j_4 != 0)
                        {
                            *(esp_30 - 4) = 0x5e;
                            int16_t edi_5 = *(esp_30 - 4);
                            *(esp_30 - 4) = 0x7d;
                            int16_t j_3 = j_4;
                            while (j_3 != *(esp_30 - 4))
                            {
                                if (j_3 == edi_5)
                                {
                                    esi_3 = &esi_3[1];
                                }
                                esi_3 = &esi_3[1];
                                int16_t j_5 = *esi_3;
                                j_3 = j_5;
                                if (j_5 == 0)
                                {
                                    break;
                                }
                            }
                            ebx_2 = var_10_1;
                            edi_1 = var_8;
                        }
                        int32_t esi_5 = ((esi_3 - ebx_2) >> 1);
                        void* esp_40;
                        if (esi_5 == 0)
                        {
                            *(esp_30 - 4) = 0x22;
                            void* esp_46;
                            if (*arg3 != *(esp_30 - 4))
                            {
                                *(esp_30 - 4) = 2;
                                esi_5 = *(esp_30 - 4);
                                *(esp_30 - 4) = esi_5;
                                *(esp_30 - 8) = &data_402708;
                                esp_46 = (esp_30 - 8);
                            }
                            else
                            {
                                *(esp_30 - 4) = 3;
                                esi_5 = *(esp_30 - 4);
                                *(esp_30 - 4) = esi_5;
                                *(esp_30 - 8) = &data_402700;
                                esp_46 = (esp_30 - 8);
                            }
                            *(esp_46 - 4) = arg2;
                            *(esp_46 - 8) = edi_1;
                            wcsncpy_s();
                            esp_40 = (esp_46 + 8);
                        }
                        else
                        {
                            *(esp_30 - 4) = esi_5;
                            *(esp_30 - 8) = ebx_2;
                            *(esp_30 - 0xc) = arg2;
                            *(esp_30 - 0x10) = edi_1;
                            wcsncpy_s();
                            ebx_2 = &ebx_2[esi_5];
                            *(esp_30 - 4) = 0x5c;
                            int16_t eax_18 = *(esp_30 - 4);
                            esp_40 = esp_30;
                            if (ebx_2[-1] != eax_18)
                            {
                                edi_1[esi_5] = eax_18;
                                esi_5 = (esi_5 + 1);
                            }
                        }
                        *(esp_40 - 4) = 0x5c;
                        var_14_1 = &ebx_2[1];
                        *(esp_40 - 4) = *(esp_40 - 4);
                        *(esp_40 - 8) = arg3;
                        int32_t eax_22 = wcsrchr();
                        *(esp_40 - 0xc) = 0x2f;
                        int32_t edi_6 = eax_22;
                        *(esp_40 - 0xc) = *(esp_40 - 0xc);
                        *(esp_40 - 0x10) = arg3;
                        int32_t eax_24 = wcsrchr();
                        if (eax_24 > edi_6)
                        {
                            edi_6 = eax_24;
                        }
                        void* eax_32;
                        void* esp_64;
                        if (edi_6 != 0)
                        {
                            *(esp_40 - 4) = (edi_6 + 2);
                            *(esp_40 - 8) = (arg2 - esi_5);
                            *(esp_40 - 0xc) = &var_8[esi_5];
                            wcscpy_s();
                            esp_64 = esp_40;
                            eax_32 = ((arg4 - edi_6) - 2);
                        }
                        else
                        {
                            *(esp_40 - 4) = 0x22;
                            int16_t* edi_7 = &arg3[1];
                            if (*arg3 != *(esp_40 - 4))
                            {
                                edi_7 = arg3;
                            }
                            *(esp_40 - 4) = edi_7;
                            *(esp_40 - 8) = (arg2 - esi_5);
                            *(esp_40 - 0xc) = &var_8[esi_5];
                            wcscpy_s();
                            esp_64 = esp_40;
                            eax_32 = (arg4 - edi_7);
                        }
                        edi_1 = var_8;
                        esp_70 = (esp_64 + 0xc);
                        esi_6 = (esi_5 + (eax_32 >> 1));
                    }
                    else
                    {
                        int16_t* eax_42;
                        int16_t* edi_8;
                        if (*esi_1 == 0)
                        {
                            eax_42 = arg3;
                            edi_8 = eax_42;
                        }
                        else
                        {
                            *(esp_30 - 4) = 0x2e;
                            *(esp_30 - 8) = arg3;
                            edi_8 = wcsrchr();
                            *(esp_30 - 4) = 0x3a;
                            int16_t edx_3 = *(esp_30 - 4);
                            *(esp_30 - 4) = 0x5c;
                            int16_t ecx_10 = *edi_8;
                            int16_t eax_41 = ecx_10;
                            int16_t esi_7 = *(esp_30 - 4);
                            if (ecx_10 != edx_3)
                            {
                                int16_t edx_4 = ecx_10;
                                do
                                {
                                    eax_41 = edx_4;
                                    if (edx_4 == esi_7)
                                    {
                                        break;
                                    }
                                    eax_41 = edx_4;
                                    if (edx_4 == var_18_1)
                                    {
                                        break;
                                    }
                                    eax_41 = ecx_10;
                                    if (edi_8 <= arg3)
                                    {
                                        break;
                                    }
                                    edi_8 = (edi_8 - 2);
                                    ecx_10 = *edi_8;
                                    edx_4 = ecx_10;
                                    eax_41 = ecx_10;
                                } while (ecx_10 != var_2c_1);
                            }
                            *(esp_30 - 4) = 0x3a;
                            int16_t ecx_11 = *(esp_30 - 4);
                            int16_t ecx_12;
                            if ((eax_41 != ecx_11 && eax_41 != esi_7))
                            {
                                *(esp_30 - 4) = 0x2f;
                                ecx_12 = *(esp_30 - 4);
                            }
                            if (((eax_41 == ecx_11 || (eax_41 != ecx_11 && eax_41 == esi_7)) || ((eax_41 != ecx_11 && eax_41 != esi_7) && eax_41 == ecx_12)))
                            {
                                edi_8 = &edi_8[1];
                            }
                            eax_42 = arg3;
                        }
                        int32_t ebx_8 = 0;
                        int32_t esi_10 = ((arg4 - edi_8) >> 1);
                        if (edi_8 != eax_42)
                        {
                            *(esp_30 - 4) = 0x22;
                            int16_t ecx_13 = *(esp_30 - 4);
                            if (*eax_42 == ecx_13)
                            {
                                ebx_8 = 1;
                                *var_8 = ecx_13;
                            }
                        }
                        if (esi_10 >= (arg2 - ebx_8))
                        {
                            *(esp_30 - 4) = 0x434;
                            *(esp_30 - 8) = 0;
                            sub_4053c9();
                            *(esp_30 - 4);
                        }
                        *(esp_30 - 4) = esi_10;
                        *(esp_30 - 8) = edi_8;
                        edi_1 = var_8;
                        *(esp_30 - 0xc) = (arg2 - ebx_8);
                        *(esp_30 - 0x10) = &edi_1[ebx_8];
                        wcsncpy_s();
                        esp_70 = esp_30;
                        esi_6 = (esi_10 + ebx_8);
                    }
                    int32_t ebx_11 = ((var_28_1 - var_14_1) >> 1);
                    if (ebx_11 >= (arg2 - esi_6))
                    {
                        *(esp_70 - 4) = 0x434;
                        *(esp_70 - 8) = 0;
                        sub_4053c9();
                        *(esp_70 - 4);
                    }
                    *(esp_70 - 4) = ebx_11;
                    *(esp_70 - 8) = var_14_1;
                    *(esp_70 - 0xc) = (arg2 - esi_6);
                    *(esp_70 - 0x10) = &edi_1[esi_6];
                    wcsncpy_s();
                    *(esp_70 - 4) = 0x22;
                    int16_t ecx_16 = *(esp_70 - 4);
                    if (*edi_1 == ecx_16)
                    {
                        int16_t* eax_54 = var_8;
                        int32_t edi_9 = (ebx_11 + esi_6);
                        if (eax_54[(edi_9 - 1)] != ecx_16)
                        {
                            if (((arg2 - ebx_11) - esi_6) <= 1)
                            {
                                *(esp_70 - 4) = 0x434;
                                *(esp_70 - 8) = 0;
                                sub_4053c9();
                                *(esp_70 - 4) = 0x22;
                                ecx_16 = *(esp_70 - 4);
                            }
                            eax_54 = var_8;
                            ebx_11 = (ebx_11 + 1);
                            eax_54[edi_9] = ecx_16;
                        }
                        edi_1 = eax_54;
                    }
                    *(esp_70 - 4) = 0;
                    edi_1[(ebx_11 + esi_6)] = 0;
                    *(esp_70 - 8) = 0;
                    void** eax_59 = sub_40ea69(edi_1);
                    esp_1 = esp_70;
                    char eax_60;
                    if (eax_59 != 0)
                    {
                        int32_t ecx_19 = eax_59[4];
                        int32_t edx_6 = eax_59[5];
                        arg5[1] = ecx_19;
                        arg5[2] = edx_6;
                        arg5[5] = ecx_19;
                        arg5[6] = edx_6;
                    }
                    else
                    {
                        eax_60 = sub_407cc4(edi_1, arg5);
                    }
                    if ((eax_59 != 0 || (eax_59 == 0 && eax_60 != 0)))
                    {
                        i_2 = i_1;
                        goto label_40e50b;
                    }
                }
                if ((eax_13 == edi_4 && eax_16 == ecx_6))
                {
                    goto label_40e4f6;
                }
                if (eax_13 != edi_4)
                {
                    goto label_40e4f6;
                }
            }
            i = *i_1;
            i_1 = i;
        } while (i != 0);
    }
    i_2 = nullptr;
label_40e50b:
    *esp_1;
    esp_1[1];
    esp_1[2];
    return i_2;
}

void** sub_40e52c()
{
    int32_t __saved_ebp_1;
    int32_t __saved_ebp = __saved_ebp_1;
    void** i = data_4226a0;
    void* const var_1c = nullptr;
    int32_t ebx = 0;
    void** i_2 = i;
    int32_t var_8 = 0;
    int32_t esi;
    int32_t var_20 = esi;
    int32_t* i_1 = data_422694;
    data_422694 = 0;
    int32_t edi;
    int32_t var_24 = edi;
    int32_t* esp_1 = &var_24;
    if (i != 0)
    {
        do
        {
            int16_t* eax = i[1];
            int16_t* edx_1 = eax;
            int16_t* var_18_1 = eax;
            do
            {
                eax = *edx_1;
                edx_1 = &edx_1[1];
            } while (eax != ebx);
            int32_t* j = i_1;
            int32_t edx_3 = ((edx_1 - &edx_1[1]) >> 1);
            int32_t var_10_1 = edx_3;
            if (i_1 != 0)
            {
                do
                {
                    int16_t* edi_1 = j[2];
                    *(esp_1 - 4) = 0x7b;
                    int16_t eax_1 = *(esp_1 - 4);
                    if (*edi_1 == eax_1)
                    {
                        int16_t ecx_2 = eax_1;
                        uint32_t k;
                        do
                        {
                            if (ecx_2 == 0x5e)
                            {
                                edi_1 = &edi_1[1];
                            }
                            edi_1 = &edi_1[1];
                            k = *edi_1;
                            ecx_2 = k;
                        } while (k != 0x7d);
                        edi_1 = &edi_1[1];
                    }
                    *(esp_1 - 4) = edx_3;
                    *(esp_1 - 8) = edi_1;
                    *(esp_1 - 0xc) = var_18_1;
                    int32_t eax_2 = _wcsnicmp();
                    uint32_t eax_4;
                    int16_t ecx_3;
                    if (eax_2 == 0)
                    {
                        eax_4 = edi_1[var_10_1];
                        if (eax_4 != 0x2e)
                        {
                            *(esp_1 - 4) = 0x7b;
                            ecx_3 = *(esp_1 - 4);
                        }
                        if ((eax_4 == 0x2e || (eax_4 != 0x2e && eax_4 == ecx_3)))
                        {
                            int32_t* eax_5 = j[1];
                            int32_t* ecx_4 = *j;
                            if (eax_5 == 0)
                            {
                                i_1 = ecx_4;
                            }
                            else
                            {
                                *eax_5 = ecx_4;
                                ecx_4 = *j;
                            }
                            if (ecx_4 != 0)
                            {
                                ecx_4[1] = j[1];
                                ecx_4 = *j;
                            }
                            *j = 0;
                            void** k_1 = data_422694;
                            if (k_1 != 0)
                            {
                                do
                                {
                                    *(esp_1 - 4) = j[2];
                                    *(esp_1 - 8) = k_1[2];
                                    eax_5 = _wcsicmp();
                                    *(esp_1 - 4);
                                    if (eax_5 == 0)
                                    {
                                        break;
                                    }
                                    k_1 = *k_1;
                                } while (k_1 != 0);
                            }
                            if ((k_1 == 0 || (k_1 != 0 && eax_5 != 0)))
                            {
                                void** k_2 = j[3];
                                while (k_2 != 0)
                                {
                                    eax_5 = j[5];
                                    data_436640 = eax_5;
                                    if (eax_5 != 0)
                                    {
                                        data_436644 = j[2];
                                    }
                                    *(esp_1 - 4) = 0;
                                    *(esp_1 - 8) = 0;
                                    *(esp_1 - 0xc) = 0;
                                    *(esp_1 - 0x10) = 0;
                                    *(esp_1 - 0x14) = 0;
                                    sub_40ebf9(k_2[1], &var_8);
                                    k_2 = *k_2;
                                    data_436640 = 0;
                                }
                                j[4] = var_8;
                                var_8 = 0;
                                sub_40ea1c(&data_422694, j);
                            }
                            if ((k_1 != 0 && eax_5 == 0))
                            {
                                *(esp_1 - 4) = j[2];
                                free();
                                void* esp_12 = esp_1;
                                while (true)
                                {
                                    int32_t* ebx_1 = j[3];
                                    *esp_12;
                                    if (ebx_1 == 0)
                                    {
                                        break;
                                    }
                                    j[3] = *ebx_1;
                                    *esp_12 = ebx_1[1];
                                    free();
                                    esp_12 = (esp_12 + 4);
                                    *ebx_1 = data_433618;
                                    data_433618 = ebx_1;
                                }
                                *esp_12 = j;
                                free();
                                *(esp_12 + 4);
                                esp_1 = (esp_12 + 8);
                            }
                            j = ecx_4;
                        }
                    }
                    if ((eax_2 != 0 || ((eax_2 == 0 && eax_4 != 0x2e) && eax_4 != ecx_3)))
                    {
                        j = *j;
                    }
                    edx_3 = var_10_1;
                } while (j != 0);
            }
            *(esp_1 - 4) = 0;
            ebx = *(esp_1 - 4);
            i = *i_2;
            i_2 = i;
        } while (i != 0);
    }
    if (i_1 != 0)
    {
        int32_t* i_3 = i_1;
        do
        {
            if ((data_41248c & 1) != 0)
            {
                *(esp_1 - 4) = i_1[2];
                *(esp_1 - 8) = 0xfa5;
                *(esp_1 - 0xc) = ebx;
                sub_4053c9();
            }
            *(esp_1 - 4) = i_1[2];
            free();
            sub_404b9e(i_1[3]);
            sub_404b9e(i_1[4]);
            i_1 = *i_1;
            *esp_1 = i_3;
            i = free();
            i_3 = i_1;
            esp_1[1];
            esp_1 = &esp_1[2];
        } while (i_1 != 0);
    }
    *esp_1;
    esp_1[1];
    esp_1[2];
    return i;
}

void** __fastcall sub_40e713(void* arg1, uint8_t* arg2, int32_t arg3, int32_t arg4, int32_t* arg5, int32_t* arg6, int32_t* arg7, int32_t* arg8, int32_t* arg9)
{
    __security_cookie;
    wchar16* eax_6 = wcsrchr(*(arg1 + 4), 0x2e);
    void** eax_7;
    void** eax_15;
    if (eax_6 != 0)
    {
        void var_260;
        eax_7 = sub_40e0bd(arg2, 0x101, *(arg1 + 4), eax_6, &var_260);
        if (eax_7 != 0)
        {
            int32_t eax_8;
            int32_t edx;
            eax_8 = sub_407a01(&var_260);
            *arg9 = arg2;
            int32_t var_288 = eax_8;
            int32_t var_284_1 = edx;
            void** i = *arg6;
            if (i != 0)
            {
                do
                {
                    int32_t eax_9;
                    eax_9 = _wcsicmp(i[1], arg2);
                    if (eax_9 == 0)
                    {
                        break;
                    }
                    i = *i;
                } while (i != 0);
                if (i != 0)
                {
                    *(arg1 + 8) = (*(arg1 + 8) & 0xfe);
                }
            }
            edx = *(arg1 + 8);
            int32_t* var_27c = nullptr;
            uint32_t eax_10 = sub_403a7c(arg2, edx, &var_288, 0, &var_27c);
            int32_t* ecx_5 = var_27c;
            if (ecx_5 != 0)
            {
                uint32_t var_278_2 = (eax_10 + sub_404e10(ecx_5));
                sub_404e2e(&var_27c);
                eax_10 = var_278_2;
            }
            int32_t edx_1 = var_288;
            *arg7 = (*arg7 + eax_10);
            int32_t ecx_8 = var_284_1;
            if ((((arg4 > ecx_8 || (arg4 <= ecx_8 && arg3 >= edx_1)) && (*(arg1 + 8) & 0x10) == 0) && arg4 >= ecx_8))
            {
                if (data_4226b6 == 0)
                {
                label_40e88e:
                    int32_t esi_4 = arg8[1];
                    int32_t eax_14 = *arg8;
                    if ((esi_4 < ecx_8 || ((esi_4 >= ecx_8 && esi_4 <= ecx_8) && eax_14 <= edx_1)))
                    {
                        eax_14 = edx_1;
                        esi_4 = ecx_8;
                    }
                    *arg8 = eax_14;
                    eax_15 = eax_7;
                    arg8[1] = esi_4;
                }
                else
                {
                    if (arg3 != edx_1)
                    {
                        goto label_40e88e;
                    }
                    if (arg4 != ecx_8)
                    {
                        goto label_40e88e;
                    }
                }
            }
            if (((((*(arg1 + 8) & 0x10) != 0 || ((*(arg1 + 8) & 0x10) == 0 && arg4 < ecx_8)) || ((((*(arg1 + 8) & 0x10) == 0 && arg4 >= ecx_8) && arg4 <= ecx_8) && arg3 < edx_1)) || ((((*(arg1 + 8) & 0x10) == 0 && arg4 >= ecx_8) && (arg4 > ecx_8 || (arg4 <= ecx_8 && arg3 >= edx_1))) && data_4226b6 != 0)))
            {
                if (i == 0)
                {
                    int32_t* eax_12 = sub_40e8c5();
                    eax_12[1] = sub_40e917(arg2);
                    sub_40ea1c(arg5, eax_12);
                    edx_1 = var_288;
                    if (*arg6 == 0)
                    {
                        *arg6 = *arg5;
                    }
                    ecx_8 = var_284_1;
                    goto label_40e86b;
                }
            label_40e86b:
                eax_10 = *(arg1 + 8);
                eax_10 = (eax_10 & 0x11);
                if (eax_10 == 1)
                {
                    int32_t var_29c_4 = *(arg1 + 4);
                    uint8_t* var_2a0_3 = arg2;
                    sub_4054a3(3);
                    ecx_8 = var_284_1;
                    edx_1 = var_288;
                }
                goto label_40e88e;
            }
        }
    }
    if ((eax_6 == 0 || (eax_6 != 0 && eax_7 == 0)))
    {
        eax_15 = nullptr;
    }
    CookieCheckFunction(eax_15);
    return eax_15;
}

int32_t* sub_40e8c5()
{
    int32_t* edx = data_433618;
    if (edx != 0)
    {
        data_433618 = *edx;
    }
    else
    {
        int32_t esi_1 = data_436620;
        if (esi_1 >= 8)
        {
            edx = data_43361c;
        }
        else
        {
            esi_1 = 0x8000;
            edx = sub_40aba4(0x8000);
        }
        data_43361c = &edx[2];
        data_436620 = (esi_1 - 8);
    }
    *edx = 0;
    edx[1] = 0;
    return edx;
}

int32_t __fastcall sub_40e917(uint8_t* arg1)
{
    int16_t* edi = arg1;
    void* ecx = &edi[1];
    int16_t i;
    do
    {
        i = *edi;
        edi = &edi[1];
    } while (i != 0);
    int32_t eax_1;
    int32_t edx;
    edx = HIGHD(((((edi - ecx) >> 1) + 1) * 2));
    eax_1 = LOWD(((((edi - ecx) >> 1) + 1) * 2));
    int32_t ecx_1;
    ecx_1 = (((((edi - ecx) >> 1) + 1) * 2) >> 0x20) != 0;
    int32_t eax_2 = sub_40aba4(((-ecx_1) | eax_1));
    memcpy(eax_2, arg1, ((((edi - ecx) >> 1) + 1) * 2));
    return eax_2;
}

int32_t __fastcall sub_40e95b(uint8_t* arg1)
{
    uint8_t* var_8 = arg1;
    int16_t* ebx = arg1;
    uint8_t* eax;
    do
    {
        eax = *ebx;
        ebx = &ebx[1];
    } while (eax != 0);
    int32_t ebx_2 = ((ebx - &ebx[1]) >> 1);
    int32_t eax_2;
    int32_t edx;
    edx = HIGHD(((ebx_2 + 3) * 2));
    eax_2 = LOWD(((ebx_2 + 3) * 2));
    int32_t ecx_1;
    ecx_1 = (((ebx_2 + 3) * 2) >> 0x20) != 0;
    int32_t eax_3 = sub_40aba4(((-ecx_1) | eax_2));
    int32_t esi = (ebx_2 * 2);
    *eax_3 = 0x22;
    memcpy((eax_3 + 2), arg1, esi);
    *((esi + eax_3) + 2) = 0x22;
    *((eax_3 + (ebx_2 << 1)) + 4) = 0;
    return eax_3;
}

int32_t __fastcall sub_40e9c1(int16_t* arg1, int16_t* arg2)
{
    int16_t* var_8 = arg1;
    int16_t* esi = arg1;
    int16_t i;
    do
    {
        i = *esi;
        esi = &esi[1];
    } while (i != 0);
    int16_t* ecx_1 = arg2;
    do
    {
        i = *ecx_1;
        ecx_1 = &ecx_1[1];
    } while (i != 0);
    int32_t edi_1 = ((((esi - &esi[1]) >> 1) + 1) + ((ecx_1 - &ecx_1[1]) >> 1));
    int32_t eax = sub_41069b(arg1, edi_1);
    wcscat_s(eax, edi_1, arg2);
    return eax;
}

void __fastcall sub_40ea1c(int32_t* arg1, int32_t arg2)
{
    int32_t* i_1 = *arg1;
    if (i_1 != 0)
    {
        int32_t* i;
        do
        {
            i = *i_1;
            arg1 = i_1;
            i_1 = i;
        } while (i != 0);
    }
    *arg1 = arg2;
}

int32_t __fastcall sub_40ea31(int16_t* arg1)
{
    int16_t* edi = arg1;
    int32_t esi = 0;
    while (true)
    {
        uint32_t eax_4 = *edi;
        if (eax_4 == 0)
        {
            break;
        }
        int16_t eax_1;
        if (eax_4 != 0x2f)
        {
            eax_1 = towupper(eax_4);
        }
        else
        {
            eax_1 = 0x5c;
        }
        esi = (esi + eax_1);
        edi = &edi[1];
    }
    return (esi & 0x7f);
}

void** __fastcall sub_40ea69(int16_t* arg1)
{
    int16_t* var_8 = arg1;
    int16_t* edi = arg1;
    *var_8[3] = 0;
    void** eax_1;
    if (*edi == 0)
    {
        eax_1 = nullptr;
    }
    else
    {
        int16_t* var_18_1 = arg1;
        eax_1 = sub_410422(edi, sub_40ea31(arg1));
        if (eax_1 == 0)
        {
            int32_t eax_2;
            int32_t ecx_1;
            eax_2 = wcsncmp(edi, &data_402708, 2);
            int32_t eax_3;
            int32_t ebx_1;
            if (eax_2 != 0)
            {
                eax_3 = wcsncmp(edi, &data_402710, 2);
                if (eax_3 != 0)
                {
                    int16_t* esi_1 = edi;
                    void* ecx_2 = &esi_1[1];
                    do
                    {
                        eax_3 = *esi_1;
                        esi_1 = &esi_1[1];
                    } while (eax_3 != 0);
                    int32_t eax_5;
                    int32_t edx_1;
                    edx_1 = HIGHD(((((esi_1 - ecx_2) >> 1) + 3) * 2));
                    eax_5 = LOWD(((((esi_1 - ecx_2) >> 1) + 3) * 2));
                    int32_t ecx_3;
                    ecx_3 = (((((esi_1 - ecx_2) >> 1) + 3) * 2) >> 0x20) != 0;
                    ebx_1 = sub_40aba4(((-ecx_3) | eax_5));
                    wcscpy_s(ebx_1, (((esi_1 - ecx_2) >> 1) + 3), &data_402708);
                    ecx_1 = wcscat_s(ebx_1, (((esi_1 - ecx_2) >> 1) + 3), edi);
                    *var_8[3] = 1;
                }
            }
            if ((eax_2 == 0 || (eax_2 != 0 && eax_3 == 0)))
            {
                ebx_1 = &edi[2];
            }
            int32_t var_18_4 = ecx_1;
            void** esi_5 = sub_410422(ebx_1, sub_40ea31(ebx_1));
            if (esi_5 == 0)
            {
                if (ebx_1 != &edi[2])
                {
                    *(ebx_1 + 2) = 0x2f;
                }
                int32_t var_18_7 = ebx_1;
                sub_410422(ebx_1, sub_40ea31(ebx_1));
                if (*var_8[3] != 0)
                {
                    free(ebx_1);
                }
                int32_t ecx_13;
                if (*edi == 0x22)
                {
                    int32_t eax_12;
                    eax_12 = sub_4105de(edi);
                    ebx_1 = eax_12;
                }
                else
                {
                    int16_t* esi_6 = edi;
                    void* ecx_14 = &esi_6[1];
                    void** eax_11;
                    do
                    {
                        eax_11 = *esi_6;
                        esi_6 = &esi_6[1];
                    } while (eax_11 != 0);
                    int32_t eax_14;
                    int32_t edx_2;
                    edx_2 = HIGHD(((((esi_6 - ecx_14) >> 1) + 3) * 2));
                    eax_14 = LOWD(((((esi_6 - ecx_14) >> 1) + 3) * 2));
                    int32_t ecx_15;
                    ecx_15 = (((((esi_6 - ecx_14) >> 1) + 3) * 2) >> 0x20) != 0;
                    ebx_1 = sub_40aba4(((-ecx_15) | eax_14));
                    wcscpy_s(ebx_1, (((esi_6 - ecx_14) >> 1) + 3), &data_40104c);
                    wcscat_s(ebx_1, (((esi_6 - ecx_14) >> 1) + 3), edi);
                    ecx_13 = wcscat_s(ebx_1, (((esi_6 - ecx_14) >> 1) + 3), &data_40104c);
                }
                int32_t var_18_11 = ecx_13;
                esi_5 = sub_410422(ebx_1, sub_40ea31(ebx_1));
            }
            if (((esi_5 != 0 && *var_8[3] != 0) || esi_5 == 0))
            {
                free(ebx_1);
            }
            eax_1 = esi_5;
        }
    }
    return eax_1;
}

uint32_t __fastcall sub_40ebf9(int16_t* arg1, int32_t** arg2, int32_t* arg3, void* arg4, int32_t arg5, int32_t arg6, char arg7)
{
    __security_cookie;
    int32_t* ebx = arg3;
    int32_t* var_22c = ebx;
    int16_t* esi = arg1;
    char var_215 = 0;
    int32_t* ecx;
    if (arg2 == 0)
    {
        ecx = nullptr;
    }
    if ((arg2 != 0 && ebx != 0))
    {
        ecx = *ebx;
    }
    int32_t* var_224_1;
    int32_t* var_21c;
    if ((arg2 == 0 || (arg2 != 0 && ebx != 0)))
    {
        var_21c = ecx;
    label_40ec62:
        var_224_1 = ecx;
    }
    if ((arg2 != 0 && ebx == 0))
    {
        ecx = *arg2;
        var_224_1 = ecx;
        var_21c = ecx;
        if ((ecx != 0 && *ecx != 0))
        {
            do
            {
                ecx = *ecx;
                var_21c = ecx;
            } while (*ecx != 0);
            goto label_40ec62;
        }
    }
    uint32_t eax_3 = *esi;
    int16_t i;
    if (eax_3 != 0)
    {
        i = eax_3;
        while (i != 0)
        {
            ebx = var_215;
            int16_t i_1 = i;
            int16_t i_2;
            do
            {
                i_2 = i_1;
                if (i_1 == 0x24)
                {
                    break;
                }
                if (i_1 == 0x22)
                {
                    ebx = ebx == 0;
                }
                if ((ebx == 0 && i_1 == 0x5e))
                {
                    esi = &esi[1];
                    if (*esi == 0x22)
                    {
                        ebx = (ebx + 1);
                    }
                }
                esi = &esi[1];
                eax_3 = *esi;
                i_1 = eax_3;
                i_2 = eax_3;
            } while (eax_3 != 0);
            ecx = var_224_1;
            var_215 = ebx;
            ebx = var_22c;
            if (i_2 == 0)
            {
                break;
            }
            eax_3 = arg7;
            void* esi_1 = &esi[1];
            eax_3 = (eax_3 & 4);
            char var_216_1 = eax_3;
            if (*esi_1 == 0)
            {
                if (eax_3 != 0)
                {
                    if (ebx != 0)
                    {
                        *ebx = ecx;
                    }
                    break;
                }
                sub_4053c9(data_4226b0, 0x3ea);
                var_216_1 = 0;
            }
            if (var_215 != 0)
            {
                goto label_40ed5a;
            }
            if (*esi_1 != 0x5e)
            {
                goto label_40ed5a;
            }
            esi_1 = (esi_1 + 2);
            ecx = *esi_1;
            eax_3 = sub_4038ca(ecx);
            if ((eax_3 != 0 || (eax_3 == 0 && var_216_1 == eax_3)))
            {
                uint32_t var_244_1 = *esi_1;
                sub_4053c9(data_4226b0, 0x3e9);
            label_40ed5a:
                uint32_t eax_5 = *esi_1;
                if (eax_5 == 0x24)
                {
                    esi_1 = sub_40f20d(esi_1);
                label_40f0b7:
                    ecx = var_21c;
                    var_224_1 = ecx;
                label_40f0c3:
                    esi = (esi_1 + 2);
                    eax_3 = *esi;
                    i = eax_3;
                    if (eax_3 == 0)
                    {
                        break;
                    }
                    continue;
                }
                else
                {
                    int32_t var_214;
                    if (eax_5 != 0x28)
                    {
                        if (wcschr(u"*@<?", eax_5) != 0)
                        {
                            if (data_436640 == 0)
                            {
                                goto label_40f0b7;
                            }
                            if ((data_41248c & 0x40) != 0)
                            {
                                goto label_40f0b7;
                            }
                            uint32_t eax_11 = *esi_1;
                            if (eax_11 == 0x3c)
                            {
                                goto label_40f0b7;
                            }
                            int32_t var_244_5 = data_436644;
                            int16_t var_e_1 = eax_11;
                            int16_t var_c_1 = 0;
                            int16_t var_10;
                            int16_t* var_248_2 = &var_10;
                            var_10 = 0x24;
                            sub_4053c9(0, 0x44c);
                        }
                        uint32_t ecx_4;
                        ecx_4 = *esi_1;
                        eax_3 = sub_4038ca(ecx_4);
                        if ((eax_3 == 0 && var_216_1 == eax_3))
                        {
                            sub_4053c9(data_4226b0, 0x3ea);
                        }
                        if (((eax_3 == 0 && var_216_1 == eax_3) || eax_3 != 0))
                        {
                            eax_3 = *esi_1;
                            var_214 = eax_3;
                            *var_214[2] = 0;
                        }
                    }
                    else
                    {
                        esi_1 = sub_40f10b((esi_1 + 2), &var_214);
                        if (wcschr(u"*@<?", var_214) != 0)
                        {
                            if (data_436640 == 0)
                            {
                                goto label_40f0b7;
                            }
                            if ((data_41248c & 0x40) != 0)
                            {
                                goto label_40f0b7;
                            }
                            int16_t* esi_2 = &var_214;
                            wchar16* eax_8;
                            do
                            {
                                eax_8 = *esi_2;
                                esi_2 = &esi_2[1];
                            } while (eax_8 != 0);
                            __alloca_probe_16(((((esi_2 - &*var_214[2]) >> 1) + 4) * 2));
                            int32_t* var_244_3 = &var_214;
                            int32_t __saved_edi;
                            sub_40cc6e(&__saved_edi, (((esi_2 - &*var_214[2]) >> 1) + 4), u"$(%s)");
                            int32_t var_254_1 = data_436644;
                            int32_t* var_258_1 = &__saved_edi;
                            sub_4053c9(0, 0x44c);
                        }
                    }
                    if (((eax_5 != 0x28 && ((eax_3 == 0 && var_216_1 == eax_3) || eax_3 != 0)) || eax_5 == 0x28))
                    {
                        int32_t* edi_1;
                        if (arg2 != 0)
                        {
                            edi_1 = sub_40e8c5();
                            goto label_40eefc;
                        }
                        int32_t var_234 = 0;
                        int32_t var_230_1 = sub_40e917(&data_401058);
                        edi_1 = &var_234;
                    label_40eefc:
                        uint32_t edx_1 = sub_40ab10(&var_214);
                        uint32_t var_220_2 = edx_1;
                        if (edx_1 == 0)
                        {
                            goto label_40efc8;
                        }
                        int32_t* j;
                        if (arg4 != 0)
                        {
                            void* ecx_7 = arg4;
                            int32_t* edx_2 = &var_214;
                            while (true)
                            {
                                eax_3 = *ecx_7;
                                int16_t temp1_1 = *edx_2;
                                bool c_1 = eax_3 < temp1_1;
                                if (eax_3 == temp1_1)
                                {
                                    int16_t temp2_1;
                                    if (eax_3 != 0)
                                    {
                                        eax_3 = *(ecx_7 + 2);
                                        temp2_1 = *(edx_2 + 2);
                                        c_1 = eax_3 < temp2_1;
                                        if (eax_3 == temp2_1)
                                        {
                                            ecx_7 = (ecx_7 + 4);
                                            edx_2 = &edx_2[1];
                                            if (eax_3 != 0)
                                            {
                                                continue;
                                            }
                                        }
                                    }
                                    if ((eax_3 == 0 || (eax_3 != 0 && eax_3 == temp2_1)))
                                    {
                                        eax_3 = 0;
                                        break;
                                    }
                                }
                                eax_3 = ((eax_3 - eax_3) | 1);
                                break;
                            }
                            edx_1 = var_220_2;
                            if (eax_3 != 0)
                            {
                                goto label_40ef85;
                            }
                            int32_t ecx_8 = arg5;
                            j = *(edx_1 + 8);
                            ebx = var_22c;
                            if (ecx_8 != arg6)
                            {
                                while (j != 0)
                                {
                                    j = *j;
                                    ecx_8 = (ecx_8 - 1);
                                    if (ecx_8 == arg6)
                                    {
                                        break;
                                    }
                                }
                                if (j == 0)
                                {
                                    goto label_40ef78;
                                }
                            }
                            if (j == 0)
                            {
                                goto label_40ef78;
                            }
                            goto label_40efc2;
                        }
                    label_40ef85:
                        eax_3 = *(edx_1 + 0xc);
                        if ((eax_3 & 1) == 0)
                        {
                            int32_t eax_15;
                            if ((eax_3 & 0x10) == 0)
                            {
                                j = *(edx_1 + 8);
                            label_40efc2:
                                eax_15 = j[1];
                                goto label_40efc5;
                            }
                        label_40ef78:
                            eax_15 = sub_40e917(&data_401690);
                            edx_1 = var_220_2;
                        label_40efc5:
                            edi_1[1] = eax_15;
                            goto label_40efc8;
                        }
                        if (var_216_1 == 0)
                        {
                            int32_t* var_244_6 = &var_214;
                            sub_4053c9(data_4226b0, 0x42e);
                            edx_1 = var_220_2;
                        label_40efc8:
                            int32_t** ecx_9 = arg2;
                            if (ecx_9 == 0)
                            {
                                ecx = var_21c;
                            }
                            else
                            {
                                if ((edx_1 == 0 || (edx_1 != 0 && (*(edx_1 + 0xc) & 0x10) != 0)))
                                {
                                    edx_1 = var_220_2;
                                    ecx_9 = arg2;
                                    edi_1[1] = sub_40e917(&data_401690);
                                }
                                *edi_1 = 0;
                                int32_t* eax_17 = var_21c;
                                if (eax_17 == 0)
                                {
                                    *ecx_9 = edi_1;
                                }
                                else
                                {
                                    *eax_17 = edi_1;
                                }
                                ecx = edi_1;
                                var_21c = ecx;
                            }
                            var_224_1 = ecx;
                            if (edx_1 == 0)
                            {
                                goto label_40f0c3;
                            }
                            if (wcschr(edi_1[1], 0x24) != 0)
                            {
                                *(var_220_2 + 0xc) = (*(var_220_2 + 0xc) | 1);
                                int32_t eax_22;
                                int32_t eax_23;
                                if (arg4 != 0)
                                {
                                    void* eax_20 = arg4;
                                    int32_t* ecx_11 = &var_214;
                                    while (true)
                                    {
                                        int16_t edx_3 = *eax_20;
                                        int16_t temp3_1 = *ecx_11;
                                        bool c_2 = edx_3 < temp3_1;
                                        if (edx_3 == temp3_1)
                                        {
                                            int16_t temp4_1;
                                            if (edx_3 != 0)
                                            {
                                                edx_3 = *(eax_20 + 2);
                                                temp4_1 = *(ecx_11 + 2);
                                                c_2 = edx_3 < temp4_1;
                                                if (edx_3 == temp4_1)
                                                {
                                                    eax_20 = (eax_20 + 4);
                                                    ecx_11 = &ecx_11[1];
                                                    if (edx_3 != 0)
                                                    {
                                                        continue;
                                                    }
                                                }
                                            }
                                            if ((edx_3 == 0 || (edx_3 != 0 && edx_3 == temp4_1)))
                                            {
                                                eax_22 = 0;
                                                break;
                                            }
                                        }
                                        eax_22 = ((eax_20 - eax_20) | 1);
                                        break;
                                    }
                                    eax_23 = arg5;
                                }
                                if ((arg4 == 0 || (arg4 != 0 && eax_22 == 0)))
                                {
                                    eax_23 = arg6;
                                }
                                edi_1[1];
                                sub_40ebf9(&var_21c, &var_214, (arg5 + 1), eax_23, arg7);
                                *(var_220_2 + 0xc) = (*(var_220_2 + 0xc) & 0xfe);
                            }
                            goto label_40f0b7;
                        }
                    }
                }
            }
            if (ebx == 0)
            {
                break;
            }
            *ebx = var_21c;
            break;
        }
        if (i != 0)
        {
            eax_3 = 0;
        }
    }
    if ((eax_3 == 0 || (eax_3 != 0 && i == 0)))
    {
        if (ebx != 0)
        {
            *ebx = ecx;
        }
        eax_3 = 1;
    }
    CookieCheckFunction(eax_3);
    return eax_3;
}

int16_t* __fastcall sub_40f10b(int16_t* arg1, int16_t* arg2)
{
    int16_t* esi = arg1;
    int16_t* ebx = arg2;
    uint32_t eax = *esi;
    int16_t* edi = ebx;
    int16_t* var_c = ebx;
    int16_t i_4 = eax;
    int32_t var_10 = 0x29;
    if (eax != 0)
    {
        uint32_t ecx = eax;
        do
        {
            i_4 = ecx;
            if (ecx == 0x29)
            {
                break;
            }
            i_4 = ecx;
            if (ecx == 0x3a)
            {
                break;
            }
            if (ecx == 0x5e)
            {
                esi = &esi[1];
                ecx = *esi;
                if (sub_4038ca(ecx) == 0)
                {
                    uint32_t var_20_1 = *esi;
                    sub_4053c9(data_4226b0, 0x3e9);
                }
            }
            eax = *esi;
            esi = &esi[1];
            *edi = eax;
            edi = &edi[1];
            eax = *esi;
            ecx = eax;
            i_4 = eax;
        } while (eax != 0);
        ebx = var_c;
    }
    if (i_4 != 0x29)
    {
        int16_t i_1 = i_4;
        int16_t i_2;
        int16_t i;
        do
        {
            int16_t i_3 = i_1;
            if (i_1 == 0x5e)
            {
                esi = &esi[1];
                i_3 = *esi;
            }
            i_2 = i_3;
            if (i_3 == 0)
            {
                break;
            }
            esi = &esi[1];
            i = *esi;
            i_1 = i;
            i_2 = i;
        } while (i != 0x29);
        ebx = var_c;
        if (i_2 != 0x29)
        {
            sub_4053c9(data_4226b0, 0x3e8);
        }
    }
    *edi = 0;
    if (((edi - ebx) & 0xfffffffe) > 0x202)
    {
        sub_4053c9(data_4226b0, 0x434);
    }
    return esi;
}

void* __fastcall sub_40f20d(int16_t* arg1)
{
    if (*arg1 == 0)
    {
        goto label_40f2a1;
    }
    uint32_t eax_1 = arg1[1];
    void* eax_2;
    if (eax_1 == 0x5e)
    {
        eax_2 = &arg1[1];
    }
    else
    {
        if (eax_1 != 0x28)
        {
            goto label_40f2a1;
        }
        uint32_t eax_3 = arg1[2];
        if ((eax_3 == 0x5e || (eax_3 != 0x5e && eax_3 != 0x40)))
        {
            eax_2 = &arg1[2];
        }
        if ((eax_3 != 0x5e && eax_3 == 0x40))
        {
            uint32_t eax_4 = arg1[3];
            uint32_t eax_5;
            wchar16* eax_6;
            int16_t eax_7;
            if (eax_4 == 0x5e)
            {
                eax_5 = arg1[4];
            }
            else if (eax_4 != 0x29)
            {
                eax_6 = wcschr(u"DFBR", eax_4);
                if (eax_6 != 0)
                {
                    eax_7 = arg1[4];
                    if (eax_7 == 0x5e)
                    {
                        eax_5 = arg1[5];
                    }
                }
            }
            if ((eax_4 == 0x5e || (((eax_4 != 0x5e && eax_4 != 0x29) && eax_6 != 0) && eax_7 == 0x5e)))
            {
                uint32_t var_10_2 = eax_5;
                sub_4053c9(data_4226b0, 0x3e9);
            label_40f2a1:
                eax_2 = arg1;
            }
            if ((eax_4 != 0x5e && eax_4 != 0x29))
            {
                if ((eax_6 != 0 && eax_7 != 0x5e))
                {
                    eax_2 = &arg1[4];
                    if (eax_7 != 0x29)
                    {
                        goto label_40f2a1;
                    }
                }
                if (eax_6 == 0)
                {
                    goto label_40f2a1;
                }
            }
            if (eax_4 == 0x29)
            {
                eax_2 = &arg1[3];
            }
        }
    }
    return eax_2;
}

wchar16* __fastcall sub_40f2a7(int32_t* arg1)
{
    int32_t* i_1 = arg1;
    wchar16* str = arg1;
    i_1 = nullptr;
    if (wcschr(str, 0x24) != 0)
    {
        sub_40ebf9(str, &i_1, nullptr, nullptr, 0, 0, 0);
        int32_t* i = i_1;
        int32_t* edx_2;
        edx_2 = 0xff;
        str = sub_40f30f(str, edx_2, &i_1);
        int32_t* i_2 = i;
        i_1 = i_2;
        if (i != 0)
        {
            int32_t* i_3 = data_433618;
            do
            {
                i = *i;
                *i_2 = i_3;
                i_3 = i_2;
                i_2 = i;
                i_1 = i_2;
            } while (i != 0);
            data_433618 = i_3;
        }
    }
    return str;
}

int32_t __fastcall sub_40f30f(int16_t* arg1, int32_t* arg2, int32_t** arg3)
{
    __security_cookie;
    int16_t* ebx = arg1;
    char var_825 = arg2;
    arg2 = 0;
    char var_82d = 0;
    int16_t* var_81c = ebx;
    void var_810;
    void* edi = &var_810;
    void var_10;
    void* var_82c = &var_10;
    int16_t i_1 = *ebx;
    void* esi = &var_810;
    char var_835 = 0;
    int32_t var_820 = 0x400;
    void* var_824 = &var_810;
    void* var_834 = &var_810;
    if (i_1 != 0)
    {
        int16_t i = i_1;
        int16_t var_818_1 = 0x22;
        while (true)
        {
            if (i != 0)
            {
                while (i != 0x24)
                {
                    if (esi == var_82c)
                    {
                        sub_40f671(&var_824, &var_834, &var_82c, &var_820, &var_810);
                        esi = var_834;
                        arg2 = var_835;
                    }
                    int16_t eax_3 = *ebx;
                    if (eax_3 == 0x22)
                    {
                        arg2 = arg2 == 0;
                        var_835 = arg2;
                    }
                    if ((arg2 == 0 && eax_3 == 0x5e))
                    {
                        *esi = 0x5e;
                        esi = (esi + 2);
                        var_834 = esi;
                        if (esi == var_82c)
                        {
                            sub_40f671(&var_824, &var_834, &var_82c, &var_820, &var_810);
                            esi = var_834;
                            arg2 = var_835;
                        }
                        ebx = &ebx[1];
                        int16_t ecx_2 = *ebx;
                        eax_3 = ecx_2;
                        if (ecx_2 == var_818_1)
                        {
                            arg2 = 1;
                            var_835 = 1;
                        }
                    }
                    ebx = &ebx[1];
                    *esi = eax_3;
                    esi = (esi + 2);
                    var_81c = ebx;
                    var_834 = esi;
                    int16_t i_2 = *ebx;
                    i = i_2;
                    if (i_2 == 0)
                    {
                        break;
                    }
                }
            }
            if (esi == var_82c)
            {
                sub_40f671(&var_824, &var_834, &var_82c, &var_820, &var_810);
                esi = var_834;
            }
            if (*ebx == 0)
            {
                break;
            }
            void* esi_1 = &ebx[2];
            int16_t* var_850_4;
            void* var_84c_5;
            wchar16* eax_5;
            if (ebx[1] == 0x28)
            {
                eax_5 = wcschr(u"*@<?", *esi_1);
                if (eax_5 != 0)
                {
                    var_84c_5 = &var_810;
                    var_850_4 = 3;
                label_40f4be:
                    sub_40f6e5(&var_824, &var_81c, &var_834, &var_82c, &var_820, var_850_4, var_84c_5);
                }
            }
            if ((ebx[1] != 0x28 || (ebx[1] == 0x28 && eax_5 == 0)))
            {
                uint32_t eax_6 = ebx[1];
                if (eax_6 == 0x24)
                {
                    uint32_t eax_7 = *esi_1;
                    int16_t* var_84c_6;
                    if (eax_7 == 0x5e)
                    {
                    label_40f522:
                        var_84c_6 = 5;
                    }
                    else
                    {
                        if (var_825 != 1)
                        {
                            goto label_40f522;
                        }
                        if (eax_7 == 0x40)
                        {
                            var_84c_6 = 2;
                        }
                        else
                        {
                            if (eax_7 == 0x28)
                            {
                                esi_1 = (esi_1 + 2);
                            }
                            uint32_t eax_8 = *(esi_1 + 2);
                            if ((eax_8 != 0x46 && (eax_8 != 0x44 && (eax_8 != 0x42 && eax_8 != 0x52))))
                            {
                                goto label_40f522;
                            }
                            if (*(esi_1 + 4) != 0x29)
                            {
                                goto label_40f522;
                            }
                            var_84c_6 = 4;
                        }
                    }
                    var_84c_5 = &var_810;
                    var_850_4 = var_84c_6;
                    goto label_40f4be;
                }
                if (wcschr(u"*@<?", eax_6) != 0)
                {
                    var_84c_5 = &var_810;
                    var_850_4 = 1;
                    goto label_40f4be;
                }
                int32_t* eax_11 = *arg3;
                if (eax_11 == 0)
                {
                    sub_4053c9(data_4226b0, 0x410);
                    eax_11 = *arg3;
                }
                wchar16* eax_12;
                int32_t edx_2;
                eax_12 = wcschr(eax_11[1], 0x24);
                int32_t* ecx_9 = *arg3;
                int32_t* eax_13 = *ecx_9;
                int16_t* esi_3;
                if (eax_12 == 0)
                {
                    esi_3 = ecx_9[1];
                    *arg3 = eax_13;
                }
                else
                {
                    edx_2 = var_825;
                    *arg3 = eax_13;
                    ecx_9[1];
                    esi_3 = sub_40f30f(arg3);
                    var_82d = 1;
                }
                sub_40fba9(&var_824, &var_81c, &var_834, &var_82c, esi_3, &var_820, &var_810);
                if (var_82d != 0)
                {
                    free(esi_3);
                    var_82d = 0;
                }
            }
            ebx = var_81c;
            esi = var_834;
            i = *ebx;
            if (i == 0)
            {
                break;
            }
            arg2 = var_835;
        }
        if (esi == var_82c)
        {
            sub_40f671(&var_824, &var_834, &var_82c, &var_820, &var_810);
            esi = var_834;
        }
        edi = var_824;
    }
    *esi = 0;
    int32_t esi_6 = (((esi - edi) + 2) >> 1);
    int32_t eax_16;
    int32_t edx_5;
    edx_5 = HIGHD((esi_6 * 2));
    eax_16 = LOWD((esi_6 * 2));
    int32_t ecx_14;
    ecx_14 = ((esi_6 * 2) >> 0x20) != 0;
    int32_t eax_17 = sub_40aba4(((-ecx_14) | eax_16));
    if (eax_17 == 0)
    {
        sub_4053c9(data_4226b0, 0x419);
    }
    memcpy(eax_17, edi, (esi_6 * 2));
    CookieCheckFunction(eax_17);
    return eax_17;
}

int32_t* __fastcall sub_40f671(int32_t* arg1, int32_t* arg2, int32_t* arg3, int32_t* arg4, int32_t arg5)
{
    int32_t* var_8 = arg1;
    int32_t* var_c = arg1;
    int32_t eax = *arg4;
    int32_t edi = *arg1;
    if (edi == arg5)
    {
        int32_t eax_1;
        int32_t edx;
        edx = HIGHD((eax * 2));
        eax_1 = LOWD((eax * 2));
        int32_t ecx;
        ecx = ((eax * 2) >> 0x20) != 0;
        edi = sub_40aba4(((-ecx) | eax_1));
        memcpy(edi, *arg1, (*arg4 * 2));
        eax = *arg4;
        *arg1 = edi;
    }
    int32_t eax_5 = sub_41069b(edi, (eax + 0x400));
    *arg1 = eax_5;
    int32_t ecx_5 = *arg4;
    *arg4 = (eax + 0x400);
    *arg2 = (eax_5 + (ecx_5 << 1));
    *arg3 = (eax_5 + ((eax + 0x400) << 1));
    return arg3;
}

void* __fastcall sub_40f6e5(int32_t* arg1, int32_t* arg2, void** arg3, int32_t* arg4, int32_t* arg5, int16_t* arg6, int32_t arg7)
{
    int32_t var_30 = 0;
    void* i_8 = nullptr;
    int16_t* i_6 = nullptr;
    char var_5 = 0;
    char ebx = 0;
    char var_6 = 0;
    int16_t* var_14 = nullptr;
    int32_t edx = 1;
    int32_t var_20 = 0;
    int16_t* eax = arg6;
    int32_t var_18 = 1;
    if (eax == 3)
    {
        edx = 2;
        var_5 = 1;
    }
    else if (eax == 4)
    {
        var_18 = 4;
        var_5 = 1;
    }
    if ((eax == 2 || eax == 4))
    {
        i_6 = data_422ec8;
    }
    else if ((eax == 1 || eax == 3))
    {
        int32_t ecx_2 = *arg2;
        uint32_t eax_5 = *(ecx_2 + (edx << 1));
        if (eax_5 == 0x2a)
        {
            if (*((ecx_2 + (edx << 1)) + 2) == 0x2a)
            {
                i_6 = data_422ec4;
                edx = (edx + 1);
            }
            else
            {
                i_6 = data_422ed8;
                var_6 = 1;
            }
        }
        if (eax_5 == 0x3c)
        {
            i_6 = data_422ecc;
        }
        if (eax_5 == 0x3f)
        {
            i_6 = data_422ed0;
        }
        if (((eax_5 == 0x2a && *((ecx_2 + (edx << 1)) + 2) == 0x2a) || eax_5 == 0x3f))
        {
            ebx = 1;
        }
        if ((((eax_5 != 0x2a && eax_5 != 0x3c) && eax_5 != 0x3f) && eax_5 == 0x40))
        {
            i_6 = data_422ed4;
        }
        var_18 = (edx + 1);
    }
    void* i_13;
    if ((((eax == 4 || eax == 2) || eax == 3) || eax == 1))
    {
        if (i_6 == 0)
        {
            int16_t* edi_1 = *arg2;
            int16_t i_10 = *edi_1;
            int16_t i_5 = i_10;
            if (i_10 != 0)
            {
                int16_t i_7 = i_10;
                int16_t i;
                do
                {
                    uint32_t i_11 = i_7;
                    i_5 = i_11;
                    if (i_11 == 0x20)
                    {
                        break;
                    }
                    if (i_11 == 9)
                    {
                        break;
                    }
                    edi_1 = &edi_1[1];
                    i = *edi_1;
                    i_7 = i;
                    i_5 = i;
                } while (i != 0);
            }
            *edi_1 = 0;
            int32_t var_4c_2 = *arg2;
            sub_4053c9(data_4226b0, 0xfa6);
            *edi_1 = i_5;
            ebx = 0;
            i_6 = sub_40e917(&data_401690);
            i_8 = i_6;
        }
        int16_t* ebx_3;
        if (ebx == 0)
        {
            int16_t* i_12 = i_6;
            int32_t eax_2;
            do
            {
                eax_2 = *i_12;
                i_12 = &i_12[1];
            } while (eax_2 != 0);
            int32_t edi_3 = (((i_12 - &i_12[1]) >> 1) + 1);
            if (edi_3 == 1)
            {
                edi_3 = 2;
            }
            int32_t eax_16;
            int32_t edx_11;
            edx_11 = HIGHD((edi_3 * 2));
            eax_16 = LOWD((edi_3 * 2));
            int32_t ecx_19;
            ecx_19 = ((edi_3 * 2) >> 0x20) != 0;
            ebx_3 = sub_40aba4(((-ecx_19) | eax_16));
            if (var_6 != 0)
            {
                i_6 = sub_40fa51(0x52, ebx_3, edi_3, i_6);
            }
            if (var_5 != 0)
            {
                int32_t ecx_22;
                ecx_22 = *(*arg2 + (var_18 << 1));
                i_6 = sub_40fa51(ecx_22, ebx_3, edi_3, i_6);
            }
        }
        else
        {
            int16_t* i_1 = i_6;
            int32_t var_24 = 0x400;
            int16_t* i_3 = i_1;
            i_6 = sub_40aba4(0x800);
            int16_t* i_9 = i_6;
            arg6 = i_6;
            int32_t ecx_4 = &i_6[0x400];
            int32_t var_c = ecx_4;
            if (i_1 != 0)
            {
                do
                {
                    int16_t* edi_2 = *(i_1 + 4);
                    int16_t* i_2 = i_1;
                    int32_t i_4;
                    if (var_5 != 0)
                    {
                        int16_t* ecx_5 = edi_2;
                        do
                        {
                            i_4 = *ecx_5;
                            ecx_5 = &ecx_5[1];
                        } while (i_4 != 0);
                        int16_t* eax_9 = var_14;
                        int32_t edx_4 = (((ecx_5 - &ecx_5[1]) >> 1) + 1);
                        if (edx_4 > var_20)
                        {
                            if (eax_9 != 0)
                            {
                                free(eax_9);
                            }
                            var_20 = edx_4;
                            int32_t eax_11;
                            int32_t edx_5;
                            edx_5 = HIGHD((edx_4 * 2));
                            eax_11 = LOWD((edx_4 * 2));
                            int32_t ecx_9;
                            ecx_9 = ((edx_4 * 2) >> 0x20) != 0;
                            eax_9 = sub_40aba4(((-ecx_9) | eax_11));
                            var_14 = eax_9;
                        }
                        int32_t ecx_13;
                        ecx_13 = *(*arg2 + (var_18 << 1));
                        int16_t* eax_13 = sub_40fa51(ecx_13, eax_9, var_20, edi_2);
                        ecx_4 = var_c;
                        edi_2 = eax_13;
                    }
                    if (*edi_2 != 0)
                    {
                        do
                        {
                            if (i_6 == ecx_4)
                            {
                                sub_40f671(&i_9, &arg6, &var_c, &var_24, 0);
                                i_6 = arg6;
                                ecx_4 = var_c;
                            }
                            *i_6 = *edi_2;
                            edi_2 = &edi_2[1];
                            i_6 = &i_6[1];
                            arg6 = i_6;
                        } while (*edi_2 != 0);
                        i_1 = i_3;
                    }
                    if (i_6 == ecx_4)
                    {
                        sub_40f671(&i_9, &arg6, &var_c, &var_24, 0);
                        i_6 = arg6;
                        ecx_4 = var_c;
                    }
                    *i_6 = 0;
                    i_4 = *i_1;
                    i_1 = i_4;
                    i_3 = i_4;
                    if (i_4 != 0)
                    {
                        *i_6 = 0x20;
                        i_6 = &i_6[1];
                        arg6 = i_6;
                        if (i_6 == ecx_4)
                        {
                            sub_40f671(&i_9, &arg6, &var_c, &var_24, 0);
                            i_6 = arg6;
                            ecx_4 = var_c;
                        }
                        *i_6 = 0;
                        i_1 = *i_2;
                        i_3 = i_1;
                    }
                } while (i_1 != 0);
                i_6 = i_9;
            }
            ebx_3 = var_14;
            i_8 = i_6;
        }
        sub_40fba9(arg1, arg2, arg3, arg4, i_6, arg5, arg7);
        i_13 = i_8;
        if (i_13 != 0)
        {
            i_13 = free(i_13);
        }
        if (ebx_3 != 0)
        {
            i_13 = free(ebx_3);
        }
    }
    if ((((eax != 1 && eax != 2) && eax != 3) && eax != 4))
    {
        i_13 = (eax - 5);
        if (eax == 5)
        {
            int32_t* ebx_1 = arg3;
            int16_t* eax_4 = *ebx_1;
            if (eax_4 == *arg4)
            {
                sub_40f671(arg1, ebx_1, arg4, arg5, arg7);
                eax_4 = *ebx_1;
            }
            *eax_4 = 0x24;
            i_13 = &eax_4[1];
            *arg2 = (*arg2 + 4);
            *ebx_1 = i_13;
        }
    }
    return i_13;
}

int16_t* __fastcall sub_40fa51(int16_t arg1, int16_t* arg2, int32_t arg3, uint32_t arg4)
{
    int16_t* str = arg2;
    int16_t* str_1 = str;
    int32_t var_c = 0;
    void* ebx = nullptr;
    void* edi = nullptr;
    if (wcscpy_s(str, arg3, arg4) != 0)
    {
        sub_4053c9(data_4226b0, 0x410);
    }
    int16_t* str_2 = str;
    arg4 = *str;
    uint32_t eax_1;
    do
    {
        eax_1 = *str_2;
        str_2 = &str_2[1];
    } while (eax_1 != 0);
    void* eax_3 = &str[(-1 + ((str_2 - &str_2[1]) >> 1))];
    while (eax_3 >= str)
    {
        uint32_t ecx_3 = *eax_3;
        if ((ecx_3 != 0x5c && ecx_3 != 0x2f))
        {
            if ((ecx_3 == 0x2e && ebx == 0))
            {
                ebx = eax_3;
            }
            eax_3 = (eax_3 - 2);
            continue;
        }
        edi = eax_3;
        break;
    }
    uint32_t eax_4 = arg1;
    if ((((eax_4 != 0x42 && eax_4 != 0x44) && eax_4 != 0x46) && (eax_4 == 0x52 && ebx != 0)))
    {
        *ebx = ((eax_4 - 0x46) - 0xc);
    }
    if (eax_4 == 0x44)
    {
        uint32_t eax_11 = str[1];
        if (edi != 0)
        {
            if ((eax_11 == 0x3a && edi == &str[2]))
            {
                edi = (edi + 2);
            }
            *edi = 0;
        }
        else if (eax_11 == 0x3a)
        {
            str[2] = 0;
        }
        else if (wcscpy_s(str, arg3, &data_40169c) != 0)
        {
            sub_4053c9(data_4226b0, 0x410);
        }
    }
    if ((eax_4 == 0x42 && ebx != 0))
    {
        *ebx = 0;
    }
    if ((eax_4 == 0x46 || eax_4 == 0x42))
    {
        if (edi != 0)
        {
            str = (edi + 2);
        }
        else if (str[1] == 0x3a)
        {
            str = &str[2];
        }
    }
    if (arg4 == 0x22)
    {
        if ((*str != 0x22 && str > str_1))
        {
            str = (str - 2);
            *str = 0x22;
        }
        wchar16* eax_14 = wcschr(str, 0);
        if (eax_14[-1] != 0x22)
        {
            *eax_14 = 0x22;
            eax_14[1] = 0;
        }
    }
    return str;
}

wchar16* __fastcall sub_40fba9(int32_t* arg1, int32_t* arg2, void** arg3, int32_t* arg4, int16_t* arg5, int32_t* arg6, int32_t arg7)
{
    int32_t* esi = arg2;
    *esi = (*esi + 2);
    int16_t* str = *esi;
    int32_t* var_10 = esi;
    if (*str == 0x5e)
    {
        str = &str[1];
        *esi = str;
    }
    wchar16* eax = wcschr(str, 0x3a);
    int16_t* ecx = *esi;
    wchar16* ebx = eax;
    int16_t* edx = ecx;
    wchar16* var_8 = ebx;
    int16_t i_1 = *edx;
    if (i_1 != 0)
    {
        int16_t i = i_1;
        while (i != 0x29)
        {
            if (i == 0x5e)
            {
                edx = &edx[1];
            }
            edx = &edx[1];
            int16_t i_2 = *edx;
            i = i_2;
            if (i_2 == 0)
            {
                break;
            }
        }
        esi = var_10;
        ebx = var_8;
    }
    uint32_t eax_2 = *ecx;
    int32_t var_14 = 0x28;
    wchar16* eax_1;
    if (((eax_2 != 0x28 || (eax_2 == 0x28 && ebx == 0)) || ((eax_2 == 0x28 && ebx != 0) && ebx >= edx)))
    {
        int16_t* edi_2 = arg5;
        if (*edi_2 != 0)
        {
            int16_t** ebx_1 = arg3;
            int16_t* ecx_2 = *ebx_1;
            do
            {
                if (ecx_2 == *arg4)
                {
                    sub_40f671(arg1, ebx_1, arg4, arg6, arg7);
                    ecx_2 = *ebx_1;
                }
                eax_2 = *edi_2;
                edi_2 = &edi_2[1];
                *ecx_2 = eax_2;
                ecx_2 = &ecx_2[1];
                *ebx_1 = ecx_2;
            } while (*edi_2 != 0);
            esi = var_10;
            ecx = *esi;
            eax_2 = *ecx;
        }
        uint32_t eax_3 = eax_2;
        int16_t edx_3 = eax_3;
        if (eax_3 == 0x24)
        {
            ecx = &ecx[1];
            *esi = ecx;
            edx_3 = *ecx;
        }
        if (edx_3 == 0x28)
        {
            do
            {
                *esi = (*esi + 2);
                ecx = *esi;
            } while (*ecx != 0x29);
        }
        else if ((edx_3 == 0x2a && ecx[1] == 0x2a))
        {
            ecx = &ecx[1];
        }
        eax_1 = &ecx[1];
    }
    if (((eax_2 == 0x28 && ebx != 0) && ebx < edx))
    {
        sub_40fcd9(arg1, &var_8, arg3, arg4, arg5, arg6, arg7);
        eax_1 = var_8;
    }
    *esi = eax_1;
    return eax_1;
}

int32_t __fastcall sub_40fcd9(int32_t* arg1, int32_t* arg2, void** arg3, int32_t* arg4, int16_t* arg5, int32_t* arg6, int32_t arg7)
{
    *arg2 = (*arg2 + 2);
    int16_t* edi = *arg2;
    int32_t var_14 = 0x3d;
    while (true)
    {
        int16_t eax_1 = *edi;
        if (eax_1 == 0)
        {
            if (eax_1 != 0x3d)
            {
                sub_4053c9(data_4226a4, 0x3eb);
            }
            break;
        }
        if (eax_1 == 0x3d)
        {
            break;
        }
        if (eax_1 == 0x5e)
        {
            edi = &edi[1];
        }
        edi = &edi[1];
    }
    if (edi == *arg2)
    {
        sub_4053c9(data_4226a4, 0x3ed);
    }
    uint32_t eax_3 = *edi;
    int16_t* ebx = edi;
    int16_t* var_18 = ebx;
    int32_t var_c = 0x29;
    uint32_t edx_1 = eax_3;
    int16_t eax_2;
    if (eax_3 != 0)
    {
        uint32_t ecx_3;
        do
        {
            eax_2 = eax_3;
            if (eax_2 == 0x29)
            {
                break;
            }
            if (eax_2 == 0x5e)
            {
                ebx = &ebx[1];
            }
            ebx = &ebx[1];
            var_18 = ebx;
            ecx_3 = *ebx;
            eax_3 = ecx_3;
            edx_1 = ecx_3;
            uint32_t var_20_1 = edx_1;
        } while (ecx_3 != 0);
    }
    if (((eax_3 == 0 || (eax_3 != 0 && eax_2 != 0x29)) && edx_1 != 0x29))
    {
        sub_4053c9(data_4226a4, 0x3e8);
    }
    int32_t eax_7 = (((edi - *arg2) >> 1) + 1);
    int32_t eax_8;
    int32_t edx_2;
    edx_2 = HIGHD((eax_7 * 2));
    eax_8 = LOWD((eax_7 * 2));
    int32_t ecx_5;
    ecx_5 = ((eax_7 * 2) >> 0x20) != 0;
    int32_t eax_9 = sub_40aba4(((-ecx_5) | eax_8));
    int16_t* esi_1 = *arg2;
    int32_t edx_3 = eax_9;
    int32_t var_10 = eax_9;
    int16_t i = *esi_1;
    if (i != 0x3d)
    {
        do
        {
            if (i == 0x5e)
            {
                esi_1 = &esi_1[1];
            }
            *edx_3 = *esi_1;
            esi_1 = &esi_1[1];
            edx_3 = (edx_3 + 2);
            i = *esi_1;
        } while (i != 0x3d);
        eax_9 = var_10;
    }
    int32_t var_20_2 = 0;
    *edx_3 = 0;
    int16_t* ecx_8 = eax_9;
    do
    {
        eax_9 = *ecx_8;
        ecx_8 = &ecx_8[1];
    } while (eax_9 != 0);
    int32_t ecx_10 = ((ecx_8 - &ecx_8[1]) >> 1);
    int32_t eax_13 = ((ebx - edi) >> 1);
    int32_t eax_14;
    int32_t edx_5;
    edx_5 = HIGHD((eax_13 * 2));
    eax_14 = LOWD((eax_13 * 2));
    int32_t ecx_11;
    ecx_11 = ((eax_13 * 2) >> 0x20) != 0;
    int32_t eax_15 = sub_40aba4(((-ecx_11) | eax_14));
    void* esi_2 = &esi_1[1];
    int32_t var_20_3 = eax_15;
    int16_t* ecx_14 = eax_15;
    int16_t i_1 = *esi_2;
    if (i_1 != 0x29)
    {
        do
        {
            if (i_1 == 0x5e)
            {
                esi_2 = (esi_2 + 2);
            }
            eax_15 = *esi_2;
            esi_2 = (esi_2 + 2);
            *ecx_14 = eax_15;
            ecx_14 = &ecx_14[1];
            i_1 = *esi_2;
        } while (i_1 != 0x29);
        ebx = var_18;
    }
    int16_t* edi_1 = arg5;
    *ecx_14 = 0;
    *arg2 = &ebx[1];
    int16_t i_2 = *edi_1;
    if (i_2 != 0)
    {
        int32_t esi_3 = ecx_10;
        do
        {
            int32_t eax_17;
            int32_t eax_21;
            if (i_2 == *var_10)
            {
                eax_17 = wcsncmp(edi_1, var_10, esi_3);
                if (eax_17 == 0)
                {
                    int32_t ebx_1 = var_20_3;
                    if (*var_20_3 != 0)
                    {
                        int16_t** esi_4 = arg3;
                        int16_t* ecx_17 = *esi_4;
                        do
                        {
                            if (ecx_17 == *arg4)
                            {
                                sub_40f671(arg1, esi_4, arg4, arg6, arg7);
                                ecx_17 = *esi_4;
                            }
                            int32_t eax_18;
                            eax_18 = *ebx_1;
                            *ecx_17 = eax_18;
                            ecx_17 = &ecx_17[1];
                            ebx_1 = (ebx_1 + 2);
                            *esi_4 = ecx_17;
                        } while (*ebx_1 != 0);
                        esi_3 = ecx_10;
                        edi_1 = arg5;
                    }
                    eax_21 = (esi_3 * 2);
                }
            }
            if ((i_2 != *var_10 || (i_2 == *var_10 && eax_17 != 0)))
            {
                int32_t* eax_19 = arg4;
                int16_t* ecx_19 = *arg3;
                if (ecx_19 == *eax_19)
                {
                    sub_40f671(arg1, arg3, eax_19, arg6, arg7);
                    ecx_19 = *arg3;
                }
                eax_19 = *edi_1;
                *ecx_19 = eax_19;
                *arg3 = &ecx_19[1];
                eax_21 = 2;
            }
            edi_1 = (edi_1 + eax_21);
            arg5 = edi_1;
            i_2 = *edi_1;
        } while (i_2 != 0);
    }
    free(var_10);
    return free(var_20_3);
}

int32_t __fastcall sub_40ff31(int32_t arg1, int32_t arg2)
{
    __security_cookie;
    void var_214;
    void var_10;
    _wsplitpath_s(arg1, &var_10, 3, &var_214, 0x100, 0, 0, 0, 0);
    void var_41c;
    _wmakepath_s(&var_41c, 0x104, &var_10, &var_214, arg2, 0);
    int32_t eax_2 = sub_40e917(&var_41c);
    CookieCheckFunction(eax_2);
    return eax_2;
}

int32_t __fastcall sub_40ffa5(int16_t* arg1)
{
    int16_t* i_10 = arg1;
    char ebx = 0;
    int16_t i_11 = *i_10;
    int16_t* i_3 = i_10;
    int16_t i_9 = i_11;
    if (i_11 == 0x7b)
    {
        i_10 = &i_10[1];
        i_3 = i_10;
        int16_t i_8 = *i_10;
        int16_t i_6 = i_8;
        if (i_8 != 0)
        {
            int16_t i_5 = i_8;
            int16_t i;
            do
            {
                i_6 = i_5;
                if (i_5 == 0x7d)
                {
                    break;
                }
                if (i_5 == 0x5e)
                {
                    i_10 = &i_10[1];
                }
                i_10 = &i_10[1];
                i = *i_10;
                i_5 = i;
                i_6 = i;
            } while (i != 0);
            i_3 = i_10;
            ebx = 0;
        }
        i_9 = i_6;
        if (i_6 != 0)
        {
            i_10 = &i_10[1];
            i_3 = i_10;
            i_9 = *i_10;
        }
    }
    int32_t eax;
    if (i_9 == 0x2e)
    {
        int16_t* i_12 = i_10;
        int16_t i_1 = 0x2e;
        while (i_1 != 0x7b)
        {
            if (i_1 == 0x5e)
            {
                i_12 = &i_12[1];
            }
            i_12 = &i_12[1];
            int16_t i_4 = *i_12;
            i_1 = i_4;
            if (i_4 == 0)
            {
                break;
            }
        }
        int16_t* i_2 = i_3;
        int16_t* i_7 = i_2;
        int32_t var_8 = 0x5c;
        int32_t var_c_1 = 0x2f;
        ebx = 0;
        for (; i_2 < i_12; i_2 = &i_2[1])
        {
            int16_t eax_1 = *i_2;
            if (eax_1 == 0x5c)
            {
                break;
            }
            if (eax_1 == 0x2f)
            {
                break;
            }
        }
        void* str;
        if ((*i_12 == 0 || (*i_12 != 0 && i_2 != i_12)))
        {
            eax = wcspbrk(&i_7[1], &data_402724);
            if ((eax != 0 && *eax == 0x2e))
            {
                str = (eax + 2);
            label_4100e5:
                if ((wcschr(str, 0x2f) == 0 && wcschr(str, 0x5c) == 0))
                {
                    if (wcschr(str, 0x2e) == 0)
                    {
                        ebx = 1;
                    }
                    else
                    {
                        sub_4053c9(data_4226b0, 0x444);
                    }
                }
            }
        }
        if ((*i_12 != 0 && i_2 == i_12))
        {
            int16_t* ecx = &i_12[1];
            eax = *ecx;
            int16_t esi_1 = eax;
            if (eax != 0)
            {
                int16_t edx = eax;
                do
                {
                    esi_1 = edx;
                    if (edx == 0x7d)
                    {
                        break;
                    }
                    if (edx == 0x5e)
                    {
                        ecx = &ecx[1];
                    }
                    ecx = &ecx[1];
                    eax = *ecx;
                    edx = eax;
                    esi_1 = eax;
                } while (eax != 0);
                ebx = 0;
            }
            if ((esi_1 != 0 && ecx[1] == 0x2e))
            {
                str = &ecx[2];
                goto label_4100e5;
            }
        }
    }
    eax = ebx;
    return eax;
}

uint32_t __fastcall sub_410124(int16_t* arg1, int32_t arg2, int16_t* arg3, int32_t arg4)
{
    __security_cookie;
    int16_t* i_2 = arg3;
    int16_t* esi = arg1;
    uint32_t eax_3 = *i_2;
    void* ebx = &esi[arg2];
    void* var_220 = ebx;
    if (eax_3 != 0)
    {
        int32_t var_224_1 = 0;
        int32_t var_228_1 = 0x25;
        while (true)
        {
            int16_t* i_1 = i_2;
            if (esi >= ebx)
            {
                break;
            }
            if (eax_3 == 0x25)
            {
                i_2 = &i_2[1];
                uint32_t edx = *i_2;
                if (edx == 0)
                {
                    i_2 = i_1;
                label_4103f3:
                    i_2 = &i_2[1];
                    eax_3 = *i_2;
                    if (eax_3 == 0)
                    {
                        break;
                    }
                    continue;
                }
                else
                {
                    if (edx == 0x25)
                    {
                        *esi = 0x25;
                        goto label_4101c2;
                    }
                    if (edx == 0x73)
                    {
                        int32_t eax_19 = arg4;
                        if (eax_19 != 0)
                        {
                            int32_t i;
                            do
                            {
                                int16_t ecx_11 = *eax_19;
                                if (ecx_11 == 0)
                                {
                                    break;
                                }
                                if (esi >= ebx)
                                {
                                    break;
                                }
                                *esi = ecx_11;
                                esi = &esi[1];
                                i = (eax_19 + 1);
                                eax_19 = (i + 1);
                            } while (i != 0xffffffff);
                        }
                        goto label_4103f3;
                    }
                    if (edx == 0x7c)
                    {
                        char var_216_1 = 0;
                        *ebx[1] = 0;
                        char var_215_1 = 0;
                        ebx = 0;
                        int16_t var_214 = 0;
                        while (true)
                        {
                            int16_t* i_3 = i_2;
                            i_2 = &i_2[1];
                            uint32_t eax_5 = *i_2;
                            if (eax_5 == 0)
                            {
                                i_2 = i_3;
                            }
                            else
                            {
                                switch (eax_5)
                                {
                                    case 0x46:
                                    {
                                        if (i_2[-1] == 0x7c)
                                        {
                                            ebx = 1;
                                            *ebx[1] = 1;
                                            var_215_1 = 1;
                                            var_216_1 = 1;
                                        }
                                        break;
                                    }
                                    case 0x64:
                                    {
                                        ebx = 1;
                                        break;
                                    }
                                    case 0x65:
                                    {
                                        var_216_1 = 1;
                                        break;
                                    }
                                    case 0x66:
                                    {
                                        var_215_1 = 1;
                                        break;
                                    }
                                }
                                if (eax_5 == 0x70)
                                {
                                    *ebx[1] = 1;
                                }
                                if (((((eax_5 == 0x64 || eax_5 == 0x65) || eax_5 == 0x66) || eax_5 == 0x70) || eax_5 == 0x46))
                                {
                                    if (*i_2 == 0x46)
                                    {
                                        int32_t eax_12 = arg4;
                                        if (eax_12 == 0)
                                        {
                                            sub_4053c9(eax_12, 0x449);
                                            eax_12 = arg4;
                                        }
                                        if (ebx != 0)
                                        {
                                            _wsplitpath_s(eax_12, &var_214, 0x104, 0, 0, 0, 0, 0, 0);
                                        }
                                        void var_212;
                                        int32_t ebx_1;
                                        if (*ebx[1] == 0)
                                        {
                                            ebx_1 = arg4;
                                        }
                                        else
                                        {
                                            int16_t* ecx_1 = &var_214;
                                            do
                                            {
                                                eax_12 = *ecx_1;
                                                ecx_1 = &ecx_1[1];
                                            } while (eax_12 != 0);
                                            int32_t ecx_3 = ((ecx_1 - &var_212) >> 1);
                                            ebx_1 = arg4;
                                            _wsplitpath_s(ebx_1, 0, 0, &&var_214[ecx_3], (0x104 - ecx_3), 0, 0, 0, 0);
                                        }
                                        if (var_215_1 != 0)
                                        {
                                            int16_t* ecx_4 = &var_214;
                                            do
                                            {
                                                eax_12 = *ecx_4;
                                                ecx_4 = &ecx_4[1];
                                            } while (eax_12 != 0);
                                            int32_t ecx_6 = ((ecx_4 - &var_212) >> 1);
                                            _wsplitpath_s(ebx_1, 0, 0, 0, 0, &&var_214[ecx_6], (0x104 - ecx_6), 0, 0);
                                        }
                                        if (var_216_1 != 0)
                                        {
                                            int16_t* ecx_7 = &var_214;
                                            do
                                            {
                                                eax_12 = *ecx_7;
                                                ecx_7 = &ecx_7[1];
                                            } while (eax_12 != 0);
                                            int32_t ecx_9 = ((ecx_7 - &var_212) >> 1);
                                            _wsplitpath_s(ebx_1, 0, 0, 0, 0, 0, 0, &&var_214[ecx_9], (0x104 - ecx_9));
                                        }
                                        ebx = var_220;
                                        if (var_214 != 0)
                                        {
                                            int16_t* ecx_10 = (&var_214 - esi);
                                            while (esi < ebx)
                                            {
                                                eax_12 = *(ecx_10 + esi);
                                                *esi = eax_12;
                                                esi = &esi[1];
                                                if (*(ecx_10 + esi) == 0)
                                                {
                                                    break;
                                                }
                                            }
                                        }
                                        break;
                                    }
                                    continue;
                                }
                            }
                            ebx = var_220;
                            for (; i_1 <= i_2; i_1 = &i_1[1])
                            {
                                if (esi >= ebx)
                                {
                                    break;
                                }
                                int32_t eax_6;
                                eax_6 = *i_1;
                                *esi = eax_6;
                                esi = &esi[1];
                            }
                            break;
                        }
                        goto label_4103f3;
                    }
                    *esi = 0x25;
                    esi = &esi[1];
                    if (esi == ebx)
                    {
                        break;
                    }
                    eax_3 = *i_2;
                }
            }
            *esi = eax_3;
        label_4101c2:
            esi = &esi[1];
            goto label_4103f3;
        }
    }
    if (((eax_3 == 0 || (eax_3 != 0 && esi < ebx)) && esi < ebx))
    {
        *esi = 0;
        eax_3 = 0;
    }
    if ((((eax_3 == 0 || (eax_3 != 0 && esi < ebx)) && esi >= ebx) || (eax_3 != 0 && esi >= ebx)))
    {
        eax_3 = 1;
    }
    CookieCheckFunction(eax_3);
    return eax_3;
}

void** __thiscall sub_410422(int16_t* arg1, int16_t* arg2)
{
    int16_t* var_8 = arg1;
    int16_t* var_c = arg1;
    void** i = *((arg2 << 2) + &data_422490);
    int16_t* var_c_1 = arg1;
    void** i_1 = i;
    int16_t* eax_1;
    int16_t* ebx_1;
    if (i != 0)
    {
        do
        {
            ebx_1 = arg1;
            eax_1 = i[1];
            arg2 = eax_1;
            if (*arg1 != 0)
            {
                do
                {
                    uint32_t ecx = *eax_1;
                    if (ecx == 0)
                    {
                        break;
                    }
                    int16_t edx_1 = *ebx_1;
                    if ((edx_1 != 0x5c && edx_1 != 0x2f))
                    {
                        int16_t eax_2 = towupper(ecx);
                        eax_1 = arg2;
                        if (towupper(*ebx_1) != eax_2)
                        {
                            break;
                        }
                    }
                    if ((((edx_1 == 0x5c || edx_1 == 0x2f) && ecx != 0x5c) && ecx != 0x2f))
                    {
                        break;
                    }
                    ebx_1 = &ebx_1[1];
                    eax_1 = &eax_1[1];
                    arg2 = eax_1;
                } while (*ebx_1 != 0);
                i = i_1;
                arg1 = var_c_1;
            }
            if ((*ebx_1 == 0 && *eax_1 == 0))
            {
                break;
            }
            i = *i;
            i_1 = i;
        } while (i != 0);
    }
    void** i_2;
    if ((i == 0 || (i != 0 && (!(*ebx_1 == 0 && *eax_1 == 0)))))
    {
        i_2 = nullptr;
    }
    if (((i != 0 && *ebx_1 == 0) && *eax_1 == 0))
    {
        i_2 = i;
    }
    return i_2;
}

int32_t __fastcall sub_4104da(int16_t* arg1, int16_t* arg2)
{
    int16_t* var_8 = arg1;
    int16_t* var_c = arg1;
    int32_t __saved_ebp;
    int32_t var_8_1 = (__security_cookie ^ &__saved_ebp);
    int16_t* edi = arg2;
    int16_t* esi = arg1;
    int32_t var_c_1 = 0;
    int32_t eax_1;
    do
    {
        eax_1 = *arg1;
        arg1 = &arg1[1];
    } while (eax_1 != 0);
    __alloca_probe_16(((((arg1 - &arg1[1]) >> 1) << 1) + 2));
    int16_t* ecx_2 = edi;
    int16_t i;
    do
    {
        i = *ecx_2;
        ecx_2 = &ecx_2[1];
    } while (i != 0);
    __alloca_probe_16(((((ecx_2 - &ecx_2[1]) >> 1) << 1) + 2));
    int16_t i_5 = *esi;
    int16_t i_3 = i_5;
    if (i_5 == 0x22)
    {
        esi = &esi[1];
        i_3 = *esi;
    }
    int32_t __saved_edi;
    int32_t* eax_4 = &__saved_edi;
    if (i_3 != 0)
    {
        int16_t i_1 = i_3;
        do
        {
            *eax_4 = i_1;
            eax_4 = (eax_4 + 2);
            i_1 = *((esi - &__saved_edi) + eax_4);
        } while (i_1 != 0);
        if ((eax_4 != &__saved_edi && *(eax_4 - 2) == 0x22))
        {
            eax_4 = (eax_4 - 2);
        }
    }
    *eax_4 = 0;
    int16_t i_6 = *edi;
    int16_t i_4 = i_6;
    if (i_6 == 0x22)
    {
        edi = &edi[1];
        i_4 = *edi;
    }
    int32_t* eax_5 = &__saved_edi;
    if (i_4 != 0)
    {
        int16_t i_2 = i_4;
        do
        {
            *eax_5 = i_2;
            eax_5 = (eax_5 + 2);
            i_2 = *((edi - &__saved_edi) + eax_5);
        } while (i_2 != 0);
        if ((eax_5 != &__saved_edi && *(eax_5 - 2) == 0x22))
        {
            eax_5 = (eax_5 - 2);
        }
    }
    *eax_5 = 0;
    int32_t eax_6 = _wcsicmp(&__saved_edi, &__saved_edi);
    CookieCheckFunction(eax_6);
    return eax_6;
}

int32_t __fastcall sub_4105de(int16_t* arg1)
{
    int16_t* esi = arg1;
    void* edx = &arg1[1];
    int16_t i;
    do
    {
        i = *arg1;
        arg1 = &arg1[1];
    } while (i != 0);
    int32_t eax_1;
    int32_t edx_1;
    edx_1 = HIGHD(((((arg1 - edx) >> 1) + 1) * 2));
    eax_1 = LOWD(((((arg1 - edx) >> 1) + 1) * 2));
    int32_t ecx_2;
    ecx_2 = (((((arg1 - edx) >> 1) + 1) * 2) >> 0x20) != 0;
    int32_t eax_2 = sub_40aba4(((-ecx_2) | eax_1));
    int16_t i_4 = *esi;
    int16_t i_3 = i_4;
    if (i_4 == 0x22)
    {
        esi = &esi[1];
        i_3 = *esi;
    }
    int32_t ecx_5 = eax_2;
    if (i_3 != 0)
    {
        int16_t i_2 = i_3;
        int16_t i_1;
        do
        {
            *ecx_5 = i_2;
            ecx_5 = (ecx_5 + 2);
            i_1 = *((esi - eax_2) + ecx_5);
            i_2 = i_1;
        } while (i_1 != 0);
    }
    if (*(ecx_5 - 2) == 0x22)
    {
        ecx_5 = (ecx_5 - 2);
    }
    *ecx_5 = 0;
    return eax_2;
}

int32_t __fastcall sub_410653(int16_t* arg1, int32_t arg2)
{
    if (*arg1 == 0x22)
    {
        void* edx = &arg1[1];
        *wcsrchr(arg1, 0x22) = 0;
        int16_t i = *edx;
        *arg1 = i;
        while (i != 0)
        {
            int16_t* ecx = edx;
            edx = &ecx[1];
            i = *edx;
            *ecx = i;
        }
    }
    return _wfsopen(arg1, arg2, 0x20);
}

int32_t __fastcall sub_41069b(int32_t arg1, int32_t arg2)
{
    int32_t esi = 0;
    int32_t eax_2;
    if (arg1 == 0)
    {
        if (arg2 <= 0x7ffffffc)
        {
            eax_2 = malloc((arg2 * 2));
        }
        else
        {
        label_4106dc:
            sub_4053c9(data_4226b0, 0x41b);
        }
    }
    else
    {
        if (arg2 > 0x7ffffffc)
        {
            goto label_4106dc;
        }
        eax_2 = realloc(arg1, (arg2 * 2));
    }
    if (((arg1 == 0 && arg2 <= 0x7ffffffc) || arg1 != 0))
    {
        esi = eax_2;
        if (esi == 0)
        {
            goto label_4106dc;
        }
    }
    return esi;
}

uint32_t __fastcall sub_4106e7(int16_t* arg1)
{
    __security_cookie;
    FindFileHandle var_260;
    void var_25c;
    uint32_t eax_2 = sub_407a1b(arg1, &var_25c, &var_260);
    if (eax_2 != 0)
    {
        int32_t* edi_1 = sub_40e8c5();
        edi_1[1] = sub_40ff31(arg1, eax_2);
        while (true)
        {
            char (* eax_7)[0x104] = sub_407ba7(&var_25c, var_260);
            if (eax_7 == 0)
            {
                break;
            }
            int32_t** eax_5 = sub_40e8c5();
            int32_t eax_6 = sub_40ff31(arg1, eax_7);
            *eax_5 = edi_1;
            edi_1 = eax_5;
            eax_5[1] = eax_6;
        }
        eax_2 = edi_1;
    }
    CookieCheckFunction(eax_2);
    return eax_2;
}

int32_t pre_c_initialization()
{
    _set_app_type(1);
    _set_fmode(0x4000);
    *__p__commode() = 0;
    if (___scrt_initialize_onexit_tables(1) != 0)
    {
        __fnclex();
        sub_411111();
        _atexit(sub_41113d);
        if (_configure_wide_argv(1) == 0)
        {
            sub_410ef5();
            if (sub_410f42() != 0)
            {
                __setusermatherr(sub_410ee8);
            }
            __initialize_default_precision();
            _configthreadlocale(0);
            if (sub_410f01() != 0)
            {
                _initialize_wide_environment();
            }
            j_sub_410ee8();
            return 0;
        }
    }
    ___scrt_fastfail(7);
    breakpoint();
}

int32_t sub_410838(int32_t arg1 @ esi)
{
    int32_t __saved_ebp = 0x14;
    int32_t var_8 = 0x4115a0;
    enum _EXCEPTION_DISPOSITION (* var_10)(int32_t* arg1, struct _EXCEPTION_REGISTRATION_RECORD* arg2, struct _CONTEXT* arg3, int32_t arg4) = __except_handler4;
    int32_t* fsbase;
    int32_t var_14 = *fsbase;
    int32_t var_30 = arg1;
    uint32_t __security_cookie_1 = __security_cookie;
    int32_t var_8_3 = (0x4115a0 ^ __security_cookie_1);
    var_4;
    int32_t var_38 = (__security_cookie_1 ^ &var_4);
    int32_t* var_1c = &var_38;
    void* const var_3c_3 = &data_410844;
    int32_t var_8_4 = 0xfffffffe;
    int32_t var_c = var_8_3;
    *fsbase = &var_14;
    if (___scrt_initialize_crt(1) != 0)
    {
        char var_1d_1 = nullptr;
        int32_t var_8_1 = 0;
        char eax_1 = ___scrt_acquire_startup_lock();
        int32_t eax_2 = data_41243c;
        if (eax_2 != 1)
        {
            if (eax_2 != 0)
            {
                char var_1d_2 = 1;
            }
            else
            {
                data_41243c = 1;
                if (_initterm_e(0x40100c, 0x40101c) != 0)
                {
                    int32_t var_8_2 = 0xfffffffe;
                    *fsbase = var_14;
                    return 0xff;
                }
                _initterm(0x401000, 0x401008);
                data_41243c = 2;
            }
            ___scrt_release_startup_lock(eax_1);
            if ((data_4372e4 != 0 && ___scrt_is_nonwritable_in_current_image(0x4372e4) != 0))
            {
                data_4372e4(0, 2, 0);
            }
            if ((data_4372e0 != 0 && ___scrt_is_nonwritable_in_current_image(0x4372e0) != 0))
            {
                _register_thread_local_exe_atexit_callback(data_4372e0);
            }
            wchar16** eax_7 = _get_initial_wide_environment();
            int32_t esi_1 = *__p___wargv();
            wchar16** var_3c_2 = eax_7;
            sub_40b971(*__p___argc(), esi_1);
            /* no return */
        }
    }
    ___scrt_fastfail(7);
    exit(arg1);
    /* no return */
}

int32_t sub_410973(void* arg1 @ ebp)
{
    int32_t* esp_5 = *(arg1 - 0x18);
    if (___scrt_is_managed_app() == 0)
    {
        *(esp_5 - 4) = *(arg1 - 0x20);
        _exit();
        /* no return */
    }
    if (*(arg1 - 0x19) == 0)
    {
        _c_exit();
    }
    *(arg1 - 4) = 0xfffffffe;
    int32_t eax_1 = *(arg1 - 0x20);
    int32_t* fsbase;
    *fsbase = *(arg1 - 0x10);
    *esp_5;
    esp_5[1];
    esp_5[2];
    esp_5[3];
    *arg1;
    return eax_1;
}

int32_t _start()
{
    ___security_init_cookie();
    int32_t esi;
    /* tailcall */
    return sub_410838(esi);
}

void __convention("regparm") CookieCheckFunction(uint32_t arg1)
{
    int32_t ecx;
    if (ecx != __security_cookie)
    {
        /* tailcall */
        return ___report_gsfailure(arg1);
    }
}

BOOL ___raise_securityfailure(struct EXCEPTION_POINTERS* arg1)
{
    SetUnhandledExceptionFilter(nullptr);
    UnhandledExceptionFilter(arg1);
    return TerminateProcess(GetCurrentProcess(), 0xc0000409);
}

void ___report_gsfailure(uint64_t stack_cookie) __noreturn
{
    BOOL eax;
    int32_t ecx;
    int32_t edx;
    eax = IsProcessorFeaturePresent(PF_FASTFAIL_AVAILABLE);
    bool p = /* bool p = unimplemented  {test eax, eax} */;
    bool a = /* undefined */;
    bool z = (eax & eax) == 0;
    if (z)
    {
        data_412220 = eax;
        data_41221c = ecx;
        data_412218 = edx;
        data_412214 = nullptr;
        int32_t esi;
        data_412210 = esi;
        int32_t edi;
        data_41220c = edi;
        int16_t ss;
        data_412238 = ss;
        int16_t cs;
        data_41222c = cs;
        int16_t ds;
        data_412208 = ds;
        int16_t es;
        data_412204 = es;
        int16_t fs;
        data_412200 = fs;
        int16_t gs;
        data_4121fc = gs;
        bool d;
        int32_t var_32c = ((((0) ? 1 : 0) << 0xb) | ((((d) ? 1 : 0) << 0xa) | (((((eax & eax) < 0) ? 1 : 0) << 7) | ((((z) ? 1 : 0) << 6) | ((((a) ? 1 : 0) << 4) | ((((p) ? 1 : 0) << 2) | (((0) ? 1 : 0) << 0)))))));
        data_412230 = var_32c;
        int32_t ebp;
        data_412224 = ebp;
        data_412228 = __return_addr;
        data_412234 = &stack_cookie;
        data_412170 = 0x10001;
        data_41212c = data_412228;
        data_412120 = 0xc0000409;
        data_412124 = 1;
        data_412130 = 1;
        int32_t var_32c_1 = 4;
        data_412134 = 2;
        int32_t var_32c_2 = 4;
        uint32_t __security_cookie_1 = __security_cookie;
        &__security_cookie_1[1] = data_412010;
        ___raise_securityfailure(&data_401030);
        return;
    }
    trap(0xd);
}

BOOL ___report_rangecheckfailure()
{
    int32_t ebp;
    int32_t var_4 = ebp;
    int32_t esi;
    int32_t edi;
    return ___report_securityfailure(&var_4, esi, edi);
}

BOOL ___report_securityfailure(int32_t arg1 @ ebp, int32_t arg2 @ esi, int32_t arg3 @ edi)
{
    BOOL eax;
    int32_t ecx;
    int32_t edx;
    eax = IsProcessorFeaturePresent(PF_FASTFAIL_AVAILABLE);
    bool p = /* bool p = unimplemented  {test eax, eax} */;
    bool a = /* undefined */;
    bool z = (eax & eax) == 0;
    if (z)
    {
        data_412220 = eax;
        data_41221c = ecx;
        data_412218 = edx;
        data_412214 = nullptr;
        data_412210 = arg2;
        data_41220c = arg3;
        int16_t ss;
        data_412238 = ss;
        int16_t cs;
        data_41222c = cs;
        int16_t ds;
        data_412208 = ds;
        int16_t es;
        data_412204 = es;
        int16_t fs;
        data_412200 = fs;
        int16_t gs;
        data_4121fc = gs;
        bool d;
        int32_t var_324 = ((((0) ? 1 : 0) << 0xb) | ((((d) ? 1 : 0) << 0xa) | (((((eax & eax) < 0) ? 1 : 0) << 7) | ((((z) ? 1 : 0) << 6) | ((((a) ? 1 : 0) << 4) | ((((p) ? 1 : 0) << 2) | (((0) ? 1 : 0) << 0)))))));
        data_412230 = var_324;
        data_412224 = arg1;
        data_412228 = __return_addr;
        data_412234 = &arg_4;
        data_41212c = data_412228;
        data_412120 = 0xc0000409;
        data_412124 = 1;
        data_412130 = 1;
        int32_t var_324_1 = 4;
        data_412134 = arg_4;
        return ___raise_securityfailure(&data_401030);
    }
    trap(0xd);
}

enum _EXCEPTION_DISPOSITION __except_handler4(int32_t* arg1, struct _EXCEPTION_REGISTRATION_RECORD* arg2, struct _CONTEXT* arg3, int32_t arg4)
{
    int32_t mxcsr;
    *arg1 = __filter_x86_sse2_floating_point_exception_default(mxcsr, *arg1);
    return _except_handler4_common(&__security_cookie, CookieCheckFunction, arg1, arg2, arg3, arg4);
}

void* find_pe_section(void* arg1, int32_t arg2)
{
    void* ecx_1 = (*(arg1 + 0x3c) + arg1);
    void* edx_1 = ((ecx_1 + 0x18) + *(ecx_1 + 0x14));
    void* esi_1 = ((*(ecx_1 + 6) * 0x28) + edx_1);
    if (edx_1 != esi_1)
    {
        while ((!(arg2 >= *(edx_1 + 0xc) && arg2 < (*(edx_1 + 8) + *(edx_1 + 0xc)))))
        {
            edx_1 = (edx_1 + 0x28);
            if (edx_1 == esi_1)
            {
                break;
            }
        }
    }
    void* eax_5;
    if ((edx_1 == esi_1 || (edx_1 != esi_1 && (!(arg2 >= *(edx_1 + 0xc) && arg2 < (*(edx_1 + 8) + *(edx_1 + 0xc)))))))
    {
        eax_5 = nullptr;
    }
    if (((edx_1 != esi_1 && arg2 >= *(edx_1 + 0xc)) && arg2 < (*(edx_1 + 8) + *(edx_1 + 0xc))))
    {
        eax_5 = edx_1;
    }
    return eax_5;
}

int32_t ___scrt_acquire_startup_lock()
{
    int32_t eax;
    if (___asan_report_present() != 0)
    {
        void* fsbase;
        int32_t edx_1 = *(*(fsbase + 0x18) + 4);
        while (true)
        {
            eax = 0;
            if (0 == data_412440)
            {
                data_412440 = edx_1;
            }
            else
            {
                eax = data_412440;
            }
            if (eax == 0)
            {
                break;
            }
            if (edx_1 == eax)
            {
                eax = 1;
                return eax;
            }
        }
    }
    eax = 0;
    return eax;
}

int32_t ___scrt_initialize_crt(int32_t arg1)
{
    if (arg1 == 0)
    {
        data_412444 = 1;
    }
    uint64_t xcr0;
    ___isa_available_init(xcr0);
    if ((sub_410f01() != 0 && sub_410f01() != 0))
    {
        int32_t eax_1;
        eax_1 = 1;
        return eax_1;
    }
    int32_t eax;
    eax = 0;
    return eax;
}

int32_t ___scrt_initialize_onexit_tables(int32_t arg1)
{
    if (data_412445 != 0)
    {
        int32_t eax;
        eax = 1;
        return eax;
    }
    if ((arg1 != 0 && arg1 != 1))
    {
        ___scrt_fastfail(5);
        breakpoint();
    }
    int32_t eax_1 = ___asan_report_present();
    if ((eax_1 == 0 || (eax_1 != 0 && arg1 != 0)))
    {
        __builtin_memset(&data_412448, 0xff, 0x18);
    }
    if (arg1 == 0)
    {
        if (eax_1 != 0)
        {
            eax_1 = _initialize_onexit_table(0x412448);
        }
        if (eax_1 == 0)
        {
            eax_1 = _initialize_onexit_table(0x412454);
        }
    }
    if (((eax_1 == 0 || (eax_1 != 0 && arg1 != 0)) || (arg1 == 0 && eax_1 == 0)))
    {
        data_412445 = 1;
        eax_1 = 1;
    }
    if ((arg1 == 0 && ((eax_1 != 0 && eax_1 != 0) || eax_1 == 0)))
    {
        eax_1 = 0;
    }
    return eax_1;
}

void* ___scrt_is_nonwritable_in_current_image(int32_t arg1)
{
    int32_t __saved_ebp = 8;
    int32_t var_8 = 0x4115c0;
    enum _EXCEPTION_DISPOSITION (* var_10)(int32_t* arg1, struct _EXCEPTION_REGISTRATION_RECORD* arg2, struct _CONTEXT* arg3, int32_t arg4) = __except_handler4;
    int32_t* fsbase;
    int32_t var_14 = *fsbase;
    uint32_t __security_cookie_1 = __security_cookie;
    int32_t var_8_4 = (0x4115c0 ^ __security_cookie_1);
    var_4;
    int32_t var_2c = (__security_cookie_1 ^ &var_4);
    int32_t* var_1c = &var_2c;
    void* const var_30_1 = &data_410d41;
    int32_t var_8_5 = 0xfffffffe;
    int32_t var_c = var_8_4;
    *fsbase = &var_14;
    int32_t var_8_1 = 0;
    void* eax = find_pe_section(&__dos_header, (arg1 - 0x400000));
    if ((eax == 0 || (eax != 0 && *(eax + 0x24) < 0)))
    {
        int32_t var_8_3 = 0xfffffffe;
        eax = 0;
    }
    if ((eax != 0 && *(eax + 0x24) >= 0))
    {
        int32_t var_8_2 = 0xfffffffe;
        eax = 1;
    }
    *fsbase = var_14;
    return eax;
}

int32_t sub_410d9a(void* arg1 @ ebp)
{
    int32_t ecx;
    ecx = ***(arg1 - 0x14) == 0xc0000005;
    return ecx;
}

int32_t ___scrt_release_startup_lock(char arg1)
{
    int32_t eax = ___asan_report_present();
    if ((eax != 0 && arg1 == 0))
    {
        int32_t temp0_1 = data_412440;
        data_412440 = 0;
        eax = temp0_1;
    }
    return eax;
}

int32_t ___scrt_uninitialize_crt(int32_t arg1, char arg2)
{
    if ((data_412444 == 0 || (data_412444 != 0 && arg2 == 0)))
    {
        int32_t var_8_1 = arg1;
        int32_t var_c_1 = arg1;
    }
    int32_t eax;
    eax = 1;
    return eax;
}

int32_t __onexit(_onexit_t arg1)
{
    int32_t eax;
    if (data_412448 != 0xffffffff)
    {
        eax = _register_onexit_function(&data_412448, arg1);
    }
    else
    {
        eax = _crt_atexit(arg1);
    }
    int32_t eax_1 = (-eax);
    return ((!(eax_1 - eax_1)) & arg1);
}

int32_t _atexit(_onexit_t arg1)
{
    int32_t eax = __onexit(arg1);
    int32_t eax_1 = (-eax);
    return ((-(eax_1 - eax_1)) - 1);
}

int32_t ___get_entropy()
{
    int32_t lpSystemTimeAsFileTime = 0;
    int32_t var_c = 0;
    GetSystemTimeAsFileTime(&lpSystemTimeAsFileTime);
    int32_t var_8 = (var_c ^ lpSystemTimeAsFileTime);
    uint32_t eax_2 = GetCurrentThreadId();
    var_8 = (var_8 ^ eax_2);
    uint32_t eax_3 = GetCurrentProcessId();
    var_8 = (var_8 ^ eax_3);
    int32_t lpPerformanceCount;
    QueryPerformanceCounter(&lpPerformanceCount);
    int32_t var_14;
    return (((var_14 ^ lpPerformanceCount) ^ var_8) ^ &var_8);
}

void ___security_init_cookie()
{
    uint32_t __security_cookie_1 = __security_cookie;
    if ((__security_cookie_1 == 0xbb40e64e || (__security_cookie_1 != 0xbb40e64e && (0xffff0000 & __security_cookie_1) == 0)))
    {
        uint32_t __security_cookie_2 = ___get_entropy();
        __security_cookie_1 = __security_cookie_2;
        if (__security_cookie_1 == 0xbb40e64e)
        {
            __security_cookie_1 = 0xbb40e64f;
        }
        else if ((0xffff0000 & __security_cookie_1) == 0)
        {
            __security_cookie_1 = (__security_cookie_1 | ((__security_cookie_2 | 0x4711) << 0x10));
        }
        __security_cookie = __security_cookie_1;
    }
    data_412010 = (!__security_cookie_1);
}

int32_t sub_410ee8() __pure
{
    return 0;
}

int32_t sub_410eeb() __pure
{
    return 1;
}

int32_t sub_410eef() __pure
{
    return 0x4000;
}

int32_t sub_410ef5()
{
    return InitializeSListHead(&data_412460);
}

int32_t sub_410f01() __pure
{
    int32_t eax;
    eax = 1;
    return eax;
}

errno_t __initialize_default_precision()
{
    errno_t eax = _controlfp_s(nullptr, 0x10000, 0x30000);
    if (eax != 0)
    {
        ___scrt_fastfail(7);
        breakpoint();
    }
    return eax;
}

int32_t sub_410f42()
{
    int32_t eax;
    eax = data_412004 == 0;
    return eax;
}

int32_t sub_410f4e() __pure
{
    return 0x4372e4;
}

int32_t sub_410f54() __pure
{
    return 0x4372e0;
}

int32_t ___scrt_fastfail(int32_t arg1)
{
    if (IsProcessorFeaturePresent(PF_FASTFAIL_AVAILABLE) != 0)
    {
        trap(0xd);
    }
    int32_t var_330 = 3;
    sub_411109();
    int32_t var_328;
    int32_t eax_1;
    int32_t ecx_1;
    int32_t edx;
    eax_1 = memset(&var_328, 0, 0x2cc);
    bool p = /* bool p = unimplemented  {add esp, 0xc} */;
    bool a = /* bool a = unimplemented  {add esp, 0xc} */;
    int32_t var_278 = eax_1;
    int32_t var_27c = ecx_1;
    int32_t var_280 = edx;
    void* const var_284 = nullptr;
    int32_t esi;
    int32_t var_288 = esi;
    int32_t edi;
    int32_t var_28c = edi;
    int16_t ss;
    int16_t var_260 = ss;
    int16_t cs;
    int16_t var_26c = cs;
    int16_t ds;
    int16_t var_290 = ds;
    int16_t es;
    int16_t var_294 = es;
    int16_t fs;
    int16_t var_298 = fs;
    int16_t gs;
    int16_t var_29c = gs;
    var_338;
    int32_t var_32c;
    bool d;
    int32_t var_330_1 = (((((&var_338 + 0xc)) ? 1 : 0) << 0xb) | ((((d) ? 1 : 0) << 0xa) | ((((&var_32c < 0) ? 1 : 0) << 7) | ((((&var_338 == 0xfffffff4) ? 1 : 0) << 6) | ((((a) ? 1 : 0) << 4) | ((((p) ? 1 : 0) << 2) | (((&var_338 >= 0xfffffff4) ? 1 : 0) << 0)))))));
    int32_t var_268 = var_330_1;
    void* const __return_addr_1 = __return_addr;
    var_328 = 0x10001;
    int32_t ebp;
    int32_t var_274 = ebp;
    int32_t var_5c;
    memset(&var_5c, 0, 0x50);
    var_5c = 0x40000015;
    int32_t var_58 = 1;
    void* const __return_addr_2 = __return_addr;
    int32_t ebx = (IsDebuggerPresent() - 1);
    char ebx_1 = (-ebx);
    int32_t* ExceptionInfo = &var_5c;
    int32_t* var_8 = &var_328;
    SetUnhandledExceptionFilter(nullptr);
    int32_t eax_6 = UnhandledExceptionFilter(&ExceptionInfo);
    if ((eax_6 == 0 && (ebx_1 - ebx_1) == 0xff))
    {
        sub_411109();
    }
    return eax_6;
}

int32_t j_sub_410ee8()
{
    /* tailcall */
    return sub_410ee8();
}

HINSTANCE ___scrt_is_managed_app()
{
    HINSTANCE eax = GetModuleHandleW(nullptr);
    if ((eax != 0 && *eax == 0x5a4d))
    {
        int32_t* ecx_2 = (eax[0xf] + eax);
        if ((*ecx_2 == 0x4550 && (ecx_2[6] == 0x10b && (ecx_2[0x1d] > 0xe && ecx_2[0x3a] != 0))))
        {
            eax = 1;
            return 0x101;
        }
    }
    eax = 0;
    return eax;
}

LPTOP_LEVEL_EXCEPTION_FILTER sub_4110bc()
{
    return SetUnhandledExceptionFilter(sub_4110c8);
}

int32_t __stdcall sub_4110c8(int32_t* arg1)
{
    int32_t* eax_1 = *arg1;
    if ((*eax_1 == 0xe06d7363 && eax_1[4] == 3))
    {
        int32_t eax_2 = eax_1[5];
        if ((((eax_2 == 0x19930520 || eax_2 == 0x19930521) || eax_2 == 0x19930522) || eax_2 == 0x1994000))
        {
            terminate();
            /* no return */
        }
    }
    return 0;
}

int32_t sub_411109()
{
    data_412468 = 0;
}

void sub_411111()
{
    return;
}

void sub_41113d()
{
    return;
}

void* __SEH_prolog4(int32_t arg1 @ esi, int32_t arg2 @ edi, void* arg3)
{
    enum _EXCEPTION_DISPOSITION (* var_4)(int32_t* arg1, struct _EXCEPTION_REGISTRATION_RECORD* arg2, struct _CONTEXT* arg3, int32_t arg4) = __except_handler4;
    int32_t* fsbase;
    int32_t var_8 = *fsbase;
    int32_t eax = arg_8;
    int32_t ebp;
    arg_8 = ebp;
    void* esp = (&var_8 - eax);
    *(esp - 4) = nullptr;
    *(esp - 8) = arg1;
    *(esp - 0xc) = arg2;
    uint32_t __security_cookie_1 = __security_cookie;
    *(esp - 0x10) = (__security_cookie_1 ^ &arg_8);
    void* var_10 = (esp - 0x10);
    *(esp - 0x14) = __return_addr;
    void* __return_addr_1 = (arg3 ^ __security_cookie_1);
    arg3 = 0xfffffffe;
    __return_addr = __return_addr_1;
    *fsbase = &var_8;
    return __return_addr_1;
}

int32_t __SEH_epilog4(int32_t* arg1 @ ebp, int32_t arg2, int32_t arg3, int32_t arg4)
{
    int32_t* fsbase;
    *fsbase = arg1[-4];
    *arg1;
    *arg1 = __return_addr;
}

int32_t ___isa_available_init(uint64_t arg1 @ xcr0)
{
    data_41246c = 0;
    data_412018 = (data_412018 | 1);
    if (IsProcessorFeaturePresent(PF_XMMI64_INSTRUCTIONS_AVAILABLE) != 0)
    {
        uint32_t var_14_1 = 0;
        data_412018 = (data_412018 | 2);
        data_41246c = 1;
        uint32_t eax_1;
        uint32_t ecx_1;
        uint32_t edx_1;
        uint32_t ebx_1;
        eax_1 = __cpuid(0, 0);
        uint32_t var_28 = eax_1;
        uint32_t eax_2 = var_28;
        uint32_t eax_7;
        uint32_t ecx_2;
        uint32_t edx_2;
        uint32_t ebx_2;
        eax_7 = __cpuid(1, 0);
        var_28 = eax_7;
        uint32_t var_24_2 = ebx_2;
        uint32_t var_1c_2 = edx_2;
        int32_t edi_4;
        if ((((ecx_1 ^ 0x6c65746e) | (edx_1 ^ 0x49656e69)) | (ebx_1 ^ 0x756e6547)) != 0)
        {
        label_4112a7:
            edi_4 = data_412470;
        }
        else
        {
            int32_t eax_12 = (var_28 & 0xfff3ff0);
            if ((eax_12 != 0x106c0 && (eax_12 != 0x20660 && (eax_12 != 0x20670 && (eax_12 != 0x30650 && (eax_12 != 0x30660 && eax_12 != 0x30670))))))
            {
                goto label_4112a7;
            }
            edi_4 = (data_412470 | 1);
            data_412470 = edi_4;
        }
        uint32_t ebx_4;
        if (eax_2 < 7)
        {
            ebx_4 = var_14_1;
        }
        else
        {
            uint32_t* var_38_1 = &var_28;
            uint32_t eax_14;
            uint32_t ecx_3;
            uint32_t edx_3;
            uint32_t ebx_3;
            eax_14 = __cpuid(7, 0);
            var_28 = eax_14;
            uint32_t var_20_3 = ecx_3;
            uint32_t var_1c_3 = edx_3;
            ebx_4 = ebx_3;
            if ((ebx_4 & 0x200) != 0)
            {
                data_412470 = (edi_4 | 2);
            }
        }
        if ((ecx_2 & 0x100000) != 0)
        {
            data_412018 = (data_412018 | 4);
            data_41246c = 2;
            if (((ecx_2 & 0x8000000) != 0 && (ecx_2 & 0x10000000) != 0))
            {
                uint32_t eax_15;
                uint32_t edx_4;
                edx_4 = _xgetbv(0, arg1);
                uint32_t var_14_2 = edx_4;
                if ((eax_15 & 6) == 6)
                {
                    int32_t eax_19 = (data_412018 | 8);
                    data_41246c = 3;
                    data_412018 = eax_19;
                    if ((ebx_4 & 0x20) != 0)
                    {
                        data_41246c = 5;
                        data_412018 = (eax_19 | 0x20);
                    }
                }
            }
        }
    }
    return 0;
}

int32_t ___asan_report_present()
{
    int32_t eax;
    eax = data_41201c != 0;
    return eax;
}

enum _EXCEPTION_DISPOSITION _except_handler4_common(uint32_t* CookiePointer, void (* CookieCheckFunction)(uint32_t), struct _EXCEPTION_RECORD* ExceptionRecord, struct _EXCEPTION_REGISTRATION_RECORD* EstablisherFrame, struct _CONTEXT* ContextRecord, void* DispatcherContext)
{
    /* tailcall */
    return _except_handler4_common(CookiePointer, CookieCheckFunction, ExceptionRecord, EstablisherFrame, ContextRecord, DispatcherContext);
}

void memset(uint8_t* arg1, uint8_t arg2, uint32_t arg3)
{
    /* tailcall */
    return memset(arg1, arg2, arg3);
}

void exit(int32_t status) __noreturn
{
    /* tailcall */
    return exit(status);
}

int32_t _seh_filter_exe()
{
    /* tailcall */
    return _seh_filter_exe();
}

int32_t _set_app_type()
{
    /* tailcall */
    return _set_app_type();
}

int32_t __setusermatherr()
{
    /* tailcall */
    return __setusermatherr();
}

int32_t _configure_wide_argv()
{
    /* tailcall */
    return _configure_wide_argv();
}

int32_t _initialize_wide_environment()
{
    /* tailcall */
    return _initialize_wide_environment();
}

wchar16** _get_initial_wide_environment()
{
    /* tailcall */
    return _get_initial_wide_environment();
}

int32_t _initterm()
{
    /* tailcall */
    return _initterm();
}

int32_t _initterm_e()
{
    /* tailcall */
    return _initterm_e();
}

void _exit(int32_t _Except) __noreturn
{
    /* tailcall */
    return _exit(_Except);
}

errno_t _set_fmode(int32_t _Value)
{
    /* tailcall */
    return _set_fmode(_Value);
}

int32_t __p___argc()
{
    /* tailcall */
    return __p___argc();
}

int32_t __p___wargv()
{
    /* tailcall */
    return __p___wargv();
}

void _cexit() __noreturn
{
    /* tailcall */
    return _cexit();
}

int32_t _c_exit()
{
    /* tailcall */
    return _c_exit();
}

int32_t _register_thread_local_exe_atexit_callback()
{
    /* tailcall */
    return _register_thread_local_exe_atexit_callback();
}

int32_t _configthreadlocale(int32_t _Flag)
{
    /* tailcall */
    return _configthreadlocale(_Flag);
}

int32_t _set_new_mode(int32_t _NewMode)
{
    /* tailcall */
    return _set_new_mode(_NewMode);
}

int32_t __p__commode()
{
    /* tailcall */
    return __p__commode();
}

int32_t _initialize_onexit_table()
{
    /* tailcall */
    return _initialize_onexit_table();
}

int32_t _register_onexit_function(struct _onexit_table_t* _Table, _onexit_t _Function)
{
    /* tailcall */
    return _register_onexit_function(_Table, _Function);
}

int32_t _crt_atexit()
{
    /* tailcall */
    return _crt_atexit();
}

errno_t _controlfp_s(uint32_t* _CurrentState, uint32_t _NewValue, uint32_t _Mask)
{
    /* tailcall */
    return _controlfp_s(_CurrentState, _NewValue, _Mask);
}

void terminate() __noreturn
{
    /* tailcall */
    return terminate();
}

int32_t initialize_legacy_wide_specifiers()
{
    int32_t ecx = data_43664c;
    data_436648 = (data_436648 | 4);
    data_43664c = ecx;
    int32_t ecx_1 = data_43665c;
    data_436658 = (data_436658 | 2);
    data_43665c = ecx_1;
    return 0;
}

BOOL __stdcall IsProcessorFeaturePresent(enum PROCESSOR_FEATURE_ID ProcessorFeature)
{
    /* tailcall */
    return IsProcessorFeaturePresent(ProcessorFeature);
}

int32_t __filter_x86_sse2_floating_point_exception_default(int32_t arg1 @ mxcsr, int32_t arg2)
{
    int32_t ecx;
    int32_t var_8 = ecx;
    if ((data_41246c >= 1 && (arg2 == 0xc00002b4 || arg2 == 0xc00002b5)))
    {
        int32_t eax_2 = (arg1 ^ 0x3f);
        if (((eax_2 & 0x81) != 0 && (eax_2 & 0x204) == 0))
        {
            return 0xc000008e;
        }
        if (((eax_2 & 0x81) == 0 || (((eax_2 & 0x81) != 0 && (eax_2 & 0x204) != 0) && (eax_2 & 0x102) == 0)))
        {
            return 0xc0000090;
        }
        if ((((eax_2 & 0x81) != 0 && (eax_2 & 0x204) != 0) && (eax_2 & 0x102) != 0))
        {
            if ((eax_2 & 0x408) == 0)
            {
                return 0xc0000091;
            }
            if ((eax_2 & 0x810) == 0)
            {
                return 0xc0000093;
            }
            if ((eax_2 & 0x1020) == 0)
            {
                return 0xc000008f;
            }
        }
    }
    return arg2;
}

void* __SEH_prolog4_GS(int32_t arg1 @ esi, int32_t arg2 @ edi, void* arg3)
{
    enum _EXCEPTION_DISPOSITION (* var_4)(int32_t* arg1, struct _EXCEPTION_REGISTRATION_RECORD* arg2, struct _CONTEXT* arg3, int32_t arg4) = __except_handler4;
    int32_t* fsbase;
    int32_t var_8 = *fsbase;
    int32_t eax = arg_8;
    int32_t ebp;
    arg_8 = ebp;
    void* esp = (&var_8 - eax);
    *(esp - 4) = nullptr;
    *(esp - 8) = arg1;
    *(esp - 0xc) = arg2;
    uint32_t __security_cookie_1 = __security_cookie;
    int32_t eax_1 = (__security_cookie_1 ^ &arg_8);
    int32_t var_14 = eax_1;
    *(esp - 0x10) = eax_1;
    void* var_10 = (esp - 0x10);
    *(esp - 0x14) = __return_addr;
    void* __return_addr_1 = (arg3 ^ __security_cookie_1);
    arg3 = 0xfffffffe;
    __return_addr = __return_addr_1;
    *fsbase = &var_8;
    return __return_addr_1;
}

int32_t __SEH_epilog4_GS(int32_t* arg1 @ ebp, int32_t arg2, int32_t arg3, int32_t arg4)
{
    arg1[-7];
    CookieCheckFunction();
    int32_t* fsbase;
    *fsbase = arg1[-4];
    *arg1;
    *arg1 = __return_addr;
}

int32_t __convention("regparm") __alloca_probe_16(void* arg1)
{
    void* ecx_1 = ((&arg_4 - arg1) & 0xf);
    /* tailcall */
    return __chkstk(((arg1 + ecx_1) | (ecx_1 - ecx_1)));
}

int32_t __convention("regparm") sub_411526(void* arg1)
{
    void* ecx_1 = ((&arg_4 - arg1) & 7);
    /* tailcall */
    return __chkstk(((arg1 + ecx_1) | (ecx_1 - ecx_1)));
}

void* const __convention("regparm") __chkstk(int32_t arg1)
{
    void* ecx_1 = ((&__return_addr - arg1) & (!(arg1 - arg1)));
    int32_t __saved_ecx;
    void* eax_2 = (&__saved_ecx & 0xfffff000);
    while (ecx_1 < eax_2)
    {
        eax_2 = (eax_2 - 0x1000);
        *eax_2;
    }
    void* const __return_addr_1 = __return_addr;
    *ecx_1 = __return_addr_1;
    return __return_addr_1;
}

void memcpy(uint8_t* arg1, uint8_t* arg2, uint32_t arg3)
{
    /* tailcall */
    return memcpy(arg1, arg2, arg3);
}

void memmove(uint8_t* arg1, uint8_t* arg2, uint32_t arg3)
{
    /* tailcall */
    return memmove(arg1, arg2, arg3);
}

int32_t __convention("regparm") sub_411593(int32_t arg1)
{
    /* jump -> *(arg1 + 0xb60040bc) */
}

